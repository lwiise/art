<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Finna Art — Gallery</title>
<link href="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.css" rel="stylesheet" />
<style>
  /* ===== CSS STYLES ===== */
  :root { --bg: #fff; --text-main:#222; --accent:#333; --card-radius:32px; --btn-radius:30px; }

  /* Global Reset */
  *,*::before,*::after{ box-sizing:border-box; -webkit-font-smoothing:antialiased; }
  body{
    margin:0; height:100vh; width:100vw; background:var(--bg);
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
    color:var(--text-main); overflow:hidden;
  }

  /* ===== LAYOUT ===== */
  .layout{ display:flex; height:100%; width:100%; overflow:hidden; }

  /* Map Container (31% / Shop 69%) */
  #map{ flex:0 0 31vw; height:100vh; background:#000; position:relative; }

  /* Map Style: B&W Satellite */
  .mapboxgl-canvas{ outline:none; filter:grayscale(100%) contrast(1.2) brightness(0.9); }

  /* --- SIDE NAVIGATION (DESKTOP + MOBILE) --- */
  .side-nav{
    position:absolute; top:50%; right:0; transform:translateY(-50%);
    display:flex; flex-direction:column; z-index:10;
    background:rgba(255,255,255,0.1);
    backdrop-filter:blur(15px); -webkit-backdrop-filter:blur(15px);
    border-radius:20px 0 0 20px;
    border-left:1px solid rgba(255,255,255,0.15);
    border-top:1px solid rgba(255,255,255,0.15);
    border-bottom:1px solid rgba(255,255,255,0.15);
    box-shadow:-10px 0 30px rgba(0,0,0,0.3);
    transition:background .3s, border-color .3s;
  }
  .side-nav.focused{ background:rgba(0,0,0,0.6); border-color:rgba(255,255,255,0.1); }

  .nav-item{
    padding:30px 40px; color:rgba(255,255,255,0.8);
    font-weight:600; font-size:14px; text-transform:uppercase; letter-spacing:.05em;
    border-bottom:1px solid rgba(255,255,255,0.1);
    transition:all .3s ease; cursor:pointer; text-align:center;
    text-shadow:0 2px 10px rgba(0,0,0,0.5);
    user-select:none;
  }
  .nav-item:last-child{ border-bottom:none; }
  .nav-item:hover,.nav-item.active{
    background:rgba(255,255,255,0.2); color:#fff;
    padding-right:50px;
  }

  /* --- SHOP CONTAINER (69%) --- */
  .shop{
    flex:0 0 69vw;
    display:flex; flex-direction:column; height:100vh;
    background:#fff; position:relative; z-index:2;
    box-shadow:-10px 0 40px rgba(0,0,0,0.05);
  }

  /* SECTIONS ARCHITECTURE */
  .app-section{
    position:absolute; inset:0;
    display:flex; flex-direction:column;
    background:#fff;
    opacity:0; visibility:hidden; pointer-events:none;
    transform:translateY(20px);
    transition:opacity .4s ease, transform .4s ease;
    z-index:1;
    padding:40px;
    overflow-y:auto;
    height:100%;
  }
  .app-section.active-section{
    opacity:1; visibility:visible; pointer-events:auto;
    transform:translateY(0); z-index:10;
  }

  /* GALLERY LAYOUT FIX */
  #sect-gallery{ padding:0; }

  .shop-head{
    flex-shrink:0;
    position:sticky; top:0; background:rgba(255,255,255,0.95);
    backdrop-filter:blur(10px); z-index:10; padding:24px 30px;
    display:flex; align-items:center; justify-content:space-between;
    border-bottom:1px solid #f0f0f0;
  }

  .nav-group{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .chip{
    border:none; background:transparent; font-size:14px; color:#999; cursor:pointer;
    padding:8px 12px; transition:all .2s; font-weight:500; white-space:nowrap;
  }
  .chip:hover{ color:#333; }
  .chip.active{ background:var(--accent); color:#fff; padding:8px 24px; border-radius:var(--btn-radius); }

  .shop-body{
    padding:20px 30px 60px;
    flex-grow:1;
    overflow-y:auto;
    min-height:0;
  }

  .grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:40px 20px; width:100%; }

  .card{
    background:#fff; border:1px solid #f4f4f4; border-radius:var(--card-radius);
    padding:30px 20px; cursor:pointer;
    transition:all .3s cubic-bezier(.25,.8,.25,1);
    display:flex; flex-direction:column; align-items:center; text-align:center;
  }
  .card:hover{ transform:translateY(-6px); box-shadow:0 15px 40px rgba(0,0,0,0.06); }
  .card-media{ width:100%; height:180px; display:flex; align-items:center; justify-content:center; margin-bottom:20px; position:relative; }
  .card-media img{ max-width:100%; max-height:100%; object-fit:contain; filter:drop-shadow(0 10px 15px rgba(0,0,0,0.1)); }
  .card-name{ font-size:13px; font-weight:800; letter-spacing:.08em; color:#b0b0b0; text-transform:uppercase; margin-bottom:6px; }
  .card-sub{ font-size:10px; color:#ccc; text-transform:uppercase; letter-spacing:.05em; }

  /* --- HOME --- */
  .home-top{
    display:flex; align-items:center; justify-content:center;
    margin-top:6px; margin-bottom:10px;
  }
  .home-logo{
    width:170px; max-width:60vw; height:auto;
    border-radius:16px;
    box-shadow:0 8px 20px rgba(0,0,0,0.08);
  }

  .home-hero{
    width:100%;
    height:350px;
    border-radius:24px;
    background:url('https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/692da32bc1327c6df1f3dbee_WhatsApp%20Image%202025-11-30%20at%2014.38.44_496bf6d5.jpg') center/cover no-repeat;
    margin-top:18px;
    margin-bottom:30px;
    position:relative;
  }

  h1.sec-title{ font-size:32px; font-weight:800; margin-bottom:10px; letter-spacing:-.02em; color:#111; }
  p.sec-sub{ font-size:16px; color:#666; line-height:1.6; max-width:760px; margin-bottom:30px; }

  .btn-hero{
    display:inline-block; width:auto !important;
    padding:14px 36px; background:#111; color:#fff; border:none; border-radius:50px;
    font-size:14px; font-weight:700; cursor:pointer; margin-top:15px;
    box-shadow:0 8px 20px rgba(0,0,0,0.15); align-self:flex-start;
  }
  .btn-hero:hover{ transform:translateY(-3px); box-shadow:0 12px 25px rgba(0,0,0,0.2); background:#000; }

  /* --- ABOUT CONTENT (CREATIVE LAYOUT) --- */
  .about-kicker{
    font-size:11px; letter-spacing:.18em; text-transform:uppercase;
    color:#999; font-weight:900; margin-bottom:10px;
  }
  .about-lede{
    font-size:17px; line-height:1.7; color:#555; max-width:820px;
    margin:0 0 26px;
  }
  .about-panels{
    display:grid; grid-template-columns:repeat(3,1fr);
    gap:14px; margin:10px 0 26px;
  }
  .about-panel{
    border:1px solid #eee; border-radius:22px; padding:18px 18px;
    background:linear-gradient(180deg,#fff, #fbfbfb);
  }
  .about-panel h3{
    margin:0 0 8px; font-size:13px; letter-spacing:.08em;
    text-transform:uppercase; color:#111;
  }
  .about-panel p{ margin:0; color:#666; line-height:1.7; font-size:13px; }
  .about-split{
    margin-top:18px;
    display:grid; grid-template-columns:1.1fr 0.9fr; gap:18px; align-items:start;
  }
  .about-list{
    border:1px solid #eee; border-radius:22px; padding:18px 18px;
    background:#fff;
  }
  .about-list h4{
    margin:0 0 10px; font-size:12px; letter-spacing:.12em;
    text-transform:uppercase; color:#111;
  }
  .about-list ul{ margin:0; padding-left:18px; }
  .about-list li{ margin:8px 0; color:#666; line-height:1.6; font-size:13px; }

  /* --- SERVICES SECTION (LIKE IMAGE) --- */
  .services-wrap{
    position:relative;
    border-radius:24px;
    padding:55px 30px;
    background:
      repeating-linear-gradient(135deg, rgba(0,0,0,0.03) 0px, rgba(0,0,0,0.03) 2px, rgba(255,255,255,0.0) 2px, rgba(255,255,255,0.0) 10px),
      #f7f7f7;
    border:1px solid #eee;
  }
  .services-grid{
    display:grid;
    grid-template-columns:repeat(4, minmax(0, 1fr));
    gap:44px 38px;
  }
  .svc{
    text-align:center;
    padding:10px 6px;
  }
  .svc-ico{
    width:54px; height:54px;
    margin:0 auto 14px;
    opacity:.7;
  }
  .svc h3{
    margin:0 0 12px;
    font-size:28px;
    font-weight:500;
    color:#333;
    letter-spacing:-.01em;
  }
  .svc p{
    margin:0 auto;
    max-width:260px;
    font-size:14px;
    line-height:1.9;
    color:#7a7a7a;
  }

  /* --- SOLO VIEW --- */
  .solo-wrap{ display:none; animation:slideIn .5s cubic-bezier(.2,.8,.2,1); }
  #sect-gallery.solo .grid{ display:none; }
  #sect-gallery.solo .solo-wrap{ display:block; }

  .back-nav{ margin-bottom:20px; }
  .btn-back{ background:none; border:none; padding:0; color:#999; font-size:13px; font-weight:600; cursor:pointer; display:flex; align-items:center; gap:6px; }

  .solo-media-container{ width:100%; height:400px; background:#fff; display:flex; align-items:center; justify-content:center; margin-bottom:20px; position:relative; }
  .solo-media{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; }
  model-viewer{ width:100%; height:100%; }
  .solo-media img{ max-width:100%; max-height:100%; object-fit:contain; }
  .solo-media video{ width:100%; height:100%; object-fit:contain; background:#000; border-radius:18px; }

  /* ===== PRODUCT MEDIA TABS ===== */
  .media-tabs-bar{
    width:100%;
    display:flex;
    justify-content:flex-end;
    margin:-10px 0 12px;
    padding:10px 2px;
    position:sticky;
    top:0;
    z-index:80;
    background:rgba(255,255,255,0.92);
    backdrop-filter:blur(10px);
    -webkit-backdrop-filter:blur(10px);
  }
  .media-tabs{ display:flex; gap:10px; flex-wrap:nowrap; white-space:nowrap; }
  .media-tab{
    border:none; padding:8px 14px; border-radius:999px;
    background:rgba(0,0,0,0.10);
    color:#222; font-size:11px; font-weight:800; letter-spacing:.06em; text-transform:uppercase;
    cursor:pointer; transition:transform .12s ease, background .2s ease;
    flex:0 0 auto;
  }
  .media-tab:hover{ transform:translateY(-1px); background:rgba(0,0,0,0.14); }
  .media-tab.active{ background:#111; color:#fff; }

  .img-slider{ width:100%; height:100%; display:flex; align-items:center; justify-content:center; position:relative; }
  .slider-arrow{
    position:absolute; top:50%; transform:translateY(-50%);
    width:36px; height:36px; border-radius:999px; border:none;
    background:rgba(0,0,0,0.35); color:#fff; cursor:pointer;
    display:flex; align-items:center; justify-content:center; z-index:7;
  }
  .slider-arrow:hover{ background:rgba(0,0,0,0.45); }
  .slider-arrow.left{ left:12px; }
  .slider-arrow.right{ right:12px; }

  /* ===== 360 custom controls ===== */
  .v360-wrap{ width:100%; height:100%; position:relative; display:flex; align-items:center; justify-content:center; }
  .v360-wrap video{ width:100%; height:100%; object-fit:contain; background:#000; border-radius:18px; }
  .v360-controls{
    position:absolute; left:50%; transform:translateX(-50%);
    bottom:18px; width:min(740px,84%);
    display:flex; align-items:center; gap:12px;
    padding:10px 12px; border-radius:999px;
    background:rgba(0,0,0,0.35);
    backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);
  }
  .v360-btn{
    width:34px; height:34px; border-radius:10px; border:none;
    background:rgba(255,255,255,0.14); color:#fff; font-weight:900;
    cursor:pointer; display:flex; align-items:center; justify-content:center; line-height:1;
  }
  .v360-btn:hover{ background:rgba(255,255,255,0.20); }
  .v360-range{
    flex:1; -webkit-appearance:none; appearance:none;
    height:10px; border-radius:999px;
    background:rgba(255,255,255,0.18);
    outline:none; cursor:pointer;
  }
  .v360-range::-webkit-slider-thumb{
    -webkit-appearance:none; appearance:none;
    width:54px; height:18px; border-radius:999px;
    background:rgba(255,255,255,0.92);
  }
  .v360-range::-moz-range-thumb{
    width:54px; height:18px; border-radius:999px;
    background:rgba(255,255,255,0.92); border:none;
  }

  .solo-info-block{ padding:0 10px; }
  .solo-desc{ text-align:left; color:#666; font-size:14px; line-height:1.6; border-top:1px solid #eee; padding-top:24px; margin-bottom:30px; }
  .data-row{ display:flex; gap:30px; margin-top:16px; }
  .data-item span:first-child{ display:block; font-size:10px; color:#999; text-transform:uppercase; font-weight:700; margin-bottom:4px; }
  .data-item span:last-child{ font-size:15px; font-weight:700; color:#222; }

  /* Artist Profile */
  .artist-profile{ display:flex; align-items:center; gap:14px; margin-top:30px; padding:16px; background:#fafafa; border-radius:20px; cursor:pointer; transition:all .2s; border:1px solid transparent; position:relative; }
  .artist-profile:hover{ background:#fff; border-color:#eee; box-shadow:0 5px 15px rgba(0,0,0,0.05); transform:translateY(-2px); }
  .avatar{ width:44px; height:44px; border-radius:50%; background:#eee; overflow:hidden; }
  .avatar img{ width:100%; height:100%; object-fit:cover; }
  .artist-info{ flex:1; }
  .artist-info h4{ margin:0; font-size:13px; color:#222; }
  .artist-info p{ margin:2px 0 0; font-size:11px; color:#888; }
  .artist-cta{ font-size:11px; font-weight:700; color:#333; text-transform:uppercase; letter-spacing:.05em; }

  .actions{ display:flex; gap:12px; margin-top:30px; }
  .btn{ padding:14px 20px; border-radius:14px; border:none; font-size:13px; font-weight:600; cursor:pointer; transition:transform .1s; }
  .btn:active{ transform:scale(.96); }
  .btn-primary{ background:#111; color:#fff; flex:1; }
  .btn-ghost{ background:#f0f0f0; color:#666; }

  /* Form Styles */
  .form-title{ font-size:18px; font-weight:800; margin:0 0 20px; text-align:center; }
  .form-group{ margin-bottom:15px; }
  .form-input{ display:block; width:100%; padding:14px; border:1px solid #eee; border-radius:12px; background:#fafafa; font-size:14px; color:#111; margin-bottom:0; }
  .form-input:focus{ outline:none; border-color:#111; background:#fff; }
  .btn-submit{ width:100%; background:#111; color:#fff; padding:14px; border-radius:12px; border:none; font-weight:700; cursor:pointer; text-align:center; }
  #formSuccess{ display:none; border-radius:12px; margin-top:15px; background-color:#f0f0f0; color:#333; padding:20px; text-align:center; font-size:14px; }

  /* Modals */
  .modal-overlay{ position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); backdrop-filter:blur(4px); z-index:9999; display:none; align-items:center; justify-content:center; opacity:0; transition:opacity .3s ease; }
  .modal-overlay.open{ display:flex; opacity:1; }
  .modal-box{ background:#fff; width:90%; max-width:400px; padding:30px; border-radius:24px; box-shadow:0 20px 40px rgba(0,0,0,0.2); transform:translateY(20px); transition:transform .3s cubic-bezier(.2,.8,.2,1); position:relative; max-height:90vh; overflow-y:auto; }
  .modal-overlay.open .modal-box{ transform:translateY(0); }
  .close-modal{ position:absolute; top:20px; right:20px; background:none; border:none; font-size:20px; color:#999; cursor:pointer; }
  .artist-modal-header{ text-align:center; margin-bottom:20px; }
  .artist-modal-avatar{ width:80px; height:80px; border-radius:50%; margin:0 auto 15px; overflow:hidden; }
  .artist-modal-avatar img{ width:100%; height:100%; object-fit:cover; }
  .artist-modal-bio{ font-size:13px; line-height:1.6; color:#555; text-align:center; }

  @keyframes slideIn{ from{ opacity:0; transform:translateX(20px);} to{ opacity:1; transform:translateX(0);} }

  /* ===== MOBILE: SCROLL OVER MAP + HORIZONTAL NAV OVER MAP ===== */
  @media (max-width:900px){
    :root{ --mobile-map-h:45vh; } /* map takes 10% less than 50vh */

    body{ overflow:auto; height:auto; min-height:100vh; }
    .layout{ flex-direction:column; height:auto; min-height:100vh; overflow:visible; position:relative; }

    /* Map fixed behind */
    #map{
      position:fixed; top:0; left:0;
      width:100%; height:var(--mobile-map-h);
      flex:none; z-index:0;
    }

    /* SAME NAV, horizontal, bottom of map, over map */
    .side-nav{
      display:flex;
      flex-direction:row;
      top:calc(var(--mobile-map-h) - 62px);
      left:50%;
      right:auto;
      transform:translateX(-50%);
      border-radius:999px;
      border-left:1px solid rgba(255,255,255,0.15);
      border-right:1px solid rgba(255,255,255,0.15);
      border-top:1px solid rgba(255,255,255,0.15);
      border-bottom:1px solid rgba(255,255,255,0.15);
      box-shadow:0 12px 30px rgba(0,0,0,0.25);
      overflow-x:auto;
      max-width:92vw;
      scrollbar-width:none;
    }
    .side-nav::-webkit-scrollbar{ display:none; }

    .nav-item{
      padding:18px 18px;
      font-size:12px;
      border-bottom:none;
      border-right:1px solid rgba(255,255,255,0.12);
      white-space:nowrap;
      flex:0 0 auto;
    }
    .nav-item:last-child{ border-right:none; }
    .nav-item:hover,.nav-item.active{ padding-right:18px; }

    /* Shop becomes scroll layer over map */
    .shop{
      width:100%;
      height:auto;
      min-height:100vh;
      flex:none;
      position:relative;
      z-index:20;
      margin-top:calc(var(--mobile-map-h) - 24px);
      border-radius:24px 24px 0 0;
      box-shadow:0 -10px 40px rgba(0,0,0,0.08);
    }

    /* sections in flow on mobile */
    .app-section{
      position:relative;
      inset:auto;
      height:auto;
      opacity:1;
      visibility:visible;
      pointer-events:auto;
      transform:none;
      display:none;
      overflow:visible;
      padding:20px;
    }
    .app-section.active-section{ display:flex; }

    #sect-gallery{ padding:0; }

    /* gallery category nav ONE LINE */
    .shop-head{
      padding:16px 16px;
      position:sticky;
      top:0;
      z-index:60;
      display:block;
    }
    .nav-group{
      flex-wrap:nowrap;
      white-space:nowrap;
      overflow-x:auto;
      -webkit-overflow-scrolling:touch;
      gap:10px;
      padding-right:6px;
    }
    .nav-group::-webkit-scrollbar{ display:none; }
    .chip{
      flex:0 0 auto;
      font-size:13px;
      padding:10px 18px;
      background:#f5f5f5;
      border-radius:30px;
      color:#666;
      margin:0;
    }
    .chip.active{ background:#111; color:#fff; box-shadow:0 4px 10px rgba(0,0,0,0.15); }

    .shop-body{ padding:18px 16px 90px; overflow:visible; min-height:auto; }
    .grid{ grid-template-columns:repeat(2,1fr); gap:15px; }
    .card{ padding:15px; }
    .card-media{ height:120px; }
    .solo-media-container{ height:300px; }

    /* product media tabs one line */
    .media-tabs-bar{ justify-content:center; }
    .media-tabs{ gap:8px; }
    .media-tab{ padding:7px 10px; font-size:10px; }

    .v360-controls{ width:min(520px,88%); bottom:14px; }
    .v360-range::-webkit-slider-thumb{ width:46px; height:16px; }

    /* services on mobile */
    .services-wrap{ padding:42px 18px; }
    .services-grid{ grid-template-columns:repeat(2, minmax(0,1fr)); gap:34px 18px; }
    .svc h3{ font-size:22px; }
  }

  @media (max-width:420px){
    .nav-item{ padding:16px 14px; font-size:11px; }
    .media-tabs{ gap:6px; }
    .media-tab{ padding:6px 8px; font-size:9px; }
    .about-panels{ grid-template-columns:1fr; }
    .about-split{ grid-template-columns:1fr; }
  }
</style>
</head>

<body>
<div class="layout">
  <div id="map">
    <nav class="side-nav" id="sideNav">
      <div class="nav-item" id="navHome">Home</div>
      <div class="nav-item" id="navAbout">About Us</div>
      <div class="nav-item" id="navServices">Services</div>
      <div class="nav-item active" id="navGallery">Gallery</div>
      <div class="nav-item" id="navContact">Contacts</div>
    </nav>
  </div>

  <aside class="shop" id="shop">

    <!-- HOME -->
    <section id="sect-home" class="app-section">
      <div class="home-top">
        <img
          class="home-logo"
          src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693e9cd364bca27486a365c1_WhatsApp%20Image%202025-12-13%20at%2023.26.34_6e0cb159.jpg"
          alt="FNN Logo"
        />
      </div>

      <div class="home-hero"></div>

      <h1 class="sec-title">Welcome to FNN</h1>
      <p class="sec-sub">
        A modern art platform presenting original artworks by selected artists — built to honor the artist, elevate the work, and connect creative expression with audiences and institutions.
      </p>
      <button class="btn-hero" onclick="switchSection('sect-gallery')">Explore Collection</button>
    </section>

    <!-- ABOUT -->
    <section id="sect-about" class="app-section">
      <div class="about-kicker">FNN • Art Content Center (NDCC)</div>
      <h1 class="sec-title">About Us</h1>

      <p class="about-lede">
        <strong>FNN</strong> is a modern art platform specializing in the presentation of original artworks by selected artists. Our mission is to elevate art as a cultural value and creative identity by providing a professional environment that honors both the artist and the artwork — while connecting creative expression with audiences and art institutions — with the ambition to become the <strong>Art Content Center (NDCC)</strong> for the art scene in the Kingdom of Saudi Arabia.
      </p>

      <div class="about-panels">
        <div class="about-panel">
          <h3>Mission</h3>
          <p>Build an elevated, professional space that protects the integrity of the artist and the artwork — and makes contemporary art feel accessible, serious, and alive.</p>
        </div>
        <div class="about-panel">
          <h3>Platform</h3>
          <p>Curated exhibitions, original productions, experimental formats, and content-driven programs that position art as cultural capital and ongoing dialogue.</p>
        </div>
        <div class="about-panel">
          <h3>NDCC Vision</h3>
          <p>A central node for art content creation, curation, archiving, and distribution — bridging artists, collectors, institutions, and the public.</p>
        </div>
      </div>

      <img
        src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693d582b580fad0c77f39d0e_Gemini_Generated_Image_ir55ypir55ypir55%20(1).png"
        style="width:100%; border-radius:16px; margin: 10px 0 22px;"
        alt="Studio"
      >

      <div class="about-split">
        <div class="about-list">
          <h4>Arts & Culture</h4>
          <ul>
            <li><strong>Curated art platforms:</strong> original works by selected local and international artists, with a focus on contemporary practice and emerging voices.</li>
            <li><strong>Art objects & installations:</strong> commissioned artworks, sculptural pieces, mixed-media works, and limited-edition objects developed or showcased under FNN.</li>
            <li><strong>Exhibitions & programs:</strong> gallery-style presentations, pop-ups, collaborations, and thematic programs exploring identity, place, and modern culture.</li>
            <li><strong>Publications & art content:</strong> documentation, essays, catalogs, and digital content positioning FNN as a reference for regional discourse.</li>
          </ul>
        </div>

        <div class="about-list">
          <h4>Infrastructure & Impact</h4>
          <ul>
            <li><strong>Cultural partnerships:</strong> collaboration with museums, cultural entities, developers, and brands to integrate art into public space and development.</li>
            <li><strong>Digital presence:</strong> online exhibitions, artist profiles, and visual archives extending the physical experience into media platforms.</li>
            <li><strong>Narrative building:</strong> shaping Saudi Arabia’s contemporary art narrative by treating art as a living cultural identity.</li>
            <li><strong>Audience engagement:</strong> creating accessible yet elevated experiences that connect diverse audiences to contemporary expression.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- SERVICES -->
    <section id="sect-services" class="app-section">
      <h1 class="sec-title">Services</h1>
      <p class="sec-sub">From concept to execution — a complete ecosystem for art planning, delivery, and long-term cultural impact.</p>

      <div class="services-wrap">
        <div class="services-grid">
          <!-- 1 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 0-4 12c.7.6 1 1.2 1 2h6c0-.8.3-1.4 1-2A7 7 0 0 0 12 2z"/>
            </svg>
            <h3>Creative Planning</h3>
            <p>Concept development and planning that blends contemporary vision with practical execution — aligned to your brand and space.</p>
          </div>

          <!-- 2 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 21l3-3"/><path d="M14 4l6 6"/><path d="M7 17l10-10"/><path d="M5 19l2 2"/>
            </svg>
            <h3>Original design</h3>
            <p>Original design proposals created with professional teams and international references — tailored to your artistic direction.</p>
          </div>

          <!-- 3 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M4 19V5"/><path d="M4 19h16"/><path d="M8 16V8"/><path d="M12 16V6"/><path d="M16 16v-9"/>
            </svg>
            <h3>Excellent structure</h3>
            <p>Structural design and analysis for large-scale works — including load combinations and safety optimization.</p>
          </div>

          <!-- 4 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 3v3"/><path d="M18.4 5.6l-2.1 2.1"/><path d="M21 12h-3"/><path d="M18.4 18.4l-2.1-2.1"/><path d="M12 21v-3"/><path d="M5.6 18.4l2.1-2.1"/><path d="M3 12h3"/><path d="M5.6 5.6l2.1 2.1"/>
            </svg>
            <h3>Crafted with ingenuity</h3>
            <p>Execution that respects craft and detail — combining modern fabrication with a disciplined artistic standard.</p>
          </div>

          <!-- 5 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 7h18"/><path d="M5 7v12h14V7"/><path d="M9 11h6"/><path d="M9 15h6"/>
            </svg>
            <h3>Professional installation</h3>
            <p>Installation planning, logistics, and on-site execution — coordinated across teams to ensure a safe, precise result.</p>
          </div>

          <!-- 6 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4"/><path d="M7 10l5-5 5 5"/><path d="M12 5v14"/>
            </svg>
            <h3>Refurbishment and Restoration</h3>
            <p>Restoration for outdoor and aging works — repairing damage, refining finish, and bringing pieces back to life.</p>
          </div>

          <!-- 7 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M3 12h18"/><path d="M7 12a5 5 0 0 1 10 0"/><path d="M7 12a5 5 0 0 0 10 0"/>
            </svg>
            <h3>Art rental</h3>
            <p>Curated rental programs for sculptures and contemporary works — ideal for events, activations, and showcases.</p>
          </div>

          <!-- 8 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 10c0 6-9 12-9 12S3 16 3 10a9 9 0 0 1 18 0z"/><path d="M12 10a3 3 0 1 0 0.001 0z"/>
            </svg>
            <h3>Site survey</h3>
            <p>On-site inspection, survey reporting, and coordination with project stakeholders to realize the artistic vision.</p>
          </div>

          <!-- 9 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7l-8 8-4-4"/><path d="M4 6h6"/><path d="M4 10h6"/><path d="M4 14h6"/>
            </svg>
            <h3>Curatorial services</h3>
            <p>Research, authentication support, classification, and exhibition planning — with strong institutional collaboration.</p>
          </div>

          <!-- 10 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 12a10 10 0 1 1-6-9"/><path d="M22 4v6h-6"/>
            </svg>
            <h3>Art Consultant</h3>
            <p>Professional guidance on art direction, concept proposals, and selection — presented with clear visual reasoning.</p>
          </div>

          <!-- 11 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M16 3h5v5"/><path d="M21 3l-7 7"/><path d="M8 7H3v14h14v-5"/>
            </svg>
            <h3>Art broker</h3>
            <p>Market access and fast information — connecting institutions, collectors, and artists through a trusted network.</p>
          </div>

          <!-- 12 -->
          <div class="svc">
            <svg class="svc-ico" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2l3 6 7 1-5 5 1 7-6-3-6 3 1-7-5-5 7-1z"/>
            </svg>
            <h3>Artistic Supervisor</h3>
            <p>From design creation and refinement to material choice and quality monitoring — supervision across the full cycle.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- GALLERY (active on load) -->
    <section id="sect-gallery" class="app-section active-section">
      <header class="shop-head">
        <nav class="nav-group" id="filters">
          <button class="chip active" data-filter="all" id="btnAll">ALL</button>
          <button class="chip" data-filter="cabinet">Cabinets</button>
          <button class="chip" data-filter="sideboard">Sideboards</button>
          <button class="chip" data-filter="decor">Decor</button>
        </nav>
      </header>

      <div class="shop-body">
        <div class="grid" id="grid"></div>

        <div class="solo-wrap" id="soloWrap">
          <div class="back-nav"><button class="btn-back" id="btnBack">← Back to Collection</button></div>

          <div class="media-tabs-bar">
            <div class="media-tabs" id="mediaTabs">
              <button class="media-tab active" data-media="images" id="tabImages">Images</button>
              <button class="media-tab" data-media="360" id="tab360">360</button>
              <button class="media-tab" data-media="video" id="tabVideo">Video</button>
              <button class="media-tab" data-media="3d" id="tab3D">3D</button>
            </div>
          </div>

          <div class="solo-media-container">
            <div class="solo-media" id="soloMedia"></div>
          </div>

          <div class="solo-info-block">
            <div class="solo-desc">
              <strong id="soloTitle">PRODUCT</strong><br>
              Contemporary design meeting functionality.
              <div class="data-row">
                <div class="data-item"><span>Material</span><span id="spMat">--</span></div>
                <div class="data-item"><span>Dimensions</span><span id="spDim">--</span></div>
                <div class="data-item"><span>Location</span><span id="soloStore">--</span></div>
              </div>
            </div>

            <div class="artist-profile" id="artistBtn">
              <div class="avatar"><img id="artistImg" src="" alt="Designer"></div>
              <div class="artist-info"><h4 id="artistName">--</h4><p id="artistRole">--</p></div>
              <div class="artist-cta">View Bio →</div>
            </div>

            <div class="actions">
              <button class="btn btn-primary" id="btnContactProduct">Contact Us</button>
              <button class="btn btn-ghost" id="btnClose">Close</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="sect-contact" class="app-section">
      <h1 class="sec-title">Get in Touch</h1>
      <p class="sec-sub">Interested in a piece? Let us know.</p>
      <form id="ajaxForm" action="https://formsubmit.co/anaskaroti@gmail.com" method="POST">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_template" value="table">
        <div class="form-group"><input type="text" class="form-input" name="name" placeholder="Your Name" required></div>
        <div class="form-group"><input type="email" class="form-input" name="email" placeholder="Your Email" required></div>
        <div class="form-group"><input type="text" class="form-input" name="subject" placeholder="Subject" id="formSubject"></div>
        <div class="form-group"><textarea class="form-input" name="message" placeholder="Message..." rows="3"></textarea></div>
        <button type="submit" class="btn-submit" id="formSubmitBtn">Send Inquiry</button>
      </form>
      <div id="formSuccess">Thank you! Your inquiry has been received.</div>
    </section>

  </aside>
</div>

<!-- ARTIST & CONTACT MODALS -->
<div class="modal-overlay" id="modalArtistOverlay">
  <div class="modal-box">
    <button class="close-modal" id="closeArtistModal">×</button>
    <div class="artist-modal-header">
      <div class="artist-modal-avatar"><img id="modalArtistImg" src="" alt=""></div>
      <h3 id="modalArtistName"></h3>
      <span style="font-size:12px; color:#999; text-transform:uppercase;" id="modalArtistRole"></span>
    </div>
    <p class="artist-modal-bio" id="modalArtistBio"></p>
  </div>
</div>

<div class="modal-overlay" id="modalContactOverlay">
  <div class="modal-box">
    <button class="close-modal" id="closeContactModal">×</button>
    <h3 class="form-title">Inquire about this piece</h3>
    <form id="ajaxFormModal" action="https://formsubmit.co/anaskaroti@gmail.com" method="POST">
      <input type="hidden" name="_captcha" value="false">
      <input type="hidden" name="_template" value="table">
      <div class="form-group"><input type="text" class="form-input" name="name" placeholder="Your Name" required></div>
      <div class="form-group"><input type="email" class="form-input" name="email" placeholder="Your Email" required></div>
      <div class="form-group"><input type="text" class="form-input" name="subject" placeholder="Subject" id="formSubjectModal"></div>
      <div class="form-group"><textarea class="form-input" name="message" placeholder="Message..." rows="3"></textarea></div>
      <button type="submit" class="btn-submit" id="formSubmitBtnModal">Send Inquiry</button>
    </form>
    <div id="formSuccessModal">Thank you! Your inquiry has been received.</div>
  </div>
</div>

<script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
<script src="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.js"></script>

<script>
  /* ===== MAP CONFIG ===== */
  const MAPBOX_TOKEN = "pk.eyJ1IjoiYW5hc2thcm90aSIsImEiOiJjbWhqcHgwcmMwbWM0MmxwZ2V5Z2x5OTN0In0.bpOf-4BsljExZdYZUak_pw";
  const USER_STYLE = "mapbox://styles/anaskaroti/cmhuiic1f00ft01qucn91gk6e";

  mapboxgl.accessToken = MAPBOX_TOKEN;
  const isMobile = window.innerWidth < 900;
  const startZoom = isMobile ? 0 : 0.8;

  const map = new mapboxgl.Map({
    container: "map",
    style: USER_STYLE,
    center: [0, 20],
    zoom: startZoom,
    pitch: 0,
    projection: 'globe'
  });

  map.on('style.load', () => {
    try {
      map.setFog({
        'color': 'rgb(255, 255, 255)',
        'high-color': 'rgb(200, 200, 200)',
        'space-color': 'rgb(0, 0, 0)',
        'star-intensity': 0.6
      });
    } catch(e){}

    const layers = map.getStyle().layers;
    let labelLayerId;
    for (const layer of layers) {
      if (layer.type === 'symbol' && layer.layout['text-field']) { labelLayerId = layer.id; break; }
    }
    if (!map.getLayer('3d-buildings-custom')) {
      map.addLayer({
        'id': '3d-buildings-custom',
        'source': 'composite',
        'source-layer': 'building',
        'filter': ['==', 'extrude', 'true'],
        'type': 'fill-extrusion',
        'minzoom': 15,
        'paint': {
          'fill-extrusion-color': '#aaa',
          'fill-extrusion-height': ['get', 'height'],
          'fill-extrusion-base': ['get', 'min_height'],
          'fill-extrusion-opacity': 0.6
        }
      }, labelLayerId);
    }
    for (const layer of layers) {
      if (layer.type === 'symbol' && layer.layout['text-field']) {
        map.setLayoutProperty(layer.id, 'text-size',
          ["interpolate", ["linear"], ["zoom"], 0, 6, 10, 8, 22, 10]
        );
      }
    }
  });

  /* ===== NAVIGATION LOGIC ===== */
  window.switchSection = function(id) {
    document.querySelectorAll('.app-section').forEach(s => s.classList.remove('active-section'));
    const target = document.getElementById(id);
    if (target) target.classList.add('active-section');

    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    const navIdMap = {
      'sect-home': 'navHome',
      'sect-about': 'navAbout',
      'sect-services': 'navServices',
      'sect-gallery': 'navGallery',
      'sect-contact': 'navContact'
    };
    const navEl = document.getElementById(navIdMap[id]);
    if (navEl) navEl.classList.add('active');

    if(id === 'sect-home') {
      map.flyTo({ center: [0, 20], zoom: startZoom, pitch: 0, bearing: 0, duration: 2000 });
    }
  }

  const safeAdd = (id, ev, handler) => {
    const el = document.getElementById(id);
    if (el) el.addEventListener(ev, handler);
  };

  safeAdd('navHome', 'click', () => switchSection('sect-home'));
  safeAdd('navAbout', 'click', () => switchSection('sect-about'));
  safeAdd('navServices', 'click', () => switchSection('sect-services'));
  safeAdd('navGallery', 'click', () => switchSection('sect-gallery'));
  safeAdd('navContact', 'click', () => switchSection('sect-contact'));

  /* ===== FORM LOGIC ===== */
  const form = document.getElementById('ajaxForm');
  const submitBtn = document.getElementById('formSubmitBtn');
  const successMsg = document.getElementById('formSuccess');

  if (form) {
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      if (submitBtn) { submitBtn.textContent = "Sending..."; submitBtn.style.opacity = "0.7"; }
      fetch(form.action, {
        method: "POST",
        body: new FormData(form),
        headers: { 'Accept': 'application/json' }
      })
      .then(response => {
        if (response.ok) {
          form.style.display = "none";
          if (successMsg) successMsg.style.display = "block";
        } else {
          alert("Oops! Problem submitting.");
          if (submitBtn) submitBtn.textContent = "Try Again";
        }
      })
      .catch(() => {
        alert("Oops! Problem submitting.");
        if (submitBtn) submitBtn.textContent = "Try Again";
      });
    });
  }

  const formModal = document.getElementById('ajaxFormModal');
  const submitBtnModal = document.getElementById('formSubmitBtnModal');
  const successMsgModal = document.getElementById('formSuccessModal');

  if (formModal) {
    formModal.addEventListener('submit', function(e) {
      e.preventDefault();
      if (submitBtnModal) { submitBtnModal.textContent = "Sending..."; submitBtnModal.style.opacity = "0.7"; }
      fetch(formModal.action, {
        method: "POST",
        body: new FormData(formModal),
        headers: { 'Accept': 'application/json' }
      })
      .then(response => {
        if (response.ok) {
          formModal.style.display = "none";
          if (successMsgModal) successMsgModal.style.display = "block";
        } else {
          alert("Oops! Problem submitting.");
          if (submitBtnModal) submitBtnModal.textContent = "Try Again";
        }
      })
      .catch(() => {
        alert("Oops! Problem submitting.");
        if (submitBtnModal) submitBtnModal.textContent = "Try Again";
      });
    });
  }

  /* ===== MAP ANIMATION ===== */
  let currentMarker = null;
  let rotationFrame = null;

  function gotoStore(store) {
    if(!store) return;
    if(rotationFrame){ cancelAnimationFrame(rotationFrame); rotationFrame = null; }
    if(currentMarker) currentMarker.remove();
    const el = document.createElement('div');
    el.style.backgroundColor='#111';
    el.style.width='20px';
    el.style.height='20px';
    el.style.borderRadius='50%';
    el.style.border='2px solid white';
    currentMarker = new mapboxgl.Marker(el).setLngLat(store.coords).addTo(map);
    map.flyTo({
      center: store.coords,
      zoom: 16.5,
      pitch: 65,
      bearing: Math.random()*90,
      speed: 0.3,
      curve: 1.2,
      essential: true,
      duration: 10000
    });
    map.once('moveend', () => {
      function rotate(){
        map.rotateTo((map.getBearing()+0.05)%360, {duration:0});
        rotationFrame = requestAnimationFrame(rotate);
      }
      rotate();
    });
  }

  /* ===== DATA ===== */
  const PRODUCTS = [
    { id: "item-1", name: "Arch Cabinet", category: "cabinet", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a23d0fd8b7e2bc457_Screenshot_2025-11-23_141726-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/base%20(5).glb", specs: { mat: "Velvet & Wood", dim: "120x60x90" }, store: { name: "Milan Design District", coords: [9.1900, 45.4642] }, artist: { name: "Alessandro Rossi", role: "Art Director, Milano", img: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=100&q=80", bio: "Alessandro combines classical Italian joinery with bold, modern geometric forms." } },
    { id: "item-2", name: "Geometric Side", category: "sideboard", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a7e9f217180e18c6d_Screenshot_2025-11-23_142545-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/base%20%289%29.glb", specs: { mat: "Lacquered Wood", dim: "180x50x200" }, store: { name: "Paris Le Marais", coords: [2.3522, 48.8566] }, artist: { name: "Claire Dubois", role: "Sculptor, Paris", img: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?auto=format&fit=crop&w=100&q=80", bio: "Claire challenges the perception of stability with her organic, tree-like structures." } },
    { id: "item-3", name: "Art Deco Tall", category: "cabinet", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a3f4cd0cdf6848da0_Screenshot_2025-11-23_142423-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/base%20(7).glb", specs: { mat: "Marble & Brass", dim: "220x80x95" }, store: { name: "New York SoHo", coords: [-74.006, 40.7128] }, artist: { name: "Marcus Thorne", role: "Industrial Designer, NY", img: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=100&q=80", bio: "Marcus revives 1920s Art Deco aesthetics for the modern Manhattan loft." } },
    { id: "item-4", name: "Striped Console", category: "decor", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a8659147dcb3f38ed_Screenshot_2025-11-23_142604-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1763910785694_base%20(4).glb", specs: { mat: "Resin & Paint", dim: "100x60x140" }, store: { name: "Tokyo Harajuku", coords: [139.7034, 35.6719] }, artist: { name: "Kenji Sato", role: "Pop Artist, Tokyo", img: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=100&q=80", bio: "Kenji blurs the lines between collectible toys and functional high-end furniture." } },
    { id: "item-5", name: "Radiance Credenza", category: "sideboard", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a361104af2bd0614b_Screenshot_2025-11-23_142501-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/base%20(8).compressed.glb", specs: { mat: "Ebony & Gold", dim: "200x55x85" }, store: { name: "Dubai Design Dist", coords: [55.2962, 25.2769] }, artist: { name: "Zara Al-Fayed", role: "Luxury Artisan, Dubai", img: "https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=100&q=80", bio: "Zara's work is a fusion of traditional Middle Eastern patterns and ultra-modern luxury." } },
    { id: "item-6", name: "Modular Unit", category: "decor", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a36286c4236e924d2_Screenshot_2025-11-23_142346-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/base%20%286%29.glb", specs: { mat: "Ceramic Composite", dim: "120x120x120" }, store: { name: "Copenhagen", coords: [12.5683, 55.6761] }, artist: { name: "Erik Jensen", role: "Minimalist, Copenhagen", img: "https://images.unsplash.com/photo-1472099645785-5658abf4ffad8d80?auto=format&fit=crop&w=100&q=80", bio: "Erik believes in infinite adaptability. His modular systems grow with the user." } },
    { id: "item-7", name: "Lunar Chest", category: "cabinet", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620c47e4acac61094bf_Screenshot_2025-11-24_171517-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071266806_base%20(15).glb", specs: { mat: "Oak & Silver", dim: "110x55x130" }, store: { name: "London Tate Modern", coords: [-0.099, 51.507] }, artist: { name: "Oliver Sterling", role: "Modernist, London", img: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=100&q=80", bio: "Oliver explores celestial themes using industrial materials." } },
    { id: "item-8", name: "Obsidian Block", category: "sideboard", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620636bab60cf866e4e_Screenshot_2025-11-24_171459-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071270533_base%20(14).glb", specs: { mat: "Blackened Steel", dim: "200x60x80" }, store: { name: "Berlin Mitte", coords: [13.405, 52.520] }, artist: { name: "Klaus Weber", role: "Architect, Berlin", img: "https://images.unsplash.com/photo-1492562080023-ab3db95bfbce?auto=format&fit=crop&w=100&q=80", bio: "Klaus brings brutalist architecture principles into interior design." } },
    { id: "item-9", name: "Azure Tower", category: "cabinet", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620466eab1b5ac247c4_Screenshot_2025-11-24_171450-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071273205_base%20(13).glb", specs: { mat: "Blue Lacquer", dim: "80x80x180" }, store: { name: "Barcelona Eixample", coords: [2.168, 41.387] }, artist: { name: "Sofia Miró", role: "Colorist, Barcelona", img: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=100&q=80", bio: "Sofia's work is a vibrant homage to the Mediterranean spirit." } },
    { id: "item-10", name: "Solar Credenza", category: "sideboard", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/692486204f857514d1d4b590_Screenshot_2025-11-24_171432-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071348834_base%20(12).glb", specs: { mat: "Teak & Brass", dim: "220x50x75" }, store: { name: "Mexico City Polanco", coords: [-99.19, 19.43] }, artist: { name: "Diego Rivera", role: "Carpenter, CDMX", img: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=100&q=80", bio: "Diego fuses Aztec geometry with mid-century modern lines." } },
    { id: "item-11", name: "Nordic Wave", category: "decor", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620b770e284e36cee5d_Screenshot_2025-11-24_171419-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071190268_base%20(11).glb", specs: { mat: "Ash Wood", dim: "140x40x90" }, store: { name: "Stockholm Södermalm", coords: [18.068, 59.329] }, artist: { name: "Elina Vinter", role: "Designer, Stockholm", img: "https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&w=100&q=80", bio: "Elina captures the fluidity of water in solid wood forms." } },
    { id: "item-12", name: "Crimson Vanity", category: "cabinet", img: "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620cbc59348dc423f83_Screenshot_2025-11-24_171401-removebg-preview.png", model: "https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071194478_base%20(10).glb", specs: { mat: "Red Velvet & Gold", dim: "100x50x150" }, store: { name: "Seoul Gangnam", coords: [127.027, 37.497] }, artist: { name: "Min-Jun Kim", role: "Fashion Designer, Seoul", img: "https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=100&q=80", bio: "Min-Jun treats furniture like haute couture, focusing on texture and drama." } }
  ];

  const DEFAULT_IMAGES = [
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca9c47857d958372698_Gemini_Generated_Image_yiit8eyiit8eyiit.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca9fd2fa99da51c575a_Gemini_Generated_Image_qrrx4iqrrx4iqrrx.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca9978004d5fa2a3d3a_Gemini_Generated_Image_6hnali6hnali6hna.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca9ff7c4713583ae7b5_Gemini_Generated_Image_im37uhim37uhim37.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca8c4a4dc0af86da352_Gemini_Generated_Image_rn5h5urn5h5urn5h.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca8c641d77b3de17010_Gemini_Generated_Image_mhci8mmhci8mmhci.png"
  ];

  /* UPDATED 360 VIDEO */
  const DEFAULT_360_URL = "https://raw.githubusercontent.com/lwiise/3d-models/main/Product_Video_Generation_With_Rotation.mp4";
  const DEFAULT_VIDEO_URL = "https://raw.githubusercontent.com/lwiise/3d-models/main/Artistic_Video_Generation_Request.mp4";

  PRODUCTS.forEach(p => {
    p.images = Array.isArray(p.images) && p.images.length ? p.images : DEFAULT_IMAGES;
    p.video360 = p.video360 || DEFAULT_360_URL;
    p.video = p.video || DEFAULT_VIDEO_URL;
  });

  const grid = document.getElementById("grid");
  const soloMedia = document.getElementById("soloMedia");

  function render(list){
    if(!grid) return;
    grid.innerHTML = "";
    list.forEach(p => {
      const el = document.createElement("article");
      el.className = "card";
      el.innerHTML = `
        <div class="card-media"><img src="${p.img}" alt="${p.name}"/></div>
        <div class="card-name">${p.name}</div>
        <div class="card-sub">Edition 2024</div>`;
      el.addEventListener("click", () => openSolo(p));
      grid.appendChild(el);
    });
  }

  const filtersEl = document.getElementById("filters");
  if(filtersEl){
    filtersEl.addEventListener("click", e => {
      const btn = e.target.closest(".chip");
      if(!btn) return;
      document.querySelectorAll(".chip").forEach(c => c.classList.remove("active"));
      btn.classList.add("active");
      const f = btn.dataset.filter;
      render(f === "all" ? PRODUCTS : PRODUCTS.filter(p => p.category === f));
    });
  }

  /* ===== MEDIA SWITCHER LOGIC ===== */
  let activeProduct = null;
  let sliderIndex = 0;

  function setActiveTabUI(type){
    document.querySelectorAll(".media-tab").forEach(b => b.classList.remove("active"));
    const map = { images:"tabImages", "360":"tab360", video:"tabVideo", "3d":"tab3D" };
    const btn = document.getElementById(map[type]);
    if(btn) btn.classList.add("active");
  }

  function renderImages(p){
    const imgs = Array.isArray(p.images) && p.images.length ? p.images : [p.img];
    sliderIndex = Math.max(0, Math.min(sliderIndex, imgs.length - 1));

    soloMedia.innerHTML = `
      <div class="img-slider">
        <button class="slider-arrow left" id="imgPrev" aria-label="Previous">‹</button>
        <img id="imgSlide" src="${imgs[sliderIndex]}" alt="${p.name}">
        <button class="slider-arrow right" id="imgNext" aria-label="Next">›</button>
      </div>
    `;

    const imgEl = document.getElementById("imgSlide");
    const prev = document.getElementById("imgPrev");
    const next = document.getElementById("imgNext");

    const update = () => { if(imgEl) imgEl.src = imgs[sliderIndex]; };

    if(prev) prev.addEventListener("click", () => { sliderIndex = (sliderIndex - 1 + imgs.length) % imgs.length; update(); });
    if(next) next.addEventListener("click", () => { sliderIndex = (sliderIndex + 1) % imgs.length; update(); });
  }

  function renderVideo(url){
    if(!url){ soloMedia.innerHTML = `<div style="color:#999; font-size:13px; font-weight:700;">No video available</div>`; return; }
    soloMedia.innerHTML = `<video src="${url}" controls playsinline preload="metadata"></video>`;
  }

  function render360(url){
    if(!url){ soloMedia.innerHTML = `<div style="color:#999; font-size:13px; font-weight:700;">No 360 available</div>`; return; }

    soloMedia.innerHTML = `
      <div class="v360-wrap">
        <video id="v360" src="${url}" playsinline preload="metadata"></video>
        <div class="v360-controls">
          <button class="v360-btn" id="v360Play" aria-label="Play/Pause">▶</button>
          <input class="v360-range" id="v360Range" type="range" min="0" value="0" step="1" aria-label="Scrub">
        </div>
      </div>
    `;

    const v = document.getElementById("v360");
    const btn = document.getElementById("v360Play");
    const rng = document.getElementById("v360Range");
    if(!v || !btn || !rng) return;

    let seeking = false;
    const setIcon = () => { btn.textContent = v.paused ? "▶" : "❚❚"; };

    v.addEventListener("loadedmetadata", () => {
      const dur = Number.isFinite(v.duration) ? v.duration : 0;
      rng.max = Math.max(1, Math.floor(dur * 1000));
      rng.value = 0;
      setIcon();
    });

    v.addEventListener("timeupdate", () => {
      if(seeking) return;
      rng.value = Math.floor(v.currentTime * 1000);
    });

    btn.addEventListener("click", () => { v.paused ? v.play() : v.pause(); setIcon(); });
    v.addEventListener("play", setIcon);
    v.addEventListener("pause", setIcon);

    rng.addEventListener("input", () => {
      seeking = true;
      v.currentTime = (Number(rng.value) || 0) / 1000;
    });
    rng.addEventListener("change", () => { seeking = false; });

    v.addEventListener("click", () => { v.paused ? v.play() : v.pause(); setIcon(); });

    v.pause();
    setIcon();
  }

  function render3D(p){
    if(p.model){
      const safeUrl = p.model.replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/ /g,'%20');
      soloMedia.innerHTML = `
        <model-viewer
          id="viewer3d"
          src="${safeUrl}"
          camera-controls
          auto-rotate
          shadow-intensity="1"
          style="background:transparent; width:100%; height:100%;"
          camera-orbit="45deg 75deg 3m"
          environment-image="neutral"
          alt="3D">
        </model-viewer>
      `;
      const viewer = document.getElementById("viewer3d");
      if(viewer){
        viewer.addEventListener("error", (e) => {
          console.warn("Model load error:", e);
          soloMedia.innerHTML = `<img src="${p.img}" alt="${p.name}" />`;
        });
      }
    }else{
      soloMedia.innerHTML = `<img src="${p.img}" alt="${p.name}" />`;
    }
  }

  function setMedia(type){
    if(!activeProduct) return;
    setActiveTabUI(type);
    if(type === "images") return renderImages(activeProduct);
    if(type === "360") return render360(activeProduct.video360);
    if(type === "video") return renderVideo(activeProduct.video);
    if(type === "3d") return render3D(activeProduct);
  }

  const mediaTabs = document.getElementById("mediaTabs");
  if(mediaTabs){
    mediaTabs.addEventListener("click", (e) => {
      const btn = e.target.closest(".media-tab");
      if(!btn) return;
      setMedia(btn.dataset.media);
    });
  }

  function openSolo(p){
    activeProduct = p;
    sliderIndex = 0;

    document.getElementById("shop").classList.add("solo");
    document.getElementById("sect-gallery").classList.add("solo");

    document.getElementById("soloTitle").textContent = p.name.toUpperCase();
    document.getElementById("soloStore").textContent = p.store.name;
    document.getElementById("spMat").textContent = p.specs.mat;
    document.getElementById("spDim").textContent = p.specs.dim;
    document.getElementById("artistName").textContent = p.artist.name;
    document.getElementById("artistRole").textContent = p.artist.role;
    document.getElementById("artistImg").src = p.artist.img;
    document.getElementById("modalArtistName").textContent = p.artist.name;
    document.getElementById("modalArtistRole").textContent = p.artist.role;
    document.getElementById("modalArtistImg").src = p.artist.img;
    document.getElementById("modalArtistBio").textContent = p.artist.bio;

    const fs = document.getElementById("formSubject");
    if(fs) fs.value = "Inquiry: " + p.name;
    const fsM = document.getElementById("formSubjectModal");
    if(fsM) fsM.value = "Inquiry: " + p.name;

    const sideNav = document.getElementById("sideNav");
    if(sideNav) sideNav.classList.add("focused");

    setMedia("images");
    gotoStore(p.store);
  }

  function closeSolo(){
    const shopEl = document.getElementById("shop");
    const galleryEl = document.getElementById("sect-gallery");
    if(shopEl) shopEl.classList.remove("solo");
    if(galleryEl) galleryEl.classList.remove("solo");

    const sideNav = document.getElementById("sideNav");
    if(sideNav) sideNav.classList.remove("focused");

    activeProduct = null;
    soloMedia.innerHTML = "";

    if(rotationFrame){ cancelAnimationFrame(rotationFrame); rotationFrame = null; }
    const isMobileReset = window.innerWidth < 900;
    map.flyTo({ center:[0,20], zoom:isMobileReset ? 0 : 0.8, pitch:0, bearing:0, duration:2500 });
  }

  safeAdd("btnBack", "click", closeSolo);
  safeAdd("btnClose", "click", closeSolo);
  safeAdd("btnContactProduct", "click", () => switchSection("sect-contact"));

  const modalArtist = document.getElementById("modalArtistOverlay");
  const modalContact = document.getElementById("modalContactOverlay");

  const artistBtnEl = document.getElementById("artistBtn");
  if(artistBtnEl) artistBtnEl.addEventListener("click", () => { if(modalArtist) modalArtist.classList.add("open"); });

  const closeArtistModalBtn = document.getElementById("closeArtistModal");
  if(closeArtistModalBtn) closeArtistModalBtn.addEventListener("click", () => { if(modalArtist) modalArtist.classList.remove("open"); });

  const closeContactModalBtn = document.getElementById("closeContactModal");
  if(closeContactModalBtn) closeContactModalBtn.addEventListener("click", () => { if(modalContact) modalContact.classList.remove("open"); });

  window.addEventListener("click", e => {
    if(e.target === modalArtist && modalArtist) modalArtist.classList.remove("open");
    if(e.target === modalContact && modalContact) modalContact.classList.remove("open");
  });

  (function initGalleryOnLoad(){
    function initGallery(){
      try{
        const gridNode = document.getElementById("grid");
        if(!gridNode) return;

        let btnAll = document.getElementById("btnAll");
        if(!btnAll) btnAll = document.querySelector('.chip[data-filter="all"]');

        document.querySelectorAll(".chip").forEach(c => c.classList.remove("active"));
        if(btnAll) btnAll.classList.add("active");

        document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));
        const navGallery = document.getElementById("navGallery");
        if(navGallery) navGallery.classList.add("active");

        render(PRODUCTS);
      }catch(err){
        console.error("[initGallery] unexpected error", err);
      }
    }

    if(document.readyState === "complete" || document.readyState === "interactive"){
      setTimeout(initGallery, 20);
    }else{
      document.addEventListener("DOMContentLoaded", () => setTimeout(initGallery, 20));
    }
  })();

  window._finna_render = () => {
    try { render(PRODUCTS); console.info("manual render done"); } catch(e) { console.error(e); }
  };
</script>
</body>
</html>
