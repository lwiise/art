<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Finna Art - Gallery</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
<link href="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.css" rel="stylesheet" />
<style>
  :root{
    --bg:#fff;
    --text-main:#222;
    --accent:#111;
    --muted:#666;
    --card-radius:32px;
    --btn-radius:30px;
    --side-nav-height:380px;
    --side-nav-offset:34px;
  }

  *,*::before,*::after{ box-sizing:border-box; -webkit-font-smoothing:antialiased; }
  [hidden]{ display:none !important; }
  body{
    margin:0; height:100vh; width:100vw;
    background:#fff; color:var(--text-main);
    font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .layout{
    display:flex;
    height:100vh;
    width:100vw;
    max-width:none;
    gap:0;
  }

  #map{
    flex:0 0 31%;
    height:100%;
    background:#000;
    position:relative;
    overflow:hidden;
    border-radius:0;
    box-shadow:0 26px 60px rgba(0,0,0,0.16);
  }

  .mapboxgl-canvas{ outline:none; filter:grayscale(100%) contrast(1.12) brightness(1); }

  /* ===== 3D POPUP OVER MAP (fixed box, model rotates inside) ===== */
  .map-3d-popup{
    position:absolute;
    left:50%;
    top:50%;
    /* ✅ up by 50% of its size + left by 20% of its size */
    transform:translate(-70%, -100%);
    width:50%;
    aspect-ratio:1/1;
    max-width:560px;
    min-width:240px;
    border-radius:24px;
    overflow:hidden;
    z-index:60;
    background:rgba(255,255,255,0.10);
    border:1px solid rgba(255,255,255,0.18);
    box-shadow:0 30px 80px rgba(0,0,0,0.40);
    backdrop-filter:blur(18px);
    -webkit-backdrop-filter:blur(18px);
    opacity:0;
    visibility:hidden;
    pointer-events:none;
    touch-action:none;
    transition:opacity .25s ease;
  }
  .map-3d-popup.show{
    opacity:1;
    visibility:visible;
    pointer-events:auto;
  }
  .map-3d-inner{
    width:100%;
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    background:transparent;
  }
  .map-3d-inner model-viewer{
    width:100%;
    height:100%;
    background:transparent;
    touch-action:none;
  }

  .side-nav{
    position:absolute; top:auto; bottom:var(--side-nav-offset); right:0; transform:none;
    display:flex; flex-direction:column; z-index:20;
    background:rgba(0,0,0,0.5);
    backdrop-filter:blur(15px); -webkit-backdrop-filter:blur(15px);
    border-radius:20px 0 0 20px;
    border-left:1px solid rgba(255,255,255,0.15);
    border-top:1px solid rgba(255,255,255,0.15);
    border-bottom:1px solid rgba(255,255,255,0.15);
    box-shadow:-10px 0 30px rgba(0,0,0,0.3);
    transition:background 0.3s, border-color 0.3s;
    height:var(--side-nav-height);
  }
  .side-nav.focused{
    background:rgba(0,0,0,0.75);
    border-color:rgba(255,255,255,0.1);
  }
  .nav-item{
    padding:22px 40px;
    color:rgba(255,255,255,0.8);
    font-weight:600; font-size:14px;
    text-transform:uppercase; letter-spacing:0.05em;
    border-bottom:1px solid rgba(255,255,255,0.1);
    transition:all 0.3s ease;
    cursor:pointer; text-align:center;
    text-shadow:0 2px 10px rgba(0,0,0,0.5);
    user-select:none;
  }
  .side-nav .nav-item{
    flex:1;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .nav-item:last-child{ border-bottom:none; }
  .nav-item:hover,
  .nav-item.active{
    background:rgba(255,255,255,0.2);
    color:#fff;
    padding-right:50px;
  }
  .side-nav .nav-item:hover,
  .side-nav .nav-item.active{
    border-radius:20px 0 0 20px;
  }

  .mobile-nav{
    display:none;
    position:absolute;
    left:12px;
    right:12px;
    transform:none;
    bottom:40px;
    z-index:30;
    background:rgba(0,0,0,0.55);
    backdrop-filter:blur(16px); -webkit-backdrop-filter:blur(16px);
    border:1px solid rgba(255,255,255,0.10);
    box-shadow:0 12px 26px rgba(0,0,0,0.35);
    border-radius:999px;
    padding:6px;
    gap:4px;
    width:auto;
    max-width:720px;
    margin:0 auto;
    overflow:hidden;
  }
  .mobile-nav .nav-item{
    border:none;
    padding:10px 6px;
    border-radius:12px;
    font-size:10px;
    letter-spacing:0.05em;
    line-height:1.1;
    white-space:normal;
    background:transparent;
    flex:1;
    min-width:0;
  }
  .mobile-nav .nav-item:hover,
  .mobile-nav .nav-item.active{
    padding:10px 6px;
    background:rgba(255,255,255,0.14);
  }

  .shop{
    flex:0 0 69%;
    display:flex;
    flex-direction:column;
    height:100%;
    background:#fff;
    position:relative;
    z-index:5;
    box-shadow:0 26px 60px rgba(0,0,0,0.10);
    overflow:hidden; /* ✅ prevent right overflow */
    border-radius:0;
  }

  .app-section{
    position:absolute; inset:0;
    display:flex; flex-direction:column;
    background:#fff;
    opacity:0; visibility:hidden; pointer-events:none;
    transform:translateY(18px);
    transition:opacity .35s ease, transform .35s ease;
    z-index:1;
    overflow:hidden;
  }
  .app-section.active-section{
    opacity:1; visibility:visible; pointer-events:auto;
    transform:translateY(0); z-index:10;
  }

  .section-scroll{
    height:100%;
    overflow-y:auto;
    padding:40px;
  }

  .section-scroll, .shop-body{
    -ms-overflow-style:auto;
    scrollbar-width:auto;
  }
  .section-scroll::-webkit-scrollbar, .shop-body::-webkit-scrollbar{ width:10px; height:10px; }
  .section-scroll::-webkit-scrollbar-thumb, .shop-body::-webkit-scrollbar-thumb{
    background:rgba(0,0,0,.22);
    border-radius:999px;
  }
  .section-scroll::-webkit-scrollbar-track, .shop-body::-webkit-scrollbar-track{ background:transparent; }

  h1.sec-title{ font-size:34px; font-weight:900; margin:0 0 12px; letter-spacing:-0.02em; color:#111; }
  p.sec-sub{ font-size:16px; color:var(--muted); line-height:1.7; margin:0 0 24px; width:100%; }

  /* =========================================================
     HOME - matches screenshot layout
     - No scroll needed
     - Logo/top area + 2-column main (copy left, image right)
     - Left copy + CTA
     ========================================================= */
  #sect-home .section-scroll{
    padding:0;
    overflow:hidden;    /* no scroll in Home */
    height:100%;
  }

  .home-screen{
    --home-pad-left:52px;
    --home-pad-right:52px;
    height:100%;
    padding:38px var(--home-pad-right) var(--side-nav-offset) var(--home-pad-left);
    display:flex;
    flex-direction:column;
    gap:16px;
    overflow:hidden;
    justify-content:flex-start;
    position:relative;
    background:#fff;
  }
  .home-screen::after{ display:none; }

  .home-top{
    flex:0 0 auto;
    display:flex;
    flex-direction:column;
    --home-logo-width:min(900px, 92%);
    align-items:center;
    gap:6px;
    position:relative;
    z-index:1;
    text-align:center;
  }

  .home-top small{
    color:#9a9a9a;
    font-weight:600;
    font-size:20px;
    letter-spacing:0.02em;
    width:var(--home-logo-width);
    text-align:left;
    padding-left:5%;
    box-sizing:border-box;
  }

  .home-logo{
    width:var(--home-logo-width);
    height:auto;
    display:block;
    object-fit:contain;
    margin:0 auto;
  }

  .home-tagline{
    font-size:16px;
    letter-spacing:0.5em;
    text-transform:uppercase;
    font-weight:700;
    color:#6f6f6f;
    width:var(--home-logo-width);
    margin:0 auto;
    text-align:center;
  }

  .home-main{
    flex:1;
    min-height:0;
    display:grid;
    grid-template-columns:1fr;
    grid-template-rows:1fr;
    gap:0;
    align-items:stretch;
    align-content:stretch;
    justify-items:stretch;
    margin-top:auto;
    margin-left:calc(-1 * var(--home-pad-left));
    margin-right:calc(-1 * var(--home-pad-right));
    width:calc(100% + var(--home-pad-left) + var(--home-pad-right));
    position:relative;
    z-index:1;
    border-radius:0;
    overflow:hidden;
  }

  .home-banner{
    position:absolute;
    top:0;
    bottom:0;
    left:0;
    width:min(38%, 440px);
    background:#f2f2f2;
    background:linear-gradient(90deg, rgba(242,242,242,0.98) 0%, rgba(242,242,242,0.96) 55%, rgba(242,242,242,0.0) 100%);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    gap:14px;
    padding:28px 26px;
    height:100%;
    z-index:2;
  }
  .home-banner-title{
    margin:0;
    font-size:28px;
    font-weight:800;
    line-height:1.2;
    color:#111;
    text-align:center;
  }
  .home-banner-title span{ display:block; }
  .home-banner-btn{
    border:1px solid #e64a4a;
    background:#e64a4a;
    color:#fff;
    font-weight:700;
    font-size:21px;
    padding:13px 24px;
    border-radius:999px;
    cursor:pointer;
  }

  /* Home copy block */
  .home-copy{
    align-self:end;
    justify-self:start;
    margin:0 0 0 calc(-1 * var(--home-pad-left));
    width:fit-content;
    max-width:100%;
    display:flex;
    align-items:flex-end;
  }
  .home-glass{
    width:fit-content;
    max-width:100%;
    height:var(--side-nav-height);
    min-height:var(--side-nav-height);
    max-height:var(--side-nav-height);
    --home-glass-pad-x:34px;
    padding:30px var(--home-glass-pad-x);
    border-radius:0 22px 22px 0;
    background:rgba(240,240,240,0.78);
    border:1px solid rgba(255,255,255,0.9);
    box-shadow:0 18px 32px rgba(0,0,0,0.08);
    backdrop-filter:blur(12px);
    -webkit-backdrop-filter:blur(12px);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    gap:18px;
  }
  .home-copy-title{
    margin:0;
    font-size:42px;
    font-weight:700;
    color:#5f5f5f;
    letter-spacing:0.02em;
    line-height:1.4;
  }
  .home-copy-title span{ display:block; text-align:center; }

  .btn-home{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    padding:14px 28px;
    border-radius:999px;
    border:1px solid rgba(228,144,144,0.7);
    cursor:pointer;
    font-weight:700;
    font-size:13px;
    letter-spacing:0.06em;
    text-transform:none;
    color:#7b4b4b;
    background:rgba(228,144,144,0.28);
    box-shadow:0 8px 14px rgba(0,0,0,0.08);
    white-space:nowrap;
  }
  .btn-home:hover{ background:rgba(228,144,144,0.38); }

  .home-illustration-wrap{
    width:100%;
    height:100%;
    min-height:0;
    display:flex;
    align-items:stretch;
    justify-content:flex-start;
    overflow:hidden;
    padding:0;
    align-self:center;
    justify-self:center;
    position:relative;
  }

  .home-slider-controls{
    position:absolute;
    left:18px;
    right:18px;
    bottom:14px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    z-index:3;
    pointer-events:auto;
  }
  .home-slider-dots{
    display:flex;
    gap:10px;
    pointer-events:auto;
  }
  .home-dot{
    width:8px;
    height:8px;
    border-radius:999px;
    border:none;
    background:rgba(0,0,0,0.25);
    cursor:pointer;
    padding:0;
  }
  .home-dot.active{
    width:22px;
    background:rgba(0,0,0,0.6);
  }
  .home-slider-arrows{
    display:flex;
    gap:12px;
    pointer-events:auto;
  }
  .home-arrow{
    border:none;
    background:transparent;
    color:rgba(0,0,0,0.45);
    font-size:18px;
    line-height:1;
    cursor:pointer;
    padding:0;
  }
  .home-arrow:hover{ color:rgba(0,0,0,0.75); }

  .home-illustration-track{
    width:100%;
    height:100%;
    display:flex;
    align-items:stretch;
    gap:0;
    overflow-x:auto;
    overflow-y:hidden;
    scroll-snap-type:x mandatory;
    scroll-padding-left:0;
    padding:0;
    -webkit-overflow-scrolling:touch;
  }
  .home-illustration-track::-webkit-scrollbar{ display:none; }
  .home-illustration-track{ scrollbar-width:none; }

  .home-slide{
    flex:0 0 100%;
    height:100%;
    min-height:100%;
    background:transparent;
    border-radius:0;
    display:flex;
    align-items:stretch;
    justify-content:stretch;
    padding:0;
    box-shadow:none;
    overflow:hidden;
    scroll-snap-align:start;
  }
  .home-slide-media{
    width:100%;
    height:100%;
    min-height:100%;
    display:flex;
    align-items:stretch;
    justify-content:stretch;
    padding-left:0;
  }
  /* ✅ no hover on second image + fit screen */
  .home-illustration{
    width:100%;
    height:100%;
    object-fit:cover;
    object-position:center center;
    display:block;
    transition:none !important;
    transform:none !important;
    filter:none;
    margin:0;
    border-radius:0;
    background:transparent;
  }

  /* ===== ABOUT (matches screenshot card layout) ===== */
  #sect-about{ background:#fff; }
  #sect-about .section-scroll{
    background:#fff;
    padding:48px 48px 64px;
  }
  #sect-about .sec-title{ font-size:42px; margin-bottom:12px; letter-spacing:-0.01em; }
  .about-wrap{ max-width:1100px; margin:0 auto; }
  .about-lead{
    font-family:"Inter", system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
    font-size:20px;
    line-height:1.7;
    color:#3d3d3d;
    font-weight:600;
    margin:0 0 14px;
    max-width:980px;
  }
  .about-sublead{
    display:block;
    font-family:"Inter", system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
    font-size:15px;
    line-height:1.7;
    color:#6a6a6a;
    font-weight:400;
    margin:0 0 26px;
    max-width:1000px;
  }

  .about-grid{
    display:grid;
    grid-template-columns:repeat(3, minmax(0, 1fr));
    gap:26px;
    margin-top:18px;
  }

  .about-card{
    background:#fff;
    border:1px solid #f0f0f0;
    border-radius:26px;
    padding:20px;
    box-shadow:0 18px 36px rgba(0,0,0,0.08);
    display:flex;
    flex-direction:column;
    min-height:360px;
  }

  .about-card-media{
    width:100%;
    height:128px;
    border-radius:20px;
    overflow:hidden;
    background:#ededed;
    border:1px solid #f1f1f1;
    position:relative;
  }
  .about-card-media::before{
    content:"";
    position:absolute;
    top:12px;
    left:12px;
    width:84px;
    height:12px;
    border-radius:999px;
    background:rgba(0,0,0,0.08);
    z-index:2;
  }
  .about-card-media img{
    width:100%;
    height:100%;
    object-fit:cover;
    filter:none;
  }

  .about-card-meta{
    margin:16px 0 6px;
    font-size:10px;
    font-weight:800;
    letter-spacing:0.12em;
    text-transform:uppercase;
    color:#9b9b9b;
  }
  .about-card-title{
    margin:0 0 8px;
    font-size:18px;
    font-weight:800;
    letter-spacing:-0.01em;
    color:#111;
    line-height:1.3;
  }
  .about-card-desc{
    margin:0;
    font-size:13px;
    line-height:1.7;
    color:#6a6a6a;
  }

  /* ===== GALLERY ===== */
  #sect-gallery{ padding:0; }
  .shop-head{
    flex-shrink:0;
    position:sticky; top:0;
    background:rgba(255,255,255,0.96);
    backdrop-filter:blur(10px);
    z-index:12;
    padding:22px 30px;
    border-bottom:1px solid #f0f0f0;
  }
  .gallery-head{
    display:flex;
    flex-direction:column;
    gap:18px;
  }
  .gallery-top{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:14px;
  }
  .gallery-title{
    font-size:16px;
    font-weight:900;
    letter-spacing:0.12em;
    text-transform:uppercase;
    color:#111;
  }
  .gallery-link{
    border:1px solid #e2e2e2;
    background:#fff;
    color:#111;
    padding:8px 14px;
    border-radius:999px;
    font-size:10px;
    font-weight:900;
    letter-spacing:0.14em;
    text-transform:uppercase;
    cursor:pointer;
    transition:all .2s ease;
  }
  .gallery-link:hover{
    background:#111;
    color:#fff;
    border-color:#111;
  }
  .gallery-tabs{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:nowrap;
    overflow-x:auto;
    scrollbar-width:none;
    padding:6px;
    border-radius:999px;
    background:#111;
    box-shadow:0 12px 24px rgba(0,0,0,0.08);
  }
  .gallery-tabs::-webkit-scrollbar{ display:none; }
  .gallery-tabs .chip{
    text-transform:uppercase;
    letter-spacing:0.18em;
    font-size:11px;
    color:rgba(255,255,255,0.7);
    padding:8px 14px;
  }
  .gallery-tabs .chip:hover{ color:#fff; }
  .gallery-tabs .chip.active{
    background:#fff;
    color:#111;
    padding:8px 18px;
  }

  #filters{
    padding-top:6px;
  }
  #filters .chip{
    background:#f4f4f4;
    color:#666;
    border:1px solid #e8e8e8;
  }
  #filters .chip:hover{ color:#222; }
  #filters .chip.active{
    background:var(--accent);
    color:#fff;
    border-color:var(--accent);
    padding:8px 20px;
  }

  .nav-group{
    display:flex; gap:10px; align-items:center;
    flex-wrap:nowrap;
    overflow-x:auto;
    scrollbar-width:none;
  }
  .nav-group::-webkit-scrollbar{ display:none; }
  .chip{
    border:none;
    background:transparent;
    font-size:14px;
    color:#999;
    cursor:pointer;
    padding:8px 12px;
    transition:all .2s;
    font-weight:600;
    white-space:nowrap;
    border-radius:999px;
  }
  .chip:hover{ color:#333; }
  .chip.active{
    background:var(--accent);
    color:#fff;
    padding:8px 22px;
  }

  .shop-body{
    padding:22px 30px 70px;
    flex-grow:1;
    overflow-y:auto;
    min-height:0;
  }
  #sect-gallery.gallery-empty-state .grid{ display:none; }
  .gallery-empty{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:42px 26px;
    border:1px dashed #e6e6e6;
    border-radius:24px;
    background:#fbfbfb;
    color:#777;
    margin-bottom:22px;
  }
  .gallery-empty-title{
    font-size:13px;
    font-weight:900;
    letter-spacing:0.16em;
    text-transform:uppercase;
    color:#222;
    margin-bottom:8px;
  }
  .gallery-empty-desc{
    font-size:20.4px;
    color:#8a8a8a;
    margin:0;
  }

  .artists-head{
    display:flex;
    flex-direction:column;
    gap:16px;
    margin-bottom:26px;
  }
  .artists-hero{
    display:grid;
    grid-template-columns:minmax(0,1.1fr) minmax(0,0.9fr);
    gap:24px;
    padding:24px;
    border-radius:28px;
    border:1px solid #efefef;
    background:linear-gradient(135deg, #faf7f2 0%, #f4f4f4 45%, #ffffff 100%);
    box-shadow:0 18px 40px rgba(0,0,0,0.06);
  }
  .artists-kicker{
    font-size:10px;
    font-weight:900;
    letter-spacing:0.16em;
    text-transform:uppercase;
    color:#8a8a8a;
  }
  .artists-title{
    font-size:32px;
    font-weight:900;
    letter-spacing:-0.02em;
    margin:6px 0 8px;
    color:#111;
  }
  .artists-sub{
    font-size:14px;
    color:#555;
    line-height:1.7;
    margin:0 0 14px;
    max-width:520px;
  }
  .artists-meta{
    display:flex;
    flex-wrap:wrap;
    gap:12px;
  }
  .artists-meta-item{
    background:#fff;
    border:1px solid #efefef;
    border-radius:16px;
    padding:10px 14px;
    min-width:120px;
    box-shadow:0 10px 22px rgba(0,0,0,0.04);
  }
  .artists-meta-item strong{
    display:block;
    font-size:18px;
    font-weight:900;
    color:#111;
  }
  .artists-meta-item span{
    font-size:9px;
    letter-spacing:0.14em;
    text-transform:uppercase;
    color:#777;
  }
  .artists-hero-panel{
    background:#fff;
    border:1px solid #efefef;
    border-radius:22px;
    padding:18px;
    display:flex;
    flex-direction:column;
    gap:12px;
    justify-content:space-between;
  }
  .artists-hero-note{
    font-size:12px;
    color:#666;
    line-height:1.7;
    margin:0;
  }
  .artists-hero-tags{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
  }
  .artists-hero-tags span{
    font-size:9px;
    text-transform:uppercase;
    letter-spacing:0.12em;
    background:#111;
    color:#fff;
    padding:6px 10px;
    border-radius:999px;
  }
  .artists-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill, minmax(260px,1fr));
    gap:22px;
  }
  .artist-card{
    background:#fff;
    border:1px solid #efefef;
    border-radius:26px;
    padding:18px;
    display:flex;
    flex-direction:column;
    gap:12px;
    cursor:pointer;
    transition:transform .22s ease, box-shadow .22s ease;
  }
  .artist-card:hover{ transform:translateY(-6px); box-shadow:0 18px 40px rgba(0,0,0,0.08); }
  .artist-card-media{
    width:100%;
    aspect-ratio:4 / 3;
    border-radius:20px;
    overflow:hidden;
    background:#f2f2f2;
  }
  .artist-card-media img{
    width:100%;
    height:100%;
    object-fit:cover;
  }
  .artist-card-name{
    font-size:16px;
    font-weight:900;
    letter-spacing:-0.01em;
    color:#111;
  }
  .artist-card-role{
    font-size:10px;
    letter-spacing:0.12em;
    text-transform:uppercase;
    color:#777;
  }
  .artist-card-bio{
    font-size:12px;
    color:#666;
    line-height:1.6;
    display:-webkit-box;
    -webkit-line-clamp:2;
    -webkit-box-orient:vertical;
    overflow:hidden;
  }
  .artist-card-products{
    display:grid;
    grid-template-columns:repeat(3, minmax(0,1fr));
    gap:8px;
  }
  .artist-card-product{
    height:60px;
    border-radius:12px;
    overflow:hidden;
    background:#f4f4f4;
    border:1px solid #eee;
  }
  .artist-card-product img{
    width:100%;
    height:100%;
    object-fit:cover;
  }
  .artist-card-footer{
    display:flex;
    align-items:center;
    justify-content:space-between;
  }
  .artist-card-cta{
    font-size:10px;
    letter-spacing:0.14em;
    text-transform:uppercase;
    font-weight:900;
    color:#111;
  }
  .artist-detail-head{ margin-bottom:12px; }
  .artist-hero{
    display:grid;
    grid-template-columns:minmax(220px, 280px) 1fr;
    gap:24px;
    align-items:start;
    margin-bottom:20px;
  }
  .artist-hero-media{
    width:100%;
    aspect-ratio:1 / 1;
    border-radius:24px;
    overflow:hidden;
    background:#f2f2f2;
  }
  .artist-hero-media img{
    width:100%;
    height:100%;
    object-fit:cover;
  }
  .artist-hero-name{
    font-size:28px;
    font-weight:900;
    letter-spacing:-0.02em;
    color:#111;
  }
  .artist-hero-role{
    font-size:11px;
    letter-spacing:0.14em;
    text-transform:uppercase;
    color:#777;
    margin-top:6px;
  }
  .artist-hero-bio{
    font-size:14px;
    color:#555;
    line-height:1.7;
    margin-top:12px;
  }
  .artist-meta-grid{
    display:grid;
    grid-template-columns:repeat(3, minmax(0,1fr));
    gap:12px;
    margin-bottom:22px;
  }
  .artist-meta-card{
    background:#fff;
    border:1px solid #efefef;
    border-radius:16px;
    padding:12px 14px;
  }
  .artist-meta-card span{
    display:block;
    font-size:9px;
    letter-spacing:0.14em;
    text-transform:uppercase;
    color:#777;
    margin-bottom:4px;
  }
  .artist-meta-card strong{
    font-size:14px;
    font-weight:900;
    color:#111;
  }
  .artist-products-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit, minmax(220px, 1fr));
    gap:18px;
  }
  .artist-product-card{
    background:#fff;
    border:1px solid #efefef;
    border-radius:22px;
    padding:16px;
    transition:transform .22s ease, box-shadow .22s ease;
    cursor:pointer;
  }
  .artist-product-card:hover{ transform:translateY(-4px); box-shadow:0 16px 34px rgba(0,0,0,0.08); }
  .artist-product-card .card-media{ height:150px; margin-bottom:12px; }
  .artist-product-card .card-name{ color:#111; font-size:12px; }
  .artist-product-card .card-sub{ color:#888; }
  .artist-works-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin:18px 0 16px;
  }
  .artist-works-title{
    font-size:11px;
    letter-spacing:0.16em;
    text-transform:uppercase;
    font-weight:900;
    color:#111;
  }
  .artist-works-count{
    font-size:11px;
    color:#777;
    letter-spacing:0.08em;
    text-transform:uppercase;
  }
  .artist-works-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill, minmax(220px, 1fr));
    gap:22px;
  }

  .book-filter-bar{
    display:flex;
    align-items:center;
    gap:14px;
  }
  .book-filter-btn{
    display:inline-flex;
    align-items:center;
    gap:10px;
    border:1px solid #dcdcdc;
    background:#fff;
    padding:10px 16px;
    border-radius:4px;
    font-size:12px;
    font-weight:800;
    letter-spacing:0.12em;
    text-transform:uppercase;
    cursor:pointer;
  }
  .book-filter-btn svg{ width:18px; height:18px; }
  .book-filter-summary{
    font-size:11px;
    color:#777;
    letter-spacing:0.08em;
    text-transform:uppercase;
  }

  .art-filter-bar{
    display:flex;
    align-items:center;
    gap:14px;
  }
  .art-filter-btn{
    display:inline-flex;
    align-items:center;
    gap:10px;
    border:1px solid #dcdcdc;
    background:#fff;
    padding:10px 16px;
    border-radius:4px;
    font-size:12px;
    font-weight:800;
    letter-spacing:0.12em;
    text-transform:uppercase;
    cursor:pointer;
  }
  .art-filter-btn svg{ width:18px; height:18px; }
  .art-filter-summary{
    font-size:11px;
    color:#777;
    letter-spacing:0.08em;
    text-transform:uppercase;
  }

  .art-filter-modal{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.32);
    display:none;
    align-items:flex-start;
    justify-content:center;
    padding:46px 18px;
    z-index:999;
  }
  .art-filter-modal.open{ display:flex; }
  .art-filter-card{
    width:min(520px, 94vw);
    background:#fff;
    border-radius:22px;
    padding:28px;
    box-shadow:0 24px 60px rgba(0,0,0,0.16);
  }
  .art-filter-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:18px;
  }
  .art-filter-title{
    font-size:22px;
    font-weight:900;
    letter-spacing:0.06em;
    text-transform:uppercase;
  }
  .art-filter-close{
    background:none;
    border:none;
    font-size:24px;
    cursor:pointer;
    color:#111;
  }
  .art-filter-row{
    display:flex;
    align-items:center;
    gap:16px;
    padding:12px 0 20px;
    border-bottom:1px solid #e9e9e9;
  }
  .art-filter-row label{
    font-size:12px;
    font-weight:800;
    letter-spacing:0.1em;
    text-transform:uppercase;
    color:#555;
  }
  .art-filter-row select{
    flex:1;
    padding:10px 12px;
    border:1px solid #e5e5e5;
    background:#f7f7f7;
    font-size:14px;
  }
  .art-filter-group{
    border-bottom:1px solid #e9e9e9;
  }
  .art-filter-toggle{
    width:100%;
    display:flex;
    align-items:center;
    justify-content:space-between;
    background:none;
    border:none;
    padding:16px 0;
    font-size:13px;
    font-weight:800;
    letter-spacing:0.08em;
    text-transform:uppercase;
    cursor:pointer;
  }
  .art-filter-toggle span{
    transition:transform .2s ease;
  }
  .art-filter-toggle.open span{
    transform:rotate(180deg);
  }
  .art-filter-options{
    display:none;
    padding-bottom:16px;
    gap:10px;
    flex-wrap:wrap;
  }
  .art-filter-options.open{
    display:flex;
  }
  .art-filter-options label{
    font-size:12px;
    color:#444;
    display:flex;
    align-items:center;
    gap:8px;
  }
  .art-filter-actions{
    display:flex;
    align-items:center;
    gap:12px;
    padding-top:22px;
  }
  .art-filter-clear{
    background:none;
    border:none;
    font-size:12px;
    font-weight:800;
    letter-spacing:0.12em;
    text-transform:uppercase;
    color:#111;
    cursor:pointer;
  }
  .art-filter-apply{
    flex:1;
    background:#111;
    color:#fff;
    border:none;
    padding:14px 16px;
    font-size:12px;
    font-weight:900;
    letter-spacing:0.14em;
    text-transform:uppercase;
    cursor:pointer;
  }

  .sculpture-filter-bar{
    display:flex;
    align-items:center;
    gap:14px;
  }
  .sculpture-filter-btn{
    display:inline-flex;
    align-items:center;
    gap:10px;
    border:1px solid #dcdcdc;
    background:#fff;
    padding:10px 16px;
    border-radius:4px;
    font-size:12px;
    font-weight:800;
    letter-spacing:0.12em;
    text-transform:uppercase;
    cursor:pointer;
  }
  .sculpture-filter-btn svg{ width:18px; height:18px; }
  .sculpture-filter-summary{
    font-size:11px;
    color:#777;
    letter-spacing:0.08em;
    text-transform:uppercase;
  }

  .sculpture-filter-modal{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.32);
    display:none;
    align-items:flex-start;
    justify-content:center;
    padding:46px 18px;
    z-index:999;
  }
  .sculpture-filter-modal.open{ display:flex; }
  .sculpture-filter-card{
    width:min(520px, 94vw);
    background:#fff;
    border-radius:22px;
    padding:28px;
    box-shadow:0 24px 60px rgba(0,0,0,0.16);
  }
  .sculpture-filter-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:18px;
  }
  .sculpture-filter-title{
    font-size:22px;
    font-weight:900;
    letter-spacing:0.06em;
    text-transform:uppercase;
  }
  .sculpture-filter-close{
    background:none;
    border:none;
    font-size:24px;
    cursor:pointer;
    color:#111;
  }
  .sculpture-filter-row{
    display:flex;
    align-items:center;
    gap:16px;
    padding:12px 0 20px;
    border-bottom:1px solid #e9e9e9;
  }
  .sculpture-filter-row label{
    font-size:12px;
    font-weight:800;
    letter-spacing:0.1em;
    text-transform:uppercase;
    color:#555;
  }
  .sculpture-filter-row select{
    flex:1;
    padding:10px 12px;
    border:1px solid #e5e5e5;
    background:#f7f7f7;
    font-size:14px;
  }
  .sculpture-filter-group{
    border-bottom:1px solid #e9e9e9;
  }
  .sculpture-filter-toggle{
    width:100%;
    display:flex;
    align-items:center;
    justify-content:space-between;
    background:none;
    border:none;
    padding:16px 0;
    font-size:13px;
    font-weight:800;
    letter-spacing:0.08em;
    text-transform:uppercase;
    cursor:pointer;
  }
  .sculpture-filter-toggle span{
    transition:transform .2s ease;
  }
  .sculpture-filter-toggle.open span{
    transform:rotate(180deg);
  }
  .sculpture-filter-options{
    display:none;
    padding-bottom:16px;
    gap:10px;
    flex-wrap:wrap;
  }
  .sculpture-filter-options.open{
    display:flex;
  }
  .sculpture-filter-options label{
    font-size:12px;
    color:#444;
    display:flex;
    align-items:center;
    gap:8px;
  }
  .sculpture-filter-actions{
    display:flex;
    align-items:center;
    gap:12px;
    padding-top:22px;
  }
  .sculpture-filter-clear{
    background:none;
    border:none;
    font-size:12px;
    font-weight:800;
    letter-spacing:0.12em;
    text-transform:uppercase;
    color:#111;
    cursor:pointer;
  }
  .sculpture-filter-apply{
    flex:1;
    background:#111;
    color:#fff;
    border:none;
    padding:14px 16px;
    font-size:12px;
    font-weight:900;
    letter-spacing:0.14em;
    text-transform:uppercase;
    cursor:pointer;
  }

  .book-filter-modal{
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.32);
    display:none;
    align-items:flex-start;
    justify-content:center;
    padding:46px 18px;
    z-index:999;
  }
  .book-filter-modal.open{ display:flex; }
  .book-filter-card{
    width:min(520px, 94vw);
    background:#fff;
    border-radius:22px;
    padding:28px;
    box-shadow:0 24px 60px rgba(0,0,0,0.16);
  }
  .book-filter-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:18px;
  }
  .book-filter-title{
    font-size:22px;
    font-weight:900;
    letter-spacing:0.06em;
    text-transform:uppercase;
  }
  .book-filter-close{
    background:none;
    border:none;
    font-size:24px;
    cursor:pointer;
    color:#111;
  }
  .book-filter-row{
    display:flex;
    align-items:center;
    gap:16px;
    padding:12px 0 20px;
    border-bottom:1px solid #e9e9e9;
  }
  .book-filter-row label{
    font-size:12px;
    font-weight:800;
    letter-spacing:0.1em;
    text-transform:uppercase;
    color:#555;
  }
  .book-filter-row select{
    flex:1;
    padding:10px 12px;
    border:1px solid #e5e5e5;
    background:#f7f7f7;
    font-size:14px;
  }
  .book-filter-group{
    border-bottom:1px solid #e9e9e9;
  }
  .book-filter-toggle{
    width:100%;
    display:flex;
    align-items:center;
    justify-content:space-between;
    background:none;
    border:none;
    padding:16px 0;
    font-size:13px;
    font-weight:800;
    letter-spacing:0.08em;
    text-transform:uppercase;
    cursor:pointer;
  }
  .book-filter-toggle span{
    transition:transform .2s ease;
  }
  .book-filter-toggle.open span{
    transform:rotate(180deg);
  }
  .book-filter-options{
    display:none;
    padding-bottom:16px;
    gap:10px;
    flex-wrap:wrap;
  }
  .book-filter-options.open{
    display:flex;
  }
  .book-filter-options label{
    font-size:12px;
    color:#444;
    display:flex;
    align-items:center;
    gap:8px;
  }
  .book-filter-actions{
    display:flex;
    align-items:center;
    gap:12px;
    padding-top:22px;
  }
  .book-filter-clear{
    background:none;
    border:none;
    font-size:12px;
    font-weight:800;
    letter-spacing:0.12em;
    text-transform:uppercase;
    color:#111;
    cursor:pointer;
  }
  .book-filter-apply{
    flex:1;
    background:#c23a20;
    color:#fff;
    border:none;
    padding:14px 16px;
    font-size:12px;
    font-weight:900;
    letter-spacing:0.14em;
    text-transform:uppercase;
    cursor:pointer;
  }

  .grid{
    display:grid;
    grid-template-columns:repeat(auto-fill, minmax(220px, 1fr));
    gap:26px;
    width:100%;
  }
  .card{
    background:#fff;
    border:1px solid #f3f3f3;
    border-radius:28px;
    padding:26px 18px;
    cursor:pointer;
    transition:transform .25s ease, box-shadow .25s ease;
    display:flex;
    flex-direction:column;
    align-items:center;
    text-align:center;
  }
  .card:hover{ transform:translateY(-6px); box-shadow:0 18px 42px rgba(0,0,0,0.07); }
  .card-media{
    width:100%;
    height:180px;
    display:flex;
    align-items:flex-end;
    justify-content:center;
    margin-bottom:16px;
  }
  .card-media img{ max-width:100%; max-height:100%; object-fit:contain; filter:none; }
  .card-name{ font-size:12px; font-weight:900; letter-spacing:0.10em; color:#b0b0b0; text-transform:uppercase; margin-bottom:6px; }
  .card-sub{ font-size:10px; color:#d0d0d0; text-transform:uppercase; letter-spacing:0.06em; }

  .card.book-card{
    padding:0;
    align-items:stretch;
    text-align:left;
  }
  .card.book-card .card-media{
    height:280px;
    margin-bottom:0;
  }
  .card.book-card .card-media img{
    width:100%;
    height:100%;
    max-height:none;
    object-fit:cover;
    border-radius:24px 24px 0 0;
  }
  .card.book-card .card-name{
    padding:14px 18px 4px;
    margin:0;
    color:#222;
    letter-spacing:0.12em;
  }
  .card.book-card .card-sub{
    padding:0 18px 18px;
    color:#888;
  }
  .card.art-card .card-media{
    height:220px;
    background:#fafafa;
  }
  .card.art-card .card-media img{
    object-fit:contain;
  }
  .card.sculpture-card .card-media{
    height:220px;
    background:#fafafa;
  }
  .card.sculpture-card .card-media img{
    object-fit:contain;
  }

  .solo-wrap{ display:none; }
  #sect-gallery.solo .grid{ display:none; }
  #sect-gallery.solo .shop-body{ background:#fff; }
  #sect-gallery.solo .solo-wrap{
    display:block;
    padding:0;
  }
  #sect-gallery.solo .solo-frame{
    position:relative;
    overflow:hidden;
    background:#f3f3f3;
    border-radius:28px;
    padding:0;
    border:1px solid #ececec;
    box-shadow:0 18px 40px rgba(0,0,0,0.06);
    display:flex;
    flex-direction:column;
  }
  .back-nav{
    margin:4px 0 12px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
  }
  .btn-back{
    background:none; border:none; padding:0;
    color:#9a9a9a; font-size:13px; font-weight:700;
    cursor:pointer; display:inline-flex; align-items:center; gap:8px;
  }

  .solo-tabs-bar{
    width:100%;
    display:flex;
    justify-content:center;
    margin:0;
    padding:12px 22px 18px;
    pointer-events:auto;
  }
  .solo-tabs-bar.top{
    width:auto;
    padding:0;
    margin-left:auto;
    justify-content:flex-end;
  }

  .solo-media-container{
    width:100%;
    aspect-ratio:16 / 9;
    background:transparent;
    border-radius:0;
    overflow:hidden;
    position:relative;
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow:none;
    border:none;
  }
  .solo-media-container img,
  .solo-media-container video{
    width:100%;
    height:100%;
    object-fit:cover;
    object-position:center;
  }
  .solo-media-container img{ filter:none; }
  #soloWrap[data-solo-mode="art"] .solo-media-container img,
  #soloWrap[data-solo-mode="book"] .solo-media-container img{
    object-fit:contain;
  }
  model-viewer{ width:100%; height:100%; }

  .media-tabs{
    display:flex;
    gap:8px;
    padding:8px;
    border-radius:999px;
    background:#bdbdbd;
    backdrop-filter:none; -webkit-backdrop-filter:none;
  }
  .media-tab{
    border:none;
    cursor:pointer;
    padding:10px 18px;
    border-radius:999px;
    font-weight:900;
    letter-spacing:0.06em;
    text-transform:uppercase;
    font-size:11px;
    color:rgba(255,255,255,0.85);
    background:rgba(255,255,255,0.18);
    transition:all .2s ease;
    white-space:nowrap;
  }
  .media-tab.active{
    background:#fff;
    color:#111;
  }

  .solo-bottom-tabs{ pointer-events:auto; }
  .solo-bottom-tabs-inner{
    display:flex;
    gap:8px;
    padding:8px;
    border-radius:999px;
    background:#bdbdbd;
  }
  .solo-bottom-tab{
    border:none;
    cursor:pointer;
    padding:10px 18px;
    border-radius:999px;
    font-weight:900;
    letter-spacing:0.06em;
    text-transform:uppercase;
    font-size:11px;
    color:rgba(255,255,255,0.90);
    background:rgba(255,255,255,0.18);
    transition:all .2s ease;
    white-space:nowrap;
  }
  .solo-bottom-tab.active{
    background:#fff;
    color:#111;
  }

  .solo-frame-foot{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
    padding:16px 22px;
    background:#fff;
    border-top:1px solid #e9e9e9;
  }
  .solo-foot-left{ min-width:0; }
  .solo-foot-title{
    font-size:11px;
    font-weight:950;
    letter-spacing:0.14em;
    text-transform:uppercase;
    color:#111;
    margin-bottom:6px;
  }
  .solo-foot-desc{
    font-size:12px;
    line-height:1.6;
    color:#9a9a9a;
    max-width:360px;
  }
  .solo-foot-right{
    display:flex;
    flex-direction:column;
    align-items:flex-end;
    gap:10px;
  }
  .solo-tab-wrap{
    position:relative;
    display:flex;
  }
  .solo-tab-wrap .solo-bottom-tab{ width:100%; }
  .solo-popover{
    position:absolute;
    left:50%;
    bottom:calc(100% + 10px);
    transform:translateX(-50%);
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:10px;
    padding:10px;
    border-radius:22px;
    background:rgba(0,0,0,0.06);
    box-shadow:0 18px 42px rgba(0,0,0,0.14);
    z-index:18;
    pointer-events:auto;
    max-width:min(420px, calc(100vw - 44px));
  }
  .solo-suboption{
    border:none;
    cursor:pointer;
    padding:14px 18px;
    border-radius:999px;
    font-weight:950;
    letter-spacing:0.08em;
    text-transform:uppercase;
    font-size:12px;
    color:#111;
    background:rgba(255,255,255,0.92);
    transition:all .18s ease;
  }
  .solo-suboption.active{
    background:#111;
    color:#fff;
  }

  .solo-config{
    position:absolute;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%) translateY(12px);
    width:663px;
    max-width:calc(100% - 44px);
    padding:16px 16px 14px;
    border-radius:20px;
    background:rgba(255,255,255,0.78);
    border:1px solid rgba(255,255,255,0.72);
    box-shadow:0 22px 46px rgba(0,0,0,0.14);
    backdrop-filter:blur(16px);
    -webkit-backdrop-filter:blur(16px);
    opacity:0;
    pointer-events:none;
    transition:opacity .18s ease, transform .22s ease;
    z-index:19;
  }
  #sect-gallery.solo .solo-frame.customize-open .solo-config{
    opacity:1;
    pointer-events:auto;
    transform:translate(-50%,-50%) translateY(0);
  }
  .solo-config-close{
    position:absolute;
    top:10px;
    right:10px;
    width:32px;
    height:32px;
    border:none;
    border-radius:12px;
    background:rgba(0,0,0,0.06);
    color:#111;
    cursor:pointer;
    font-weight:950;
    font-size:18px;
    line-height:1;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .solo-config-title{
    margin:2px 34px 12px 0;
    font-size:13px;
    font-weight:950;
    letter-spacing:0.10em;
    text-transform:uppercase;
    color:#111;
  }
  .solo-config-group{ margin-bottom:12px; }
  .solo-config-label{
    font-size:10px;
    font-weight:950;
    letter-spacing:0.10em;
    text-transform:uppercase;
    color:rgba(0,0,0,0.45);
    margin-bottom:8px;
  }
  .solo-config-options{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
  }
  .solo-config-option{
    border:none;
    cursor:pointer;
    padding:10px 12px;
    border-radius:999px;
    font-weight:900;
    font-size:12px;
    color:#111;
    background:rgba(255,255,255,0.82);
    border:1px solid rgba(0,0,0,0.08);
    transition:all .18s ease;
  }
  .solo-config-option.active{
    background:#111;
    border-color:#111;
    color:#fff;
  }
  .solo-config-summary{
    font-size:12px;
    color:rgba(0,0,0,0.70);
    margin-top:6px;
  }
  .solo-inquiry-fields{
    margin-top:12px;
    display:grid;
    gap:8px;
  }
  .solo-inquiry-label{
    font-size:10px;
    font-weight:950;
    letter-spacing:0.10em;
    text-transform:uppercase;
    color:rgba(0,0,0,0.45);
  }
  .solo-inquiry-grid{
    display:grid;
    grid-template-columns:repeat(2, minmax(0, 1fr));
    gap:8px;
  }
  .solo-inquiry-input{
    width:100%;
    padding:10px 12px;
    border:1px solid rgba(0,0,0,0.08);
    border-radius:12px;
    background:#fff;
    font-size:12px;
    font-weight:600;
    color:#111;
  }
  .solo-inquiry-input:focus{
    outline:none;
    border-color:#111;
  }
  .solo-config-body{
    max-height:62vh;
    overflow:auto;
    padding-right:4px;
  }
  .solo-config-section[hidden]{ display:none; }
  .solo-inquiry-btn{
    width:100%;
    margin-top:12px;
  }
  .book-customs-title{
    font-size:11px;
    font-weight:900;
    letter-spacing:0.08em;
    text-transform:uppercase;
    margin-bottom:10px;
  }
  .book-offer-select{
    cursor:pointer;
    border:1px solid #eee;
  }
  .book-offer-select.active{
    border-color:#111;
    box-shadow:inset 0 0 0 1px #111;
  }

  .solo-info-card{
    position:absolute;
    left:22px;
    top:50%;
    transform:translateY(-50%) translateX(-12px);
    width:710px;
    max-width:calc(100% - 44px);
    padding:16px 16px 14px;
    max-height:70vh;
    overflow:auto;
    border-radius:18px;
    background:rgba(255,255,255,0.70);
    border:1px solid rgba(255,255,255,0.72);
    box-shadow:0 22px 46px rgba(0,0,0,0.12);
    backdrop-filter:blur(16px);
    -webkit-backdrop-filter:blur(16px);
    opacity:0;
    pointer-events:none;
    transition:opacity .18s ease, transform .22s ease;
    z-index:20;
  }
  #sect-gallery.solo .solo-frame.info-open .solo-info-card{
    opacity:1;
    pointer-events:auto;
    transform:translateY(-50%) translateX(0);
  }
  .solo-info-close{
    position:absolute;
    top:10px;
    right:10px;
    width:32px;
    height:32px;
    border:none;
    border-radius:12px;
    background:rgba(0,0,0,0.06);
    color:#111;
    cursor:pointer;
    font-weight:950;
    font-size:18px;
    line-height:1;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .solo-info-title{
    margin:2px 34px 10px 0;
    font-size:14px;
    font-weight:950;
    letter-spacing:0.06em;
    text-transform:uppercase;
    color:#111;
  }
  .solo-info-text{
    font-size:12px;
    line-height:1.7;
    color:rgba(0,0,0,0.70);
    margin-bottom:12px;
  }
  .solo-info-meta{
    display:grid;
    gap:10px;
  }
  .solo-meta-item span{
    display:block;
    font-size:10px;
    font-weight:900;
    letter-spacing:0.08em;
    text-transform:uppercase;
    color:rgba(0,0,0,0.45);
    margin-bottom:4px;
  }
  .solo-meta-item strong{
    display:block;
    font-size:13px;
    font-weight:950;
    color:#111;
  }
  #soloInfoExtra{
    margin-top:14px;
  }

  .img-arrow{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    width:44px;
    height:44px;
    border:none; border-radius:999px;
    background:#cfcfcf;
    color:#666;
    cursor:pointer;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:18px;
    backdrop-filter:none;
    z-index:9;
  }
  .img-arrow.left{ left:16px; }
  .img-arrow.right{ right:16px; }

  .v360-ui{
    position:absolute;
    left:50%; transform:translateX(-50%);
    bottom:12px;
    width:min(370px, 78%);
    background:rgba(0,0,0,0.35);
    backdrop-filter:blur(12px);
    border-radius:999px;
    padding:5px 7px;
    display:flex; gap:6px; align-items:center;
  }
  .v360-btn{
    width:22px; height:18px;
    border:none; border-radius:8px;
    background:rgba(255,255,255,0.18);
    color:#fff;
    cursor:pointer;
    font-weight:900;
    font-size:11px;
  }
  .v360-range{
    flex:1;
    -webkit-appearance:none;
    appearance:none;
    height:5px;
    border-radius:999px;
    background:rgba(255,255,255,0.22);
    outline:none;
  }
  .v360-range::-webkit-slider-thumb{
    -webkit-appearance:none;
    appearance:none;
    width:27px; height:11px;
    border-radius:999px;
    background:#fff;
    cursor:pointer;
    box-shadow:0 5px 9px rgba(0,0,0,0.18);
  }

  .solo-info-block{
    padding:18px 0 0;
    border-top:1px solid #e9e9e9;
  }
  .solo-desc{
    text-align:left;
    color:#666;
    font-size:13px;
    line-height:1.7;
    border-top:none;
    padding-top:0;
    margin-bottom:18px;
  }
  .solo-desc strong{
    display:block;
    font-size:20px;
    letter-spacing:0.14em;
    text-transform:uppercase;
    color:#666;
    margin:0 0 6px;
  }
  .data-row{ display:flex; flex-wrap:wrap; gap:38px; margin-top:14px; }
  .data-item span:first-child{
    display:block; font-size:10px; color:#999; text-transform:uppercase;
    font-weight:900; margin-bottom:4px; letter-spacing:0.08em;
  }
  .data-item span:last-child{ font-size:14px; font-weight:900; color:#222; }

  .book-wrap{ display:none; }
  #sect-gallery.book-solo .grid{ display:none; }
  #sect-gallery.book-solo .solo-wrap{ display:none; }
  #sect-gallery.book-solo .book-wrap{ display:block; }
  #sect-gallery.book-solo .shop-body{ background:#fff; }

  .art-wrap{ display:none; }
  #sect-gallery.art-solo .grid{ display:none; }
  #sect-gallery.art-solo .solo-wrap{ display:none; }
  #sect-gallery.art-solo .book-wrap{ display:none; }
  #sect-gallery.art-solo .art-wrap{ display:block; }
  #sect-gallery.art-solo .shop-body{ background:#fff; }

  .sculpture-wrap{ display:none; }
  #sect-gallery.sculpture-solo .grid{ display:none; }
  #sect-gallery.sculpture-solo .solo-wrap{ display:none; }
  #sect-gallery.sculpture-solo .book-wrap{ display:none; }
  #sect-gallery.sculpture-solo .art-wrap{ display:none; }
  #sect-gallery.sculpture-solo .sculpture-wrap{ display:block; }
  #sect-gallery.sculpture-solo .shop-body{ background:#fff; }

  .art-frame{
    background:#fff;
    border:1px solid #efefef;
    border-radius:22px;
    padding:22px;
    box-shadow:0 18px 40px rgba(0,0,0,0.04);
  }
  .art-layout{
    display:grid;
    grid-template-columns:60% 40%;
    grid-template-areas:"config summary";
    gap:28px;
    align-items:start;
  }
  .art-config{
    grid-area:config;
    border-right:1px solid #ededed;
    padding-right:24px;
  }
  .art-header{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:12px;
  }
  .art-title{
    font-size:22px;
    font-weight:900;
    letter-spacing:-0.01em;
    margin:0 0 6px;
    color:#111;
  }
  .art-artist{
    font-size:12px;
    color:#555;
    margin-bottom:10px;
  }
  .art-fav{
    background:none;
    border:none;
    font-size:20px;
    cursor:pointer;
    color:#111;
  }
  .art-rating{
    display:flex;
    align-items:center;
    gap:10px;
    font-size:12px;
    color:#444;
    margin-bottom:16px;
  }
  .art-rating .stars{ color:#0b6b5e; letter-spacing:2px; }

  .art-section{
    margin-bottom:16px;
  }
  .art-section-title{
    font-size:12px;
    font-weight:900;
    letter-spacing:0.08em;
    text-transform:uppercase;
    margin-bottom:10px;
    color:#111;
  }
  .art-options{
    display:flex;
    flex-wrap:wrap;
    gap:10px;
  }
  .art-option{
    border:1px solid #dcdcdc;
    background:#fff;
    padding:8px 10px;
    font-size:12px;
    font-weight:800;
    letter-spacing:0.06em;
    text-transform:uppercase;
    cursor:pointer;
    min-width:90px;
    text-align:center;
  }
  .art-option.active{
    background:#111;
    color:#fff;
    border-color:#111;
  }
  .art-service-grid{
    display:grid;
    grid-template-columns:repeat(3, minmax(0,1fr));
    gap:10px;
  }
  .art-service-card{
    border:1px solid #dcdcdc;
    padding:10px;
    text-align:center;
    font-size:11px;
    font-weight:800;
    text-transform:uppercase;
    cursor:pointer;
    background:#fff;
  }
  .art-service-card.active{
    border-color:#111;
    box-shadow:inset 0 0 0 1px #111;
  }
  .art-service-illu{
    height:52px;
    background:#f1f1f1;
    border:1px solid #e1e1e1;
    margin-bottom:8px;
  }
  .art-frame-grid{
    display:grid;
    grid-template-columns:repeat(4, minmax(0,1fr));
    gap:10px;
  }
  .art-frame-card{
    border:1px solid #dcdcdc;
    padding:8px 6px;
    text-align:center;
    font-size:11px;
    text-transform:uppercase;
    cursor:pointer;
    background:#fff;
  }
  .art-frame-card.active{
    background:#111;
    color:#fff;
    border-color:#111;
  }
  .art-frame-card.disabled{
    opacity:0.45;
    pointer-events:none;
  }
  .art-frame-rail{
    display:grid;
    grid-template-columns:repeat(4, minmax(0,1fr));
    gap:10px;
    margin-top:10px;
  }
  .art-frame-swatch{
    height:50px;
    border:1px solid #dcdcdc;
    background:#f7f7f7;
  }

  .art-buy-row{
    display:flex;
    align-items:center;
    justify-content:space-between;
    border-top:1px solid #ededed;
    padding-top:12px;
    font-size:12px;
  }
  .art-buy-left{
    display:flex;
    align-items:center;
    gap:12px;
  }
  .art-thumb{
    width:56px;
    height:56px;
    border:1px solid #e1e1e1;
    background:#f7f7f7;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
  }
  .art-thumb img{
    width:100%;
    height:100%;
    object-fit:contain;
  }
  .art-buy-row strong{ font-weight:900; }

  .art-summary{
    grid-area:summary;
    padding-left:24px;
  }
  .art-price{
    font-size:26px;
    font-weight:900;
    margin-bottom:6px;
  }
  .art-arrival{
    font-size:12px;
    color:#444;
    margin-bottom:12px;
  }
  .art-cta{
    width:100%;
    background:#0b0b0b;
    color:#fff;
    border:none;
    padding:12px 14px;
    font-weight:900;
    letter-spacing:0.08em;
    text-transform:uppercase;
    cursor:pointer;
    margin-bottom:10px;
  }
  .art-pay-note{
    font-size:12px;
    color:#666;
    margin-bottom:18px;
  }
  .art-right-media{
    margin:12px 0 14px;
    background:#f7f7f7;
    border:1px solid #e5e5e5;
    padding:10px;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .art-config .art-right-media{ margin-top:0; }
  .art-right-media img{
    width:100%;
    height:220px;
    object-fit:contain;
  }
  .art-config-stack{ margin-top:18px; }
  .art-box{
    border:1px solid #e6e6e6;
    padding:14px;
    font-size:12px;
    color:#444;
  }
  .art-box h4{
    margin:0 0 10px;
    font-size:13px;
    font-weight:900;
    text-transform:uppercase;
  }
  .art-box ul{
    margin:0;
    padding-left:16px;
    display:flex;
    flex-direction:column;
    gap:8px;
  }

  .book-frame{
    background:#fff;
    border:1px solid #efefef;
    border-radius:28px;
    padding:22px;
    box-shadow:0 18px 40px rgba(0,0,0,0.04);
  }
  .book-layout{
    display:grid;
    grid-template-columns:minmax(280px, 1fr) minmax(320px, 1fr);
    gap:40px;
    align-items:start;
  }
  .book-media{
    position:relative;
    background:#f7f7f7;
    border-radius:24px;
    border:1px solid #eee;
    overflow:hidden;
    min-height:420px;
    display:flex;
    align-items:center;
    justify-content:center;
    align-self:start;
    position:sticky;
    top:24px;
  }
  .book-media img{
    width:100%;
    height:100%;
    object-fit:cover;
  }
  .book-tag{
    position:absolute;
    top:16px;
    left:16px;
    background:#fff;
    color:#111;
    font-size:12px;
    font-weight:700;
    padding:8px 12px;
    border-radius:999px;
    box-shadow:0 8px 18px rgba(0,0,0,0.08);
  }
  .book-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:16px;
  }
  .book-save{
    background:none;
    border:none;
    font-size:18px;
    cursor:pointer;
    color:#111;
  }
  .book-kicker{
    font-style:italic;
    font-size:15px;
    color:#2a2a2a;
  }
  .book-title{
    margin:10px 0 6px;
    font-size:26px;
    font-weight:900;
    letter-spacing:0.02em;
    text-transform:uppercase;
    color:#111;
  }
  .book-price{
    font-size:16px;
    font-weight:700;
    color:#111;
    margin-bottom:18px;
  }
  .book-cta{
    width:100%;
    background:#0b0b0b;
    color:#fff;
    border:none;
    padding:14px 18px;
    font-weight:800;
    letter-spacing:0.12em;
    text-transform:uppercase;
    border-radius:0;
    cursor:pointer;
    margin-bottom:18px;
  }
  .book-offer{
    display:flex;
    align-items:center;
    gap:16px;
    padding:14px 16px;
    background:#f6f6f6;
    border:1px solid #efefef;
    margin-bottom:14px;
  }
  .book-offer-media{
    width:64px;
    height:64px;
    border-radius:8px;
    background:linear-gradient(160deg, #f0f0f0, #fafafa);
    position:relative;
    flex-shrink:0;
  }
  .book-offer-media::after{
    content:"";
    position:absolute;
    width:20px;
    height:20px;
    border-radius:999px;
    background:#b31212;
    top:50%;
    left:50%;
    transform:translate(-50%, -50%);
    box-shadow:0 6px 12px rgba(0,0,0,0.2);
  }
  .book-offer-title{
    font-size:12px;
    font-weight:800;
    letter-spacing:0.08em;
    text-transform:uppercase;
    color:#111;
    margin-bottom:4px;
  }
  .book-offer-desc{
    font-size:12px;
    color:#666;
  }
  .book-offer-desc span{ text-decoration:underline; }
  .book-offer-btn{
    margin-left:auto;
    width:40px;
    height:40px;
    border:none;
    background:#e9e9e9;
    font-size:18px;
    cursor:pointer;
  }
  .book-offer-alt{
    justify-content:space-between;
  }
  .book-offer-arrow{
    background:#c62828;
    color:#fff;
    font-size:18px;
    width:40px;
    height:40px;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .book-note{
    font-style:italic;
    font-size:13px;
    color:#444;
    margin:10px 0 18px;
  }
  .book-accordion{
    border-top:1px solid #e5e5e5;
    margin-top:10px;
  }
  .book-accordion-item{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:14px 0;
    border-bottom:1px solid #e5e5e5;
    font-size:13px;
    font-weight:700;
    letter-spacing:0.06em;
    text-transform:uppercase;
    color:#111;
    cursor:pointer;
  }
  .book-accordion-item span:last-child{
    font-size:18px;
    color:#111;
    transition:transform .2s ease;
  }
  .book-accordion-item.open span:last-child{
    transform:rotate(45deg);
  }
  .book-accordion-panel{
    max-height:0;
    overflow:hidden;
    font-size:12px;
    line-height:1.7;
    color:#666;
    transition:max-height .2s ease;
  }
  .book-accordion-panel.open{
    max-height:240px;
    padding:0 0 14px;
  }
  .book-accessory{
    margin-top:22px;
  }
  .book-accessory-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    margin-bottom:14px;
  }
  .book-accessory-title{
    font-size:14px;
    font-weight:800;
    letter-spacing:0.08em;
    text-transform:uppercase;
  }
  .book-accessory-link{
    font-style:italic;
    font-size:13px;
    color:#111;
  }
  .book-accessory-grid{
    display:grid;
    grid-template-columns:repeat(3, minmax(0,1fr));
    gap:14px;
  }
  .book-accessory-item{
    background:#f3f3f3;
    border-radius:18px;
    border:1px solid #ededed;
    padding:16px;
    height:150px;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .book-accessory-item img{
    max-width:100%;
    max-height:100%;
    object-fit:contain;
  }

  .artist-profile{
    display:flex; align-items:center; gap:14px;
    margin-top:18px;
    padding:16px;
    background:#fafafa;
    border-radius:20px;
    cursor:pointer;
    transition:all .2s ease;
    border:1px solid transparent;
  }
  .artist-profile:hover{
    background:#fff;
    border-color:#eee;
    box-shadow:0 10px 24px rgba(0,0,0,0.06);
    transform:translateY(-2px);
  }
  .avatar{ width:44px; height:44px; border-radius:50%; background:#eee; overflow:hidden; }
  .avatar img{ width:100%; height:100%; object-fit:cover; }
  .artist-info{ flex:1; }
  .artist-info h4{ margin:0; font-size:13px; color:#222; font-weight:900; }
  .artist-info p{ margin:2px 0 0; font-size:11px; color:#888; }
  .artist-cta{ font-size:11px; font-weight:900; color:#333; text-transform:uppercase; letter-spacing:0.06em; }

  .actions{ display:flex; gap:12px; margin-top:18px; }
  .btn{
    padding:14px 20px; border-radius:16px;
    border:none; font-size:13px; font-weight:800;
    cursor:pointer;
  }
  .btn-primary{ background:#111; color:#fff; flex:1; }
  .btn-ghost{ background:#f0f0f0; color:#666; }

  /* SERVICES (same as your file) */
  .services-wrap{ margin-top:10px; }
  .services-grid{
    display:grid;
    grid-template-columns:repeat(4, minmax(0, 1fr));
    gap:16px;
    margin-top:18px;
  }
  .svc-card{
    background:#fff;
    border:1px solid #f0f0f0;
    border-radius:22px;
    padding:18px 18px 16px;
    box-shadow:0 10px 24px rgba(0,0,0,0.06);
    transition:transform .22s ease, box-shadow .22s ease;
    min-height:160px;
  }
  .svc-card:hover{
    transform:translateY(-5px);
    box-shadow:0 18px 44px rgba(0,0,0,0.10);
  }
  .svc-ico{
    width:36px; height:36px; border-radius:14px;
    background:#f4f4f4;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:900;
    margin-bottom:12px;
  }
  .svc-title{ font-size:18px; font-weight:950; margin:0 0 8px; color:#3f3f3f; }
  .svc-desc{ margin:0; color:#666; line-height:1.6; font-size:13px; }

  .process{
    margin-top:26px;
    border-radius:28px;
    border:1px solid #efefef;
    background:#fff;
    padding:26px 22px;
    box-shadow:0 18px 40px rgba(0,0,0,0.06);
  }
  .process-head h2{
    margin:0 0 6px;
    font-size:28px;
    font-weight:950;
    color:#111;
    letter-spacing:-0.02em;
  }
  .process-head p{ margin:0 0 18px; color:#666; line-height:1.6; }

  .process-grid{
    position:relative;
    display:grid;
    grid-template-columns:70px 1fr;
    gap:16px;
    padding:6px 0 2px;
  }
  .proc-rail{ position:relative; }
  .proc-line{
    position:absolute;
    left:34px;
    width:2px;
    background:#ddd;
    border-radius:999px;
  }
  .proc-dot{
    position:absolute;
    left:34px;
    top:0;
    width:18px; height:18px;
    border-radius:50%;
    background:#111;
    transform:translate(-50%, -50%);
    transition:top .14s linear;
    box-shadow:0 10px 18px rgba(0,0,0,0.12);
  }

  .proc-items{ display:flex; flex-direction:column; gap:18px; }
  .proc-step{
    border-radius:26px;
    border:1px solid #efefef;
    background:#fff;
    padding:22px;
    box-shadow:0 14px 30px rgba(0,0,0,0.06);
    display:grid;
    grid-template-columns:1fr 220px;
    gap:18px;
    min-height:160px;
    align-items:center;
  }
  .proc-kicker{
    font-size:12px;
    font-weight:950;
    letter-spacing:0.10em;
    text-transform:uppercase;
    color:#999;
    margin:0 0 8px;
  }
  .proc-title{ margin:0 0 8px; font-size:20px; font-weight:950; color:#111; }
  .proc-desc{ margin:0; color:#666; line-height:1.65; }
  .proc-illus{
    height:120px;
    border-radius:20px;
    border:1px solid #f0f0f0;
    background:linear-gradient(180deg,#f8f8f8,#f2f2f2);
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:900; color:#bbb; letter-spacing:0.08em;
    text-transform:uppercase;
    font-size:12px;
  }

  .form-title{ font-size:18px; font-weight:950; margin:0 0 18px; text-align:left; }
  .form-group{ margin-bottom:12px; }
  .form-input{
    display:block; width:100%;
    padding:14px;
    border:1px solid #eee;
    border-radius:14px;
    background:#fafafa;
    font-size:14px;
    color:#111;
  }
  .form-input:focus{ outline:none; border-color:#111; background:#fff; }
  .btn-submit{
    width:100%;
    background:#2a2a2a; color:#fff;
    padding:14px;
    border-radius:14px;
    border:none;
    font-weight:950;
    cursor:pointer;
  }
  #formSuccess{ display:none; border-radius:14px; margin-top:14px; background:#f0f0f0; color:#333; padding:18px; }

  .admin-wrap{
    width:100%;
    max-width:1320px;
    margin:0 auto;
  }
  .admin-head{ margin-bottom:16px; }
  .admin-auth,
  .admin-panel,
  .admin-list-card,
  .admin-form-card{
    border:1px solid #ececec;
    border-radius:24px;
    background:#fff;
    box-shadow:0 14px 34px rgba(0,0,0,0.06);
  }
  .admin-auth{
    padding:18px;
    margin-bottom:16px;
  }
  .admin-card-title{
    font-size:13px;
    font-weight:900;
    letter-spacing:0.12em;
    text-transform:uppercase;
    color:#111;
    margin-bottom:10px;
  }
  .admin-note{
    margin:0 0 12px;
    font-size:12px;
    color:#666;
  }
  .admin-grid{
    display:grid;
    grid-template-columns:1fr;
    gap:10px;
  }
  .admin-grid.two{ grid-template-columns:repeat(2, minmax(0,1fr)); }
  .admin-grid.three{ grid-template-columns:repeat(3, minmax(0,1fr)); }
  .admin-auth-btn{ max-width:220px; }
  .admin-status{
    margin-top:10px;
    font-size:12px;
    color:#555;
  }
  .admin-panel{ padding:16px; }
  .admin-toolbar{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:10px;
    margin-bottom:14px;
    flex-wrap:wrap;
  }
  .admin-toolbar-left,
  .admin-toolbar-right{
    display:flex;
    align-items:center;
    gap:8px;
    flex-wrap:wrap;
  }
  .admin-mini-btn{
    padding:9px 12px;
    border-radius:12px;
    border:1px solid #ddd;
    font-size:11px;
    font-weight:800;
    letter-spacing:0.08em;
    text-transform:uppercase;
    cursor:pointer;
    background:#fff;
  }
  .admin-user{
    font-size:11px;
    color:#666;
    letter-spacing:0.08em;
    text-transform:uppercase;
    font-weight:800;
  }
  .admin-layout{
    display:grid;
    grid-template-columns:340px minmax(0, 1fr);
    gap:14px;
  }
  .admin-list-card,
  .admin-form-card{
    padding:14px;
  }
  .admin-list-head{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
    margin-bottom:10px;
  }
  .admin-filter-row{ margin-bottom:10px; }
  .admin-list{
    max-height:70vh;
    overflow:auto;
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .admin-item{
    border:1px solid #ededed;
    border-radius:14px;
    padding:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
    cursor:pointer;
    background:#fbfbfb;
  }
  .admin-item.active{
    border-color:#111;
    background:#fff;
  }
  .admin-item-name{
    font-size:12px;
    font-weight:900;
    color:#111;
  }
  .admin-item-meta{
    font-size:10px;
    color:#777;
    text-transform:uppercase;
    letter-spacing:0.08em;
  }
  .admin-item-actions{
    display:flex;
    gap:6px;
  }
  .admin-item-btn{
    border:1px solid #ddd;
    background:#fff;
    border-radius:10px;
    padding:6px 8px;
    font-size:10px;
    cursor:pointer;
  }
  .admin-form{ margin-top:6px; }
  .admin-type-grid{
    margin-top:10px;
    border:1px solid #efefef;
    border-radius:16px;
    padding:10px;
  }
  .admin-type-title{
    font-size:10px;
    letter-spacing:0.1em;
    text-transform:uppercase;
    font-weight:900;
    color:#666;
    margin-bottom:8px;
  }
  .admin-actions{
    display:flex;
    gap:10px;
    margin-top:12px;
  }
  .admin-danger{
    border-color:#d45454;
    color:#b03333;
  }
  body.admin-page{
    overflow:auto;
    align-items:stretch;
    justify-content:stretch;
    background:#f4f4f4;
  }
  body.admin-page .layout{
    display:block;
    width:100%;
    height:auto;
    min-height:100vh;
    padding:20px;
  }
  body.admin-page #map,
  body.admin-page .side-nav,
  body.admin-page .mobile-nav{
    display:none !important;
  }
  body.admin-page .shop{
    width:100%;
    height:auto;
    min-height:calc(100vh - 40px);
    flex:none;
    border-radius:24px;
    overflow:visible;
  }
  body.admin-page .app-section{
    display:none;
    position:relative;
    inset:auto;
    transform:none;
  }
  body.admin-page .app-section.active-section{
    display:block;
    opacity:1;
    visibility:visible;
    pointer-events:auto;
  }
  body.admin-page .section-scroll{
    height:auto;
    max-height:none;
    overflow:visible;
    padding:28px;
  }

  .modal-overlay{
    position:fixed; inset:0;
    background:rgba(0,0,0,0.45);
    backdrop-filter:blur(5px);
    z-index:9999;
    display:none;
    align-items:center;
    justify-content:center;
    opacity:0; transition:opacity .25s ease;
  }
  .modal-overlay.open{ display:flex; opacity:1; }
  .modal-box{
    background:#fff;
    width:90%;
    max-width:420px;
    padding:28px;
    border-radius:26px;
    box-shadow:0 24px 60px rgba(0,0,0,0.22);
    transform:translateY(18px);
    transition:transform .25s cubic-bezier(.2,.8,.2,1);
    max-height:90vh;
    overflow-y:auto;
  }
  .modal-overlay.open .modal-box{ transform:translateY(0); }
  .close-modal{ position:absolute; top:16px; right:16px; background:none; border:none; font-size:22px; color:#999; cursor:pointer; }

  .site-footer{
    margin-top:28px;
    background:#262626;
    color:#fff;
    border-radius:22px;
    overflow:hidden;
    box-shadow:0 18px 44px rgba(0,0,0,0.18);
  }
  .site-footer .ft-top{ padding:26px 24px 16px; }
  .site-footer .ft-brand{
    font-weight:950;
    letter-spacing:0.18em;
    text-transform:uppercase;
    font-size:13px;
    opacity:.92;
  }
  .site-footer .ft-note{
    margin-top:10px;
    color:rgba(255,255,255,0.80);
    line-height:1.7;
    font-size:13px;
    max-width:780px;
  }
  .site-footer .ft-grid{
    display:grid;
    grid-template-columns:1.2fr 1fr 1fr;
    gap:18px;
    padding:18px 24px 22px;
    border-top:1px solid rgba(255,255,255,0.10);
  }
  .ft-title{
    font-weight:950;
    letter-spacing:0.18em;
    text-transform:uppercase;
    font-size:12px;
    opacity:.85;
    margin-bottom:12px;
  }
  .ft-text{ color:rgba(255,255,255,0.82); font-size:13px; line-height:1.7; }
  .ft-links a{
    display:block;
    padding:10px 0;
    color:rgba(255,255,255,0.85);
    text-decoration:none;
    border-bottom:1px solid rgba(255,255,255,0.10);
    font-weight:750;
  }
  .ft-links a:last-child{ border-bottom:none; }
  .ft-links a:hover{ color:#fff; }

  .ft-social a{
    display:flex;
    align-items:center;
    gap:12px;
    padding:10px 0;
    color:rgba(255,255,255,0.88);
    text-decoration:none;
    border-bottom:1px solid rgba(255,255,255,0.10);
    font-weight:800;
  }
  .ft-social a:last-child{ border-bottom:none; }
  .ft-ic{
    width:34px;height:34px;border-radius:999px;
    background:rgba(255,255,255,0.12);
    display:flex;align-items:center;justify-content:center;
    font-weight:950;
  }
  .ft-copy{
    padding:0 24px 22px;
    color:rgba(255,255,255,0.70);
    font-size:12px;
    font-weight:800;
  }

  @media (max-width:900px){
    body{
      height:auto;
      min-height:100vh;
      overflow-y:auto;
      align-items:stretch;
      justify-content:flex-start;
    }
    .layout{ height:auto; min-height:100vh; }
    .layout{ flex-direction:column; }
    #map{ width:100%; height:45vh; flex:none; }
    .shop{
      width:100%;
      height:auto;
      flex:none;
      border-radius:0;
      margin-top:-30px;
      z-index:40;
      overflow:visible;
    }
    .app-section{
      position:relative;
      inset:auto;
      height:auto;
      min-height:0;
      transform:none;
    }
    .app-section:not(.active-section){
      display:none;
      opacity:0;
      visibility:hidden;
      pointer-events:none;
    }
    .app-section.active-section{ display:flex; }
    .side-nav{ display:none; }
    .mobile-nav{ display:flex; }
    .section-scroll{ padding:22px; height:auto; overflow:visible; }

    /* HOME mobile */
    .home-screen{
      --home-pad-left:20px;
      --home-pad-right:20px;
      height:auto;
      overflow:visible;
      padding:22px var(--home-pad-right) 64px var(--home-pad-left);
      gap:12px;
    }
    #sect-home .section-scroll{
      height:auto;
      overflow:visible;
    }
    .home-top{ --home-logo-width:min(520px, 92%); }
    .home-top small{ font-size:18px; padding-left:5%; }
    .home-tagline{ font-size:15px; letter-spacing:0.4em; }
    .home-main{ grid-template-columns:1fr; gap:12px; align-items:stretch; margin-top:0; border-radius:0; }
    .home-banner{
      position:static;
      width:100%;
      padding:20px 18px;
    }
    .home-banner-title{ font-size:22px; }
    .home-banner-btn{ font-size:18px; padding:12px 21px; }
    .home-copy{ margin:0 0 10px 0; width:100%; }
    .home-copy-title{ font-size:30px; line-height:1.4; }
    .home-glass{ padding:20px 20px; height:auto; min-height:0; max-height:none; }
    .btn-home{ font-size:12px; padding:12px 22px; }
    .home-illustration-wrap{ height:auto; justify-content:flex-start; padding:0; }
    .home-illustration-track{ gap:0; padding:0; scroll-padding-left:0; }
    .home-slide{ padding:0; flex-direction:column; align-items:stretch; }
    .home-slide-media{ width:100%; height:220px; padding-left:0; }
    .home-illustration{ border-radius:0; }
    .home-slider-controls{ left:14px; right:14px; bottom:12px; }
    .home-slider-dots{ gap:8px; }
    .home-dot{ width:7px; height:7px; }
    .home-dot.active{ width:18px; }
    .home-slider-arrows{ gap:10px; }
    .home-arrow{ font-size:16px; }

    /* 3D popup mobile */
    .map-3d-popup{
      left:50%;
      top:50%;
      width:30%;
      max-width:260px;
      min-width:140px;
      transform:translate(-50%, -50%);
    }

    .shop-head{ padding:18px 18px; }
    .shop-body{ padding:18px 18px 70px; }
    .grid{ grid-template-columns:repeat(2, 1fr); gap:14px; }
    .card{ padding:16px 12px; border-radius:24px; }
    .card-media{ height:118px; }
    .book-filter-bar{ flex-direction:column; align-items:flex-start; }
    .book-filter-btn{ width:100%; justify-content:center; }
    .book-filter-summary{ font-size:10px; }
    .book-filter-card{ padding:20px; }
    .book-filter-row{ flex-direction:column; align-items:flex-start; }
    .book-filter-row select{ width:100%; }
    .art-filter-bar{ flex-direction:column; align-items:flex-start; }
    .art-filter-btn{ width:100%; justify-content:center; }
    .art-filter-summary{ font-size:10px; }
    .art-filter-card{ padding:20px; }
    .art-filter-row{ flex-direction:column; align-items:flex-start; }
    .art-filter-row select{ width:100%; }
    .card.book-card{ padding:0; }
    .card.book-card .card-media{ height:200px; }
    .card.book-card .card-name{ padding:12px 14px 4px; }
    .card.book-card .card-sub{ padding:0 14px 14px; }
    .card.art-card .card-media{ height:170px; }
    .card.sculpture-card .card-media{ height:170px; }
    .gallery-top{ gap:10px; }
    .gallery-title{ font-size:13px; }
    .gallery-link{ font-size:9px; padding:7px 12px; }
    .artists-hero{ grid-template-columns:1fr; padding:18px; }
    .artists-meta{ gap:10px; }
    .artists-meta-item{ min-width:0; flex:1; }
    .artists-grid{ grid-template-columns:1fr; }
    .artist-card-products{ grid-template-columns:repeat(3, minmax(0,1fr)); }
    .artist-hero{ grid-template-columns:1fr; }
    .artist-hero-media{ max-width:320px; }
    .artist-meta-grid{ grid-template-columns:1fr; }
    .artist-products-grid{ grid-template-columns:1fr; }
    .admin-layout{ grid-template-columns:1fr; }
    .admin-grid.two,
    .admin-grid.three{ grid-template-columns:1fr; }
    .admin-actions{ flex-direction:column; }
    .admin-auth-btn{ max-width:none; width:100%; }

    .book-frame{ padding:16px; }
    .book-layout{ grid-template-columns:1fr; gap:18px; }
    .book-media{ min-height:320px; position:static; top:auto; }
    .book-title{ font-size:20px; }
    .book-offer{ flex-direction:column; align-items:flex-start; }
    .book-offer-btn{ margin-left:0; }
    .book-accessory-grid{ grid-template-columns:repeat(2, minmax(0,1fr)); }

    .art-frame{ padding:16px; }
    .art-layout{ grid-template-columns:1fr; grid-template-areas:"config" "summary"; }
    .art-config{ border-right:none; padding-right:0; }
    .art-summary{ padding-left:0; }
    .art-frame-grid{ grid-template-columns:repeat(2, minmax(0,1fr)); }
    .art-frame-rail{ grid-template-columns:repeat(2, minmax(0,1fr)); }
    .art-right-media img{ height:180px; }

    /* SOLO frame mobile */
    #sect-gallery.solo .solo-frame-foot{
      padding:14px 16px;
      flex-direction:column;
      align-items:stretch;
      gap:12px;
    }
    .back-nav{ flex-direction:column; align-items:flex-start; }
    .solo-tabs-bar{ padding:8px 0 0; }
    .solo-tabs-bar.top{ width:100%; justify-content:flex-start; }
    .media-tabs{ padding:4px; gap:4px; }
    .media-tab{ padding:6px 10px; font-size:8px; letter-spacing:0.05em; }
    .solo-foot-right{ width:100%; align-items:stretch; }
    .solo-bottom-tabs-inner{ width:100%; justify-content:space-between; }
    .solo-bottom-tab{ flex:1; padding:10px 8px; font-size:10px; }
    .solo-tab-wrap{ flex:1; }
    .solo-popover{ gap:8px; padding:10px; }
    .solo-suboption{ flex:1; text-align:center; padding:12px 10px; font-size:11px; }
    .solo-inquiry-grid{ grid-template-columns:1fr; }
    .solo-info-card{
      left:16px; right:16px;
      top:auto; bottom:128px;
      width:auto; max-width:none;
      transform:translateY(12px);
    }
    #sect-gallery.solo .solo-frame.info-open .solo-info-card{ transform:translateY(0); }

    .services-grid{ grid-template-columns:repeat(2, minmax(0, 1fr)); }
    .proc-step{ grid-template-columns:1fr; }
    .proc-illus{ height:100px; }
    .process-grid{ grid-template-columns:54px 1fr; }
    .proc-line, .proc-dot{ left:26px; }
    .about-grid{ grid-template-columns:1fr; }
    #sect-about .section-scroll{ padding:22px; }
    #sect-about .sec-title{ font-size:34px; margin-bottom:10px; }
    .about-lead{ font-size:20px; line-height:1.7; margin-bottom:12px; }
    .about-sublead{ font-size:15px; line-height:1.7; margin-bottom:18px; }
    .about-card{ min-height:auto; border-radius:22px; padding:16px; }
    .about-card-media{ height:112px; border-radius:18px; }
    .about-card-media::before{ width:64px; height:10px; top:10px; left:10px; }
    .about-card-title{ font-size:17px; }
    .about-card-desc{ font-size:12px; }
    .site-footer .ft-grid{ grid-template-columns:1fr; }
  }

  @media (max-width:420px){
    .mobile-nav{ left:8px; right:8px; bottom:30px; padding:5px; gap:3px; }
    .mobile-nav .nav-item{ font-size:9px; padding:9px 4px; letter-spacing:0.04em; }
  }
</style>
</head>

<body class="admin-page">
<div class="layout">
  <div id="map">
    <!-- ✅ 3D popup container -->
    <div class="map-3d-popup" id="map3dPopup">
      <div class="map-3d-inner" id="map3dInner"></div>
    </div>

    <nav class="side-nav" id="sideNav">
      <div class="nav-item" id="navHome">Home</div>
      <div class="nav-item" id="navAbout">About Us</div>
      <div class="nav-item" id="navServices">Services</div>
      <div class="nav-item active" id="navGallery">Gallery</div>
      <div class="nav-item" id="navContact">Contact Us</div>
      <div class="nav-item" id="navAdmin">Admin</div>
    </nav>

    <nav class="mobile-nav" id="mobileNav">
      <div class="nav-item" id="mNavHome">Home</div>
      <div class="nav-item" id="mNavAbout">About</div>
      <div class="nav-item" id="mNavServices">Services</div>
      <div class="nav-item active" id="mNavGallery">Gallery</div>
      <div class="nav-item" id="mNavContact">Contact</div>
      <div class="nav-item" id="mNavAdmin">Admin</div>
    </nav>
  </div>

  <aside class="shop" id="shop">

    <!-- HOME -->
    <section id="sect-home" class="app-section active-section">
      <div class="section-scroll">
        <div class="home-screen">
          <div class="home-top">
            <small>Welcome to</small>
            <img
              class="home-logo"
              src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69442b591074614cc12c66e3_IMAGE.png"
              alt="FNN ART"
            />
            <div class="home-tagline">The New Marketplace for Exceptional Art</div>
          </div>

          <div class="home-main">
            <div class="home-banner">
              <h3 class="home-banner-title">
                <span>Original Art For Sale</span>
              </h3>
              <button class="home-banner-btn" type="button" onclick="switchSection('sect-gallery')">Browse Collection</button>
            </div>

            <div class="home-illustration-wrap">
              <div class="home-illustration-track" aria-label="Home artwork slider">
                <article class="home-slide">
                  <div class="home-slide-media">
                    <img
                      class="home-illustration"
                      src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/694d22cb1f8ea86c4b6f1402_Gemini_Generated_Image_jt70lgjt70lgjt70.png"
                      alt="Gallery artwork 1"
                    />
                  </div>
                </article>
                <article class="home-slide">
                  <div class="home-slide-media">
                    <img
                      class="home-illustration"
                      src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/694d22cb19f13d59d8e873bb_Gemini_Generated_Image_jpmt2ljpmt2ljpmt.png"
                      alt="Gallery artwork 2"
                    />
                  </div>
                </article>
                <article class="home-slide">
                  <div class="home-slide-media">
                    <img
                      class="home-illustration"
                      src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/694d22ca91a13a0bfec82bb6_Gemini_Generated_Image_94ixz894ixz894ix.png"
                      alt="Gallery artwork 3"
                    />
                  </div>
                </article>
              </div>
            </div>
          </div>
          <div class="home-slider-controls" aria-label="Home slider controls">
            <div class="home-slider-dots" id="homeSliderDots" aria-label="Home slider dots">
              <button class="home-dot active" type="button" data-index="0" aria-label="Slide 1"></button>
              <button class="home-dot" type="button" data-index="1" aria-label="Slide 2"></button>
              <button class="home-dot" type="button" data-index="2" aria-label="Slide 3"></button>
            </div>
            <div class="home-slider-arrows" aria-label="Home slider arrows">
              <button class="home-arrow" type="button" data-dir="-1" aria-label="Previous slide">&larr;</button>
              <button class="home-arrow" type="button" data-dir="1" aria-label="Next slide">&rarr;</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="sect-about" class="app-section">
      <div class="section-scroll">
        <div class="about-wrap">
          <h1 class="sec-title">About FNN</h1>

          <p class="about-lead">
            FNN is a modern marketplace art platform specializing in the presentation of original artworks by selected artists&mdash;connecting creative expression with audiences and institutions.
          </p>

          <p class="about-sublead">
            Its mission is to elevate art as a cultural value and creative identity by providing a professional environment that honors both the artist and the artwork, while connecting creative expression with audiences and art institutions. FNN aspires to become the Art Content Center (NDCC) for the art scene in the GCC.
          </p>

          <div class="about-grid">
            <article class="about-card">
              <div class="about-card-media">
                <img src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69512ec8aee7d6fa05969c14_Gemini_Generated_Image_qy4vwpqy4vwpqy4v.png" alt="Arts &amp; Culture">
              </div>
              <div class="about-card-meta">ARTS &amp; CULTURE</div>
              <h3 class="about-card-title">Curated Platforms<br>&amp; Exhibitions</h3>
              <p class="about-card-desc">
                Presenting original works by local and international artists, alongside commissioned installations and gallery-style programs exploring identity, place, and modern culture.
              </p>
            </article>

            <article class="about-card">
              <div class="about-card-media">
                <img src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69512ec791fd7e92338b007c_Gemini_Generated_Image_vtikswvtikswvtik.png" alt="Creative Infrastructure">
              </div>
              <div class="about-card-meta">CREATIVE INFRASTRUCTURE</div>
              <h3 class="about-card-title">Art Content Center<br>&amp; Partnerships</h3>
              <p class="about-card-desc">
                Operating as the NDCC for art creation and archiving. Collaborating with cultural entities to integrate art into public spaces, extending the physical experience through digital platforms.
              </p>
            </article>

            <article class="about-card">
              <div class="about-card-media">
                <img src="https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69512ec6c106b34fd4b6d7a4_Gemini_Generated_Image_h6blrlh6blrlh6bl.png" alt="Media &amp; Cultural Impact">
              </div>
              <div class="about-card-meta">MEDIA &amp; CULTURAL IMPACT</div>
              <h3 class="about-card-title">Cultural Narrative<br>&amp; Engagement</h3>
              <p class="about-card-desc">
                Shaping Saudi Arabia&#39;s contemporary art narrative and creating accessible, elevated art experiences to connect diverse audiences with creative expression.
              </p>
            </article>
          </div>
        </div>
      </div>
    </section>

    <!-- SERVICES -->
    <section id="sect-services" class="app-section">
      <div class="section-scroll">
        <h1 class="sec-title">Services</h1>
        <p class="sec-sub">A complete pipeline—from creative direction to installation—built for quality, clarity, and impact.</p>

        <div class="services-wrap">
          <div class="services-grid" id="servicesGrid">
            <div class="svc-card"><div class="svc-ico">◎</div><h3 class="svc-title">Creative Planning</h3><p class="svc-desc">Sculptural and contemporary art planning—translating culture into form.</p></div>
            <div class="svc-card"><div class="svc-ico">✎</div><h3 class="svc-title">Original design</h3><p class="svc-desc">Original concepts inspired by renowned artists and professional teams.</p></div>
            <div class="svc-card"><div class="svc-ico">▤</div><h3 class="svc-title">Excellent structure</h3><p class="svc-desc">Qualification-led analysis—ensuring stability, safety, and longevity.</p></div>
            <div class="svc-card"><div class="svc-ico">✶</div><h3 class="svc-title">Crafted with ingenuity</h3><p class="svc-desc">Refined execution where detail, patience, and intent define the final work.</p></div>

            <div class="svc-card"><div class="svc-ico">⌂</div><h3 class="svc-title">Professional installation</h3><p class="svc-desc">Integrated workflows for safe, precise, and reliable delivery on site.</p></div>
            <div class="svc-card"><div class="svc-ico">⌁</div><h3 class="svc-title">Refurbishment & Restoration</h3><p class="svc-desc">Renovation and care—bringing works back to life with expert teams.</p></div>
            <div class="svc-card"><div class="svc-ico">▢</div><h3 class="svc-title">Art rental</h3><p class="svc-desc">Rental services for sculptures and artworks—supporting programs & projects.</p></div>
            <div class="svc-card"><div class="svc-ico">⌖</div><h3 class="svc-title">Site survey</h3><p class="svc-desc">On-site inspection and coordination—aligning implementation to vision.</p></div>

            <div class="svc-card"><div class="svc-ico">◇</div><h3 class="svc-title">Curatorial services</h3><p class="svc-desc">Research, selection, and presentation strategy for exhibitions and collections.</p></div>
            <div class="svc-card"><div class="svc-ico">🎧</div><h3 class="svc-title">Art Consultant</h3><p class="svc-desc">Concept proposals, guidance, and recommendations tailored to your space.</p></div>
            <div class="svc-card"><div class="svc-ico">◔</div><h3 class="svc-title">Art broker</h3><p class="svc-desc">Market services connecting institutions, collectors, and artists—locally and globally.</p></div>
            <div class="svc-card"><div class="svc-ico">⧉</div><h3 class="svc-title">Artistic Supervisor</h3><p class="svc-desc">Quality monitoring, materials review, and execution supervision end-to-end.</p></div>
          </div>

          <div class="process" id="processBlock">
            <div class="process-head">
              <h2>Our process</h2>
              <p>8 clear steps—from discovery to delivery—designed to keep quality high and execution smooth.</p>
            </div>

            <div class="process-grid" id="processGrid">
              <div class="proc-rail">
                <div class="proc-line"></div>
                <div class="proc-dot" id="procDot"></div>
              </div>

              <div class="proc-items" id="procItems">
                <div class="proc-step"><div><div class="proc-kicker">Step 1</div><h3 class="proc-title">Discovery & Direction</h3><p class="proc-desc">Define goals, context, constraints, and the cultural story you want the work to carry.</p></div><div class="proc-illus">Illustration</div></div>
                <div class="proc-step"><div><div class="proc-kicker">Step 2</div><h3 class="proc-title">Concept & References</h3><p class="proc-desc">Moodboards, precedents, and initial concepts aligned with the site and audience.</p></div><div class="proc-illus">Illustration</div></div>
                <div class="proc-step"><div><div class="proc-kicker">Step 3</div><h3 class="proc-title">Design Development</h3><p class="proc-desc">Refine form, materials, scale, and presentation details with clear approvals.</p></div><div class="proc-illus">Illustration</div></div>
                <div class="proc-step"><div><div class="proc-kicker">Step 4</div><h3 class="proc-title">Engineering Review</h3><p class="proc-desc">Structural checks, safety planning, and feasibility for production & installation.</p></div><div class="proc-illus">Illustration</div></div>
                <div class="proc-step"><div><div class="proc-kicker">Step 5</div><h3 class="proc-title">Production Planning</h3><p class="proc-desc">Scheduling, sourcing, and documentation to keep quality consistent.</p></div><div class="proc-illus">Illustration</div></div>
                <div class="proc-step"><div><div class="proc-kicker">Step 6</div><h3 class="proc-title">Fabrication & Build</h3><p class="proc-desc">Craft, finishing, and quality checks—executed with high attention to detail.</p></div><div class="proc-illus">Illustration</div></div>
                <div class="proc-step"><div><div class="proc-kicker">Step 7</div><h3 class="proc-title">Installation & On-site</h3><p class="proc-desc">Professional installation, safety protocol, and site coordination.</p></div><div class="proc-illus">Illustration</div></div>
                <div class="proc-step"><div><div class="proc-kicker">Step 8</div><h3 class="proc-title">Handover & Care</h3><p class="proc-desc">Final delivery, documentation, and care recommendations for longevity.</p></div><div class="proc-illus">Illustration</div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- GALLERY -->
    <section id="sect-gallery" class="app-section">
      <header class="shop-head">
        <div class="gallery-head">
          <div class="gallery-top">
            <div class="gallery-title">Gallery</div>
            <button class="gallery-link" id="galleryArtistsLink" type="button">Artists</button>
          </div>
          <nav class="gallery-tabs" id="galleryTabs" aria-label="Gallery categories">
            <button class="chip gallery-chip" data-gallery="art">Art</button>
            <button class="chip gallery-chip active" data-gallery="furniture">Designs</button>
            <button class="chip gallery-chip" data-gallery="books">Books</button>
            <button class="chip gallery-chip" data-gallery="designs">Photography</button>
          </nav>
          <nav class="nav-group" id="filters" aria-label="Designs filters">
            <button class="chip active" data-filter="all" id="btnAll">ALL</button>
            <button class="chip" data-filter="cabinet">Cabinets</button>
            <button class="chip" data-filter="sideboard">Sideboards</button>
            <button class="chip" data-filter="decor">Decor</button>
          </nav>
          <div class="book-filter-bar" id="bookFilterBar" hidden>
            <button class="book-filter-btn" type="button" id="bookFilterBtn">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 6h16M7 12h10M10 18h4" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                <circle cx="8" cy="6" r="1.6" fill="currentColor"/>
                <circle cx="15" cy="12" r="1.6" fill="currentColor"/>
                <circle cx="12" cy="18" r="1.6" fill="currentColor"/>
              </svg>
              Filter & Sort
            </button>
            <div class="book-filter-summary" id="bookFilterSummary">Featured · All Themes · All Colors · All Sizes</div>
          </div>
          <div class="art-filter-bar" id="artFilterBar" hidden>
            <button class="art-filter-btn" type="button" id="artFilterBtn">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 6h16M7 12h10M10 18h4" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                <circle cx="8" cy="6" r="1.6" fill="currentColor"/>
                <circle cx="15" cy="12" r="1.6" fill="currentColor"/>
                <circle cx="12" cy="18" r="1.6" fill="currentColor"/>
              </svg>
              Filter & Sort
            </button>
            <div class="art-filter-summary" id="artFilterSummary">Featured · All Types · All Artists · All Periods · All Media</div>
          </div>
        </div>
      </header>

      <div class="shop-body">
        <div class="gallery-empty" id="galleryEmpty" hidden>
          <div class="gallery-empty-title">Collection coming soon</div>
          <p class="gallery-empty-desc">We are curating new pieces now. Check back soon.</p>
        </div>
        <div class="grid" id="grid"></div>

        <div class="solo-wrap" id="soloWrap">
          <div class="back-nav">
            <button class="btn-back" id="btnBack">&larr; Back to Collection</button>
            <div class="solo-tabs-bar top"><div id="soloTabs"></div></div>
          </div>

          <div class="solo-frame">
            <div class="solo-media-container" id="soloMedia"></div>

            <aside class="solo-info-card" id="soloInfoCard" aria-hidden="true">
              <button class="solo-info-close" type="button" id="soloInfoClose" aria-label="Close info">&times;</button>
              <div class="solo-info-title" id="soloInfoName">PRODUCT</div>
              <div class="solo-info-text" id="soloInfoText">Contemporary design meeting functionality.</div>
              <div class="solo-info-meta">
                <div class="solo-meta-item"><span id="soloInfoLabel1">Material</span><strong id="soloInfoMat">--</strong></div>
                <div class="solo-meta-item"><span id="soloInfoLabel2">Dimensions</span><strong id="soloInfoDim">--</strong></div>
                <div class="solo-meta-item"><span id="soloInfoLabel3">Location</span><strong id="soloInfoLoc">--</strong></div>
              </div>
              <div id="soloInfoExtra"></div>
            </aside>

            <div class="solo-config" id="soloConfig" aria-hidden="true">
              <button class="solo-config-close" type="button" id="soloConfigClose" aria-label="Close customizer">&times;</button>
              <div class="solo-config-title" id="soloConfigTitle">Customizer</div>
              <div class="solo-config-body" id="soloConfigBody">
                <div class="solo-config-section" id="soloConfigFurniture">
                  <div class="solo-config-group">
                    <div class="solo-config-label">Color</div>
                    <div class="solo-config-options" id="soloConfigColors" role="group" aria-label="Choose color">
                      <button class="solo-config-option" type="button" data-color="Red">Red</button>
                      <button class="solo-config-option" type="button" data-color="Blue">Blue</button>
                      <button class="solo-config-option" type="button" data-color="Sand">Sand</button>
                    </div>
                  </div>
                  <div class="solo-config-group">
                    <div class="solo-config-label">Size</div>
                    <div class="solo-config-options" id="soloConfigSizes" role="group" aria-label="Choose size">
                      <button class="solo-config-option" type="button" data-size="Small">Small</button>
                      <button class="solo-config-option" type="button" data-size="Medium">Medium</button>
                      <button class="solo-config-option" type="button" data-size="Large">Large</button>
                    </div>
                  </div>
                  <div class="solo-config-summary" id="soloConfigSummary">Selected: -- / --</div>
                </div>

                <div class="solo-config-section" id="soloConfigArt" hidden>
                  <div class="art-header">
                    <div>
                      <div class="art-title" id="artTitle">Artwork Title</div>
                      <div class="art-artist">by <span id="artArtist">Artist Name</span></div>
                      <div class="art-rating">
                        <span class="stars" id="artStars">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
                        <span id="artRatingText">4.8 stars from 50+ ratings</span>
                      </div>
                  </div>
                    <button class="art-fav" type="button" aria-label="Save">&#9825;</button>
                  </div>

                  <div class="art-arrival" id="artArrival">Arrives by Mon, Feb 9 to 66952</div>

                  <div class="art-section">
                    <div class="art-section-title">1- Choose a service type:</div>
                    <div class="art-service-grid" id="artServiceOptions">
                      <div class="art-service-card" data-service="print">
                        <div class="art-service-illu"></div>
                        Print and Frames
                      </div>
                      <div class="art-service-card" data-service="canvas">
                        <div class="art-service-illu"></div>
                        Stretched Canvas
                      </div>
                      <div class="art-service-card" data-service="wood">
                        <div class="art-service-illu"></div>
                        Wood Mount &amp; More
                      </div>
                    </div>
                  </div>

                  <div class="art-section">
                    <div class="art-section-title">2- Choose print size:</div>
                    <div class="art-options" id="artSizeOptions">
                      <button class="art-option" type="button" data-size="12x16">12" x 16"</button>
                      <button class="art-option" type="button" data-size="18x24">18" x 24"</button>
                      <button class="art-option" type="button" data-size="24x32">24" x 32"</button>
                    </div>
                  </div>

                  <div class="art-section">
                    <div class="art-section-title">3- Choose a frame:</div>
                    <div class="art-frame-grid" id="artFrameOptions">
                      <div class="art-frame-card" data-frame="classic">Classic</div>
                      <div class="art-frame-card" data-frame="premium">Premium</div>
                      <div class="art-frame-card" data-frame="signature">Signature</div>
                      <div class="art-frame-card" data-frame="sale">Sale</div>
                    </div>
                    <div class="art-frame-rail">
                      <div class="art-frame-swatch" style="background:#111;"></div>
                      <div class="art-frame-swatch" style="background:#f2f2f2;"></div>
                      <div class="art-frame-swatch" style="background:#8b5a2b;"></div>
                      <div class="art-frame-swatch" style="background:#fafafa;"></div>
                    </div>
                  </div>

                  <div class="art-buy-row">
                    <div class="art-buy-left">
                      <div class="art-thumb"><img id="artThumb" src="" alt="Artwork preview"></div>
                      <div>
                        <strong>Buy just the print</strong><br>
                        <span id="artPrintNote">(Image 12" x 16")</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="solo-config-section" id="soloConfigSculpture" hidden>
                  <div class="art-header">
                    <div>
                      <div class="art-title" id="sculptureTitle">Sculpture Title</div>
                      <div class="art-artist">by <span id="sculptureArtist">Artist Name</span></div>
                      <div class="art-rating">
                        <span class="stars" id="sculptureStars">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
                        <span id="sculptureRatingText">4.8 stars from 50+ ratings</span>
                      </div>
                      <div class="art-artist" id="sculptureMeta">Marble - Renaissance - 1504</div>
                  </div>
                    <button class="art-fav" type="button" aria-label="Save">&#9825;</button>
                  </div>

                  <div class="art-arrival" id="sculptureArrival">Arrives by Mon, Feb 9 to 66952</div>

                  <div class="art-section">
                    <div class="art-section-title">1- Choose a finish:</div>
                    <div class="art-service-grid" id="sculptureFinishOptions">
                      <div class="art-service-card" data-finish="polished">
                        <div class="art-service-illu"></div>
                        Polished
                      </div>
                      <div class="art-service-card" data-finish="antique">
                        <div class="art-service-illu"></div>
                        Antique
                      </div>
                      <div class="art-service-card" data-finish="matte">
                        <div class="art-service-illu"></div>
                        Matte
                      </div>
                    </div>
                  </div>

                  <div class="art-section">
                    <div class="art-section-title">2- Choose size:</div>
                    <div class="art-options" id="sculptureSizeOptions">
                      <button class="art-option" type="button" data-size="small">Small</button>
                      <button class="art-option" type="button" data-size="medium">Medium</button>
                      <button class="art-option" type="button" data-size="large">Large</button>
                    </div>
                  </div>

                  <div class="art-section">
                    <div class="art-section-title">3- Choose a base:</div>
                    <div class="art-frame-grid" id="sculptureBaseOptions">
                      <div class="art-frame-card" data-base="stone">Stone</div>
                      <div class="art-frame-card" data-base="wood">Wood</div>
                      <div class="art-frame-card" data-base="metal">Metal</div>
                      <div class="art-frame-card" data-base="none">None</div>
                    </div>
                    <div class="art-frame-rail">
                      <div class="art-frame-swatch" style="background:#e7e2dc;"></div>
                      <div class="art-frame-swatch" style="background:#b07a4e;"></div>
                      <div class="art-frame-swatch" style="background:#6f6f6f;"></div>
                      <div class="art-frame-swatch" style="background:#f7f7f7;"></div>
                    </div>
                  </div>

                  <div class="art-buy-row">
                    <div class="art-buy-left">
                      <div class="art-thumb"><img id="sculptureThumb" src="" alt="Sculpture preview"></div>
                      <div>
                        <strong>Buy just the sculpture</strong><br>
                        <span id="sculptureSizeNote">(Medium)</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="solo-config-section" id="soloConfigBook" hidden>
                  <div class="book-customs">
                    <div class="book-customs-title">Book options</div>
                    <div class="book-offer book-offer-select" data-option="gift-wrap">
                      <div class="book-offer-media" aria-hidden="true"></div>
                      <div class="book-offer-text">
                        <div class="book-offer-title">Add complimentary gift wrapping</div>
                        <div class="book-offer-desc">Make your gift memorable, on us.</div>
                      </div>
                      <button class="book-offer-btn" type="button" aria-pressed="false">+</button>
                    </div>

                    <div class="book-offer book-offer-alt book-offer-select" data-option="e-gift">
                      <div class="book-offer-text">
                        <div class="book-offer-title">Send this item as an e-gift, or gift it to multiple recipients.</div>
                        <div class="book-offer-desc">Learn more</div>
                      </div>
                      <button class="book-offer-btn" type="button" aria-pressed="false">+</button>
                    </div>
                    <div class="solo-config-summary" id="bookCustomsSummary">Selected: None</div>
                  </div>
                </div>
              </div>
              <div class="solo-inquiry-fields" id="soloInquiryFields" hidden>
                <div class="solo-inquiry-label">Your details</div>
                <div class="solo-inquiry-grid">
                  <input class="solo-inquiry-input" type="text" id="inquiryName" name="inquiryName" placeholder="Your Name" autocomplete="name">
                  <input class="solo-inquiry-input" type="email" id="inquiryEmail" name="inquiryEmail" placeholder="Your Email" autocomplete="email">
                </div>
              </div>
              <button class="btn btn-primary solo-inquiry-btn" id="soloInquiryBtn" type="button" hidden>Send Inquiry</button>
            </div>

            <div class="solo-frame-foot">
              <div class="solo-foot-left">
              <div class="solo-foot-title" id="soloFootTitle">PRODUCT</div>
              <div class="solo-foot-desc" id="soloFootDesc">Contemporary design meeting functionality.</div>
            </div>

              <div class="solo-foot-right">
                <div class="solo-bottom-tabs" aria-label="Product options">
                  <div class="solo-bottom-tabs-inner">
                    <button class="solo-bottom-tab" type="button" id="soloInfoBtn" aria-controls="soloInfoCard" aria-expanded="false">INFO</button>

                    <div class="solo-tab-wrap" id="soloColorTabWrap">
                      <button class="solo-bottom-tab" type="button" id="soloColorBtn" aria-expanded="false">COLOR</button>
                      <div class="solo-popover" id="soloColorPopover" hidden>
                        <button class="solo-suboption" type="button" data-color="Red">RED</button>
                        <button class="solo-suboption" type="button" data-color="Blue">BLUE</button>
                        <button class="solo-suboption" type="button" data-color="Sand">SAND</button>
                      </div>
                    </div>

                    <div class="solo-tab-wrap" id="soloSizeTabWrap">
                      <button class="solo-bottom-tab" type="button" id="soloSizeBtn" aria-expanded="false">SIZE</button>
                      <div class="solo-popover" id="soloSizePopover" hidden>
                        <button class="solo-suboption" type="button" data-size="Small">SMALL</button>
                        <button class="solo-suboption" type="button" data-size="Medium">MEDIUM</button>
                        <button class="solo-suboption" type="button" data-size="Large">LARGE</button>
                      </div>
                    </div>

                    <button class="solo-bottom-tab" type="button" id="soloCustomsBtn" aria-controls="soloConfig" aria-expanded="false">CUSTOMS</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="solo-info-block">
            <div class="solo-desc">
              <strong id="soloTitle">PRODUCT</strong><br>
              <span id="soloDescText">Contemporary design meeting functionality.</span>
              <div class="data-row">
                <div class="data-item"><span id="soloMetaLabel1">Material</span><span id="spMat">--</span></div>
                <div class="data-item"><span id="soloMetaLabel2">Dimensions</span><span id="spDim">--</span></div>
                <div class="data-item"><span id="soloMetaLabel3">Location</span><span id="soloStore">--</span></div>
              </div>
            </div>

            <div class="artist-profile" id="artistBtn">
              <div class="avatar"><img id="artistImg" src="" alt="Designer"></div>
              <div class="artist-info"><h4 id="artistName">--</h4><p id="artistRole">--</p></div>
              <div class="artist-cta">View Bio →</div>
            </div>

            <div class="actions">
              <button class="btn btn-primary" id="btnContactProduct">Contact Us</button>
              <button class="btn btn-ghost" id="btnClose">Close</button>
            </div>
          </div>
        </div>

        <div class="book-filter-modal" id="bookFilterModal" aria-hidden="true">
        <div class="book-filter-card">
          <div class="book-filter-head">
            <div class="book-filter-title">Filter &amp; Sort</div>
            <button class="book-filter-close" type="button" id="bookFilterClose" aria-label="Close">×</button>
          </div>

          <div class="book-filter-row">
            <label for="bookSortSelect">Sort by:</label>
            <select id="bookSortSelect">
              <option value="featured">Featured</option>
              <option value="price-low">Price: Low to High</option>
              <option value="price-high">Price: High to Low</option>
              <option value="title-asc">Title: A–Z</option>
            </select>
          </div>

          <div class="book-filter-group">
            <button class="book-filter-toggle" type="button" data-target="bookFilterThemes">
              Themes <span>▾</span>
            </button>
            <div class="book-filter-options" id="bookFilterThemes">
              <label><input type="checkbox" value="Heritage"> Heritage</label>
              <label><input type="checkbox" value="Pilgrimage"> Pilgrimage</label>
              <label><input type="checkbox" value="Architecture"> Architecture</label>
              <label><input type="checkbox" value="Travel"> Travel</label>
              <label><input type="checkbox" value="Culture"> Culture</label>
            </div>
          </div>

          <div class="book-filter-group">
            <button class="book-filter-toggle" type="button" data-target="bookFilterColors">
              Color <span>▾</span>
            </button>
            <div class="book-filter-options" id="bookFilterColors">
              <label><input type="checkbox" value="Warm"> Warm</label>
              <label><input type="checkbox" value="Cool"> Cool</label>
              <label><input type="checkbox" value="Neutral"> Neutral</label>
              <label><input type="checkbox" value="Bold"> Bold</label>
            </div>
          </div>

          <div class="book-filter-group">
            <button class="book-filter-toggle" type="button" data-target="bookFilterSizes">
              Size <span>▾</span>
            </button>
            <div class="book-filter-options" id="bookFilterSizes">
              <label><input type="checkbox" value="Compact"> Compact</label>
              <label><input type="checkbox" value="Classic"> Classic</label>
              <label><input type="checkbox" value="Large"> Large</label>
            </div>
          </div>

          <div class="book-filter-actions">
            <button class="book-filter-clear" type="button" id="bookFilterClear">Clear</button>
            <button class="book-filter-apply" type="button" id="bookFilterApply">Apply</button>
          </div>
        </div>
      </div>

      <div class="art-filter-modal" id="artFilterModal" aria-hidden="true">
        <div class="art-filter-card">
          <div class="art-filter-head">
            <div class="art-filter-title">Filter &amp; Sort</div>
            <button class="art-filter-close" type="button" id="artFilterClose" aria-label="Close">×</button>
          </div>

          <div class="art-filter-row">
            <label for="artSortSelect">Sort by:</label>
            <select id="artSortSelect">
              <option value="featured">Featured</option>
              <option value="title-asc">Title: A–Z</option>
              <option value="year-asc">Year: Oldest First</option>
              <option value="year-desc">Year: Newest First</option>
            </select>
          </div>

          <div class="art-filter-group">
            <button class="art-filter-toggle" type="button" data-target="artFilterTypes">
              Type <span>â–¾</span>
            </button>
            <div class="art-filter-options" id="artFilterTypes">
              <label><input type="checkbox" value="art"> Artwork</label>
              <label><input type="checkbox" value="sculpture"> Sculpture</label>
            </div>
          </div>

          <div class="art-filter-group">
            <button class="art-filter-toggle" type="button" data-target="artFilterArtists">
              Artists <span>▾</span>
            </button>
            <div class="art-filter-options" id="artFilterArtists">
              <label><input type="checkbox" value="Roberto Ferruzzi"> Roberto Ferruzzi</label>
              <label><input type="checkbox" value="Caspar David Friedrich"> Caspar David Friedrich</label>
              <label><input type="checkbox" value="Vincent van Gogh"> Vincent van Gogh</label>
              <label><input type="checkbox" value="Rembrandt van Rijn"> Rembrandt van Rijn</label>
              <label><input type="checkbox" value="Claude Monet"> Claude Monet</label>
              <label><input type="checkbox" value="Michelangelo Buonarroti"> Michelangelo Buonarroti</label>
              <label><input type="checkbox" value="Unknown Roman"> Unknown Roman</label>
              <label><input type="checkbox" value="Jon Hicks"> Jon Hicks</label>
              <label><input type="checkbox" value="Unknown Hellenistic"> Unknown Hellenistic</label>
            </div>
          </div>

          <div class="art-filter-group">
            <button class="art-filter-toggle" type="button" data-target="artFilterPeriods">
              Periods <span>▾</span>
            </button>
            <div class="art-filter-options" id="artFilterPeriods">
              <label><input type="checkbox" value="Baroque"> Baroque</label>
              <label><input type="checkbox" value="Romanticism"> Romanticism</label>
              <label><input type="checkbox" value="Impressionism"> Impressionism</label>
              <label><input type="checkbox" value="Post-Impressionism"> Post-Impressionism</label>
              <label><input type="checkbox" value="19th Century"> 19th Century</label>
              <label><input type="checkbox" value="Renaissance"> Renaissance</label>
              <label><input type="checkbox" value="Roman"> Roman</label>
              <label><input type="checkbox" value="Classical"> Classical</label>
              <label><input type="checkbox" value="Hellenistic"> Hellenistic</label>
            </div>
          </div>

          <div class="art-filter-group">
            <button class="art-filter-toggle" type="button" data-target="artFilterMedia">
              Medium <span>▾</span>
            </button>
            <div class="art-filter-options" id="artFilterMedia">
              <label><input type="checkbox" value="Oil on Canvas"> Oil on Canvas</label>
              <label><input type="checkbox" value="Marble"> Marble</label>
              <label><input type="checkbox" value="Bronze"> Bronze</label>
            </div>
          </div>

          <div class="art-filter-actions">
            <button class="art-filter-clear" type="button" id="artFilterClear">Clear</button>
            <button class="art-filter-apply" type="button" id="artFilterApply">Apply</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ARTISTS -->
    <section id="sect-artists" class="app-section">
      <div class="section-scroll">
        <div class="artists-head">
          <button class="btn-back" id="artistsBackBtn">&larr; Back to Gallery</button>
          <div class="artists-hero">
            <div>
              <div class="artists-kicker">Curated Artists</div>
              <h1 class="artists-title">Artists</h1>
              <p class="artists-sub">Explore the creators behind the collection and discover three featured products from each artist.</p>
              <div class="artists-meta">
                <div class="artists-meta-item"><strong id="artistsCount">0</strong><span>Artists</span></div>
                <div class="artists-meta-item"><strong id="artistsWorksCount">0</strong><span>Works</span></div>
                <div class="artists-meta-item"><strong id="artistsProductsCount">0</strong><span>Featured Products</span></div>
              </div>
            </div>
            <div class="artists-hero-panel">
              <p class="artists-hero-note">Hand-picked creators across design, painting, and sculpture. Open a profile for a quick summary and featured works.</p>
              <div class="artists-hero-tags">
                <span>Design</span>
                <span>Painting</span>
                <span>Sculpture</span>
                <span>Modern</span>
              </div>
            </div>
          </div>
        </div>
        <div class="artists-grid" id="artistsGrid"></div>
      </div>
    </section>

    <!-- ARTIST DETAIL -->
    <section id="sect-artist-detail" class="app-section">
      <div class="section-scroll">
        <div class="artist-detail-head">
          <button class="btn-back" id="artistDetailBack">&larr; Back to Artists</button>
        </div>
        <div class="artist-hero">
          <div class="artist-hero-media"><img id="artistDetailImg" src="" alt="Artist portrait"></div>
          <div>
            <div class="artist-hero-name" id="artistDetailName">Artist</div>
            <div class="artist-hero-role" id="artistDetailRole">Artist</div>
            <p class="artist-hero-bio" id="artistDetailBio">Artist summary.</p>
          </div>
        </div>
        <div class="artist-meta-grid">
          <div class="artist-meta-card"><span>Focus</span><strong id="artistDetailFocus">Artist</strong></div>
          <div class="artist-meta-card"><span>Total Works</span><strong id="artistWorksCount">0 works</strong></div>
          <div class="artist-meta-card"><span>Featured Products</span><strong>3 items</strong></div>
        </div>
        <div class="artist-works-head">
          <div class="artist-works-title">Featured Products</div>
          <div class="artist-works-count">Curated 3 items</div>
        </div>
        <div class="artist-products-grid" id="artistProductsGrid"></div>
        <div class="artist-works-head">
          <div class="artist-works-title">All Works</div>
          <div class="artist-works-count" id="artistWorksCountLabel">0 works</div>
        </div>
        <div class="artist-works-grid" id="artistWorksGrid"></div>
      </div>
    </section>

    <!-- ADMIN -->
    <section id="sect-admin" class="app-section">
      <div class="section-scroll">
        <div class="admin-wrap">
          <div class="admin-head">
            <a class="btn btn-ghost admin-mini-btn" href="index.html">← Back to Website</a>
            <h1 class="sec-title">Admin Panel</h1>
            <p class="sec-sub">Manage products, upload images/models, and keep filters aligned with Art, Designs, Books, and Sculptures.</p>
          </div>

          <div class="admin-auth" id="adminAuthCard">
            <div class="admin-card-title">Admin Access</div>
            <p class="admin-note">Sign in with your admin email and password to unlock product management.</p>
            <div class="admin-grid">
              <div class="form-group">
                <input type="email" class="form-input" id="adminEmail" placeholder="Admin Email" value="anaskaroti@gmail.com" />
              </div>
              <div class="form-group">
                <input type="password" class="form-input" id="adminPassword" placeholder="Admin Password" autocomplete="current-password" />
              </div>
              <button class="btn-submit admin-auth-btn" id="adminLoginBtn" type="button">Login</button>
            </div>
            <div class="admin-status" id="adminAuthStatus">Not signed in</div>
          </div>

          <div class="admin-panel" id="adminPanel" hidden>
            <div class="admin-toolbar">
              <div class="admin-toolbar-left">
                <button class="btn btn-ghost admin-mini-btn" id="adminRefreshBtn" type="button">Refresh</button>
                <button class="btn btn-ghost admin-mini-btn" id="adminSeedBtn" type="button">Seed Current Products</button>
              </div>
              <div class="admin-toolbar-right">
                <span class="admin-user" id="adminUserEmail">Signed in</span>
                <button class="btn btn-ghost admin-mini-btn" id="adminLogoutBtn" type="button">Logout</button>
              </div>
            </div>

            <div class="admin-layout">
              <aside class="admin-list-card">
                <div class="admin-list-head">
                  <div class="admin-card-title">Products</div>
                  <button class="btn btn-ghost admin-mini-btn" id="adminNewProductBtn" type="button">New Product</button>
                </div>
                <div class="admin-filter-row">
                  <select id="adminTypeFilter" class="form-input">
                    <option value="all">All Categories</option>
                    <option value="art">Art</option>
                    <option value="furniture">Designs</option>
                    <option value="books">Books</option>
                    <option value="sculpture">Sculpture</option>
                  </select>
                </div>
                <div class="admin-list" id="adminProductList"></div>
              </aside>

              <section class="admin-form-card">
                <div class="admin-card-title">Product Editor</div>
                <div class="admin-form" id="adminProductForm">
                  <input type="hidden" id="adminProductId" />
                  <div class="admin-grid two">
                    <div class="form-group"><input class="form-input" id="adminName" placeholder="Product Name" /></div>
                    <div class="form-group">
                      <select id="adminGalleryType" class="form-input">
                        <option value="art">Art</option>
                        <option value="furniture">Designs</option>
                        <option value="books">Books</option>
                        <option value="sculpture">Sculpture</option>
                      </select>
                    </div>
                  </div>
                  <div class="admin-grid two" id="adminArtTypeRow" hidden>
                    <div class="form-group">
                      <select id="adminArtType" class="form-input">
                        <option value="art">Artwork</option>
                        <option value="sculpture">Sculpture</option>
                      </select>
                    </div>
                  </div>

                  <div class="admin-grid two">
                    <div class="form-group"><input class="form-input" id="adminCategory" placeholder="Category (cabinet, sideboard, ...)" /></div>
                    <div class="form-group"><input class="form-input" id="adminSortOrder" type="number" placeholder="Sort Order" value="0" /></div>
                  </div>

                  <div class="admin-grid three">
                    <div class="form-group"><input class="form-input" id="adminArtistName" placeholder="Artist Name" /></div>
                    <div class="form-group"><input class="form-input" id="adminArtistRole" placeholder="Artist Role" /></div>
                    <div class="form-group"><input class="form-input" id="adminArtistImageUrl" placeholder="Artist Image URL" /></div>
                  </div>
                  <div class="form-group"><textarea class="form-input" id="adminArtistBio" placeholder="Artist Bio" rows="3"></textarea></div>

                  <div class="admin-grid two">
                    <div class="form-group"><input class="form-input" id="adminCoverImageUrl" placeholder="Cover Image URL" /></div>
                    <div class="form-group"><input class="form-input" id="adminModelUrl" placeholder="3D Model URL (.glb/.gltf)" /></div>
                  </div>
                  <div class="admin-grid two">
                    <div class="form-group"><input class="form-input" id="adminCoverUpload" type="file" accept="image/*" /></div>
                    <div class="form-group"><input class="form-input" id="adminModelUpload" type="file" accept=".glb,.gltf,model/gltf-binary,model/gltf+json" /></div>
                  </div>

                  <div class="form-group">
                    <textarea class="form-input" id="adminImagesInput" placeholder="Extra image URLs (one per line)" rows="4"></textarea>
                  </div>
                  <div class="form-group">
                    <input class="form-input" id="adminImagesUpload" type="file" accept="image/*" multiple />
                  </div>

                  <div class="admin-type-grid" id="adminBooksFields">
                    <div class="admin-type-title">Book Fields</div>
                    <div class="admin-grid three">
                      <div class="form-group"><input class="form-input" id="adminTheme" placeholder="Theme" /></div>
                      <div class="form-group"><input class="form-input" id="adminColor" placeholder="Color" /></div>
                      <div class="form-group"><input class="form-input" id="adminSize" placeholder="Size" /></div>
                    </div>
                    <div class="admin-grid two">
                      <div class="form-group"><input class="form-input" id="adminTag" placeholder="Tag" /></div>
                      <div class="form-group"><input class="form-input" id="adminKicker" placeholder="Kicker" /></div>
                    </div>
                  </div>

                  <div class="admin-type-grid" id="adminFurnitureFields">
                    <div class="admin-type-title">Design Fields</div>
                    <div class="admin-grid two">
                      <div class="form-group"><input class="form-input" id="adminMaterial" placeholder="Material" /></div>
                      <div class="form-group"><input class="form-input" id="adminDimensions" placeholder="Dimensions (e.g. 120x60x90)" /></div>
                    </div>
                    <div class="admin-grid three">
                      <div class="form-group"><input class="form-input" id="adminStoreName" placeholder="Store Name" /></div>
                      <div class="form-group"><input class="form-input" id="adminStoreLng" type="number" step="0.000001" placeholder="Store Longitude" /></div>
                      <div class="form-group"><input class="form-input" id="adminStoreLat" type="number" step="0.000001" placeholder="Store Latitude" /></div>
                    </div>
                  </div>

                  <div class="admin-type-grid" id="adminArtFields">
                    <div class="admin-type-title">Art/Sculpture Fields</div>
                    <div class="admin-grid three">
                      <div class="form-group"><input class="form-input" id="adminMedium" placeholder="Medium" /></div>
                      <div class="form-group"><input class="form-input" id="adminPeriod" placeholder="Period" /></div>
                      <div class="form-group"><input class="form-input" id="adminArtMaterial" placeholder="Material" /></div>
                    </div>
                    <div class="admin-grid three">
                      <div class="form-group"><input class="form-input" id="adminEra" placeholder="Era" /></div>
                      <div class="form-group"><input class="form-input" id="adminYear" type="number" placeholder="Year" /></div>
                      <div class="form-group"><input class="form-input" id="adminRating" type="number" step="0.1" placeholder="Rating" /></div>
                    </div>
                    <div class="admin-grid two">
                      <div class="form-group"><input class="form-input" id="adminRatingCount" placeholder="Rating Count (e.g. 50+)" /></div>
                      <div class="form-group"><input class="form-input" id="adminBasePrice" type="number" placeholder="Base Price" /></div>
                    </div>
                  </div>

                  <div class="admin-actions">
                    <button class="btn-submit" id="adminSaveBtn" type="button">Save Product</button>
                    <button class="btn btn-ghost admin-danger" id="adminDeleteBtn" type="button">Delete Product</button>
                  </div>
                  <div class="admin-status" id="adminSaveStatus">Ready</div>
                </div>
              </section>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="sect-contact" class="app-section">
      <div class="section-scroll">
        <h1 class="sec-title">Get in Touch</h1>
        <p class="sec-sub">Interested in a piece? Let us know.</p>

        <form id="ajaxForm" action="https://formsubmit.co/anaskaroti@gmail.com" method="POST">
          <input type="hidden" name="_captcha" value="false">
          <input type="hidden" name="_template" value="table">

          <div class="form-group"><input type="text" class="form-input" name="name" placeholder="Your Name" required></div>
          <div class="form-group"><input type="email" class="form-input" name="email" placeholder="Your Email" required></div>
          <div class="form-group"><input type="text" class="form-input" name="subject" placeholder="Subject" id="formSubject"></div>
          <div class="form-group"><textarea class="form-input" name="message" placeholder="Message..." rows="4"></textarea></div>

          <button type="submit" class="btn-submit" id="formSubmitBtn">Send Inquiry</button>
        </form>

        <div id="formSuccess">Thank you! Your inquiry has been received.</div>

        <footer class="site-footer">
          <div class="ft-top">
            <div class="ft-brand">FNN ART</div>
            <div class="ft-note">
              A modern art platform specializing in the presentation of original artworks by selected artists—connecting creative expression with audiences and institutions.
            </div>
          </div>

          <div class="ft-grid">
            <div>
              <div class="ft-title">Contact us</div>
              <div class="ft-text">
                anaskaroti@gmail.com<br>
              </div>
            </div>

            <div class="ft-links">
              <div class="ft-title">Navigation</div>
              <a href="#" onclick="switchSection('sect-home'); return false;">Home</a>
              <a href="#" onclick="switchSection('sect-about'); return false;">About</a>
              <a href="#" onclick="switchSection('sect-services'); return false;">Services</a>
              <a href="#" onclick="switchSection('sect-gallery'); return false;">Gallery</a>
              <a href="#" onclick="switchSection('sect-contact'); return false;">Contact</a>
            </div>

            <div class="ft-social">
              <div class="ft-title">Follow us</div>
              <a href="#" onclick="return false;"><span class="ft-ic">◎</span>@fnn</a>
              <a href="#" onclick="return false;"><span class="ft-ic">f</span>@fnn</a>
              <a href="#" onclick="return false;"><span class="ft-ic">in</span>@fnn</a>
              <a href="#" onclick="return false;"><span class="ft-ic">▶</span>@fnn</a>
            </div>
          </div>

          <div class="ft-copy">© 2025 FNN ART. All rights reserved.</div>
        </footer>
      </div>
    </section>

  </aside>
</div>

<div class="modal-overlay" id="modalArtistOverlay">
  <div class="modal-box" style="position:relative">
    <button class="close-modal" id="closeArtistModal">×</button>
    <div style="text-align:center; margin-bottom:18px;">
      <div style="width:82px;height:82px;border-radius:50%;overflow:hidden;margin:0 auto 14px;">
        <img id="modalArtistImg" src="" alt="" style="width:100%;height:100%;object-fit:cover;">
      </div>
      <h3 id="modalArtistName" style="margin:0 0 6px; font-weight:950;"></h3>
      <span id="modalArtistRole" style="font-size:12px; color:#999; text-transform:uppercase; letter-spacing:0.08em;"></span>
    </div>
    <p id="modalArtistBio" style="font-size:13px; line-height:1.7; color:#555; text-align:center; margin:0;"></p>
  </div>
</div>

<script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://api.mapbox.com/mapbox-gl-js/v3.7.0/mapbox-gl.js"></script>

<script>
  const MAPBOX_TOKEN = "pk.eyJ1IjoiYW5hc2thcm90aSIsImEiOiJjbWhqcHgwcmMwbWM0MmxwZ2V5Z2x5OTN0In0.bpOf-4BsljExZdYZUak_pw";
  const USER_STYLE = "mapbox://styles/anaskaroti/cmhuiic1f00ft01qucn91gk6e";
  const SUPABASE_URL = "https://ynlbfuifmemekyixkpdw.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlubGJmdWlmbWVtZWt5aXhrcGR3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExNjA4MzksImV4cCI6MjA4NjczNjgzOX0.1-plxceE3gIPZQ7qo245PKeTMV6lXa1H1ExZ0qMalsc";
  const DEFAULT_ADMIN_EMAIL = "anaskaroti@gmail.com";
  const supabaseClient = (window.supabase && SUPABASE_URL && SUPABASE_ANON_KEY)
    ? window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
    : null;

  const isAdminOnlyPage = document.body.classList.contains("admin-page");
  const isMobile = window.innerWidth < 900;
  const startZoom = isMobile ? 0 : 0.8;
  const createMapStub = () => ({
    on: () => {},
    once: () => {},
    flyTo: () => {},
    getBearing: () => 0,
    getStyle: () => ({ layers: [] }),
    getLayer: () => null,
    getSource: () => null,
    setFog: () => {},
    addLayer: () => {}
  });
  let map = createMapStub();

  if(!isAdminOnlyPage){
    mapboxgl.accessToken = MAPBOX_TOKEN;
    map = new mapboxgl.Map({
      container: "map",
      style: USER_STYLE,
      center: [0, 20],
      zoom: startZoom,
      pitch: 0,
      projection: 'globe'
    });

    map.on('style.load', () => {
      try {
        map.setFog({
          'color': 'rgb(255, 255, 255)',
          'high-color': 'rgb(200, 200, 200)',
          'space-color': 'rgb(0, 0, 0)',
          'star-intensity': 0.6
        });
      } catch(e){}

      const layers = (map.getStyle() && map.getStyle().layers) || [];
      let labelLayerId;
      for (const layer of layers) {
        if (layer.type === 'symbol' && layer.layout && layer.layout['text-field']) {
          labelLayerId = layer.id;
          break;
        }
      }

      const hasCompositeSource = !!map.getSource('composite');
      if (hasCompositeSource && !map.getLayer('3d-buildings-custom')) {
        try{
          map.addLayer({
            'id': '3d-buildings-custom',
            'source': 'composite',
            'source-layer': 'building',
            'filter': ['==', 'extrude', 'true'],
            'type': 'fill-extrusion',
            'minzoom': 15,
            'paint': {
              'fill-extrusion-color': '#aaa',
              'fill-extrusion-height': ['get', 'height'],
              'fill-extrusion-base': ['get', 'min_height'],
              'fill-extrusion-opacity': 0.6
            }
          }, labelLayerId);
        } catch(e){}
      }
    });
  }

  window.switchSection = function(id){
    document.querySelectorAll('.app-section').forEach(s => s.classList.remove('active-section'));
    const target = document.getElementById(id);
    if(target) target.classList.add('active-section');

    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    const navIdMap = {
      'sect-home':'navHome',
      'sect-about':'navAbout',
      'sect-services':'navServices',
      'sect-gallery':'navGallery',
      'sect-artists':'navGallery',
      'sect-artist-detail':'navGallery',
      'sect-contact':'navContact',
      'sect-admin':'navAdmin'
    };
    const mNavIdMap = {
      'sect-home':'mNavHome',
      'sect-about':'mNavAbout',
      'sect-services':'mNavServices',
      'sect-gallery':'mNavGallery',
      'sect-artists':'mNavGallery',
      'sect-artist-detail':'mNavGallery',
      'sect-contact':'mNavContact',
      'sect-admin':'mNavAdmin'
    };

    const navEl = document.getElementById(navIdMap[id]);
    if(navEl) navEl.classList.add('active');
    const mNavEl = document.getElementById(mNavIdMap[id]);
    if(mNavEl) mNavEl.classList.add('active');

    if(rotationFrame){ cancelAnimationFrame(rotationFrame); rotationFrame=null; }
    if(currentMarker){ currentMarker.remove(); currentMarker=null; }
    hideMap3D();
    map.flyTo({ center:[0,20], zoom:startZoom, pitch:0, bearing:0, duration:1800 });

    if(id === 'sect-services'){
      requestAnimationFrame(() => { setupProcessAnimation(); });
    }
  };

  const safeAdd = (id, ev, handler) => {
    const el = document.getElementById(id);
    if(el) el.addEventListener(ev, handler);
  };

  safeAdd('navHome','click',() => switchSection('sect-home'));
  safeAdd('navAbout','click',() => switchSection('sect-about'));
  safeAdd('navServices','click',() => switchSection('sect-services'));
  safeAdd('navGallery','click',() => switchSection('sect-gallery'));
  safeAdd('navContact','click',() => switchSection('sect-contact'));
  safeAdd('navAdmin','click',() => switchSection('sect-admin'));

  safeAdd('mNavHome','click',() => switchSection('sect-home'));
  safeAdd('mNavAbout','click',() => switchSection('sect-about'));
  safeAdd('mNavServices','click',() => switchSection('sect-services'));
  safeAdd('mNavGallery','click',() => switchSection('sect-gallery'));
  safeAdd('mNavContact','click',() => switchSection('sect-contact'));
  safeAdd('mNavAdmin','click',() => switchSection('sect-admin'));
  safeAdd('galleryArtistsLink','click',() => {
    renderArtists();
    switchSection('sect-artists');
  });
  safeAdd('artistsBackBtn','click',() => switchSection('sect-gallery'));
  safeAdd('artistDetailBack','click',() => switchSection('sect-artists'));
  safeAdd('adminNewProductBtn','click',() => clearAdminForm());
  safeAdd('adminRefreshBtn','click',async () => {
    await loadAdminRows();
    await loadCatalogFromSupabase();
    rerenderVisibleCollections();
  });
  safeAdd('adminSeedBtn','click',seedSupabaseFromFallback);
  safeAdd('adminSaveBtn','click',saveAdminProduct);
  safeAdd('adminDeleteBtn','click',async () => {
    if(!adminSelectedId){
      setAdminSaveStatus("Select a product first", true);
      return;
    }
    await deleteAdminProduct(adminSelectedId);
  });
  safeAdd('adminLoginBtn','click',async () => {
    if(!supabaseClient){
      setAdminAuthStatus("Supabase client not available", true);
      return;
    }
    const email = getAdminInputValue(adminEmail) || DEFAULT_ADMIN_EMAIL;
    const password = getAdminInputValue(adminPassword);
    if(!password){
      setAdminAuthStatus("Enter your password", true);
      return;
    }
    const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });
    if(error){
      setAdminAuthStatus(`Login failed: ${error.message}`, true);
      return;
    }
    await handleAdminSession(data ? data.session : null);
    setAdminAuthStatus("Logged in", false);
  });
  safeAdd('adminLogoutBtn','click',async () => {
    if(!supabaseClient) return;
    let { error } = await supabaseClient.auth.signOut({ scope:"global" });
    if(error){
      const fallback = await supabaseClient.auth.signOut({ scope:"local" });
      error = fallback.error || null;
    }
    if(error){
      setAdminAuthStatus(`Logout failed: ${error.message}`, true);
      return;
    }
    adminSession = null;
    adminAuthorized = false;
    adminRows = [];
    adminSelectedId = null;
    renderAdminProductList();
    updateAdminViewState();
    setAdminAuthStatus("Signed out", false);
    if(adminPassword) adminPassword.value = "";
    clearAdminForm();
  });
  safeAdd('adminEmail','keydown',(e) => {
    if(e.key !== "Enter") return;
    const btn = document.getElementById("adminLoginBtn");
    if(btn) btn.click();
  });
  safeAdd('adminPassword','keydown',(e) => {
    if(e.key !== "Enter") return;
    const btn = document.getElementById("adminLoginBtn");
    if(btn) btn.click();
  });

  const adminGalleryTypeEl = document.getElementById("adminGalleryType");
  if(adminGalleryTypeEl) adminGalleryTypeEl.addEventListener("change", setAdminFieldVisibility);
  const adminTypeFilterEl = document.getElementById("adminTypeFilter");
  if(adminTypeFilterEl) adminTypeFilterEl.addEventListener("change", renderAdminProductList);

  const homeSliderTrack = document.querySelector('.home-illustration-track');
  const homeSliderDots = document.getElementById('homeSliderDots');
  const homeSliderArrows = document.querySelector('.home-slider-arrows');
  const getHomeSlideStep = () => {
    if(!homeSliderTrack) return 0;
    const slide = homeSliderTrack.querySelector('.home-slide');
    const base = slide ? slide.getBoundingClientRect().width : homeSliderTrack.clientWidth;
    const style = getComputedStyle(homeSliderTrack);
    const gap = parseFloat(style.columnGap || style.gap || "0") || 0;
    return base + gap;
  };
  const scrollHomeSlider = (dir) => {
    if(!homeSliderTrack) return;
    const step = getHomeSlideStep();
    if(!step) return;
    homeSliderTrack.scrollBy({ left: dir * step, behavior:'smooth' });
  };
  const setHomeActiveDot = () => {
    if(!homeSliderDots || !homeSliderTrack) return;
    const dots = Array.from(homeSliderDots.querySelectorAll('.home-dot'));
    if(!dots.length) return;
    const step = getHomeSlideStep();
    if(!step) return;
    const idx = Math.max(0, Math.min(dots.length - 1, Math.round(homeSliderTrack.scrollLeft / step)));
    dots.forEach((dot, i) => dot.classList.toggle('active', i === idx));
  };

  if(homeSliderTrack && homeSliderDots){
    homeSliderDots.addEventListener('click', (e) => {
      const btn = e.target.closest('.home-dot');
      if(!btn) return;
      const idx = Number(btn.dataset.index || 0);
      const step = getHomeSlideStep();
      if(!step) return;
      homeSliderTrack.scrollTo({ left: idx * step, behavior:'smooth' });
    });

    let dotRaf = null;
    homeSliderTrack.addEventListener('scroll', () => {
      if(dotRaf) return;
      dotRaf = requestAnimationFrame(() => {
        dotRaf = null;
        setHomeActiveDot();
      });
    }, { passive:true });
  }
  if(homeSliderTrack && homeSliderArrows){
    homeSliderArrows.addEventListener('click', (e) => {
      const btn = e.target.closest('.home-arrow');
      if(!btn) return;
      const dir = Number(btn.dataset.dir || 0);
      if(!dir) return;
      scrollHomeSlider(dir);
    });
  }
  if(homeSliderTrack){
    setInterval(() => {
      const homeSection = document.getElementById('sect-home');
      if(!homeSection || !homeSection.classList.contains('active-section')) return;
      const atEnd = homeSliderTrack.scrollLeft + homeSliderTrack.clientWidth >= homeSliderTrack.scrollWidth - 4;
      if(atEnd){
        homeSliderTrack.scrollTo({ left:0, behavior:'smooth' });
      } else {
        scrollHomeSlider(1);
      }
    }, 4000);
  }

  const form = document.getElementById('ajaxForm');
  const submitBtn = document.getElementById('formSubmitBtn');
  const successMsg = document.getElementById('formSuccess');

  if(form){
    form.addEventListener('submit', function(e){
      e.preventDefault();
      if(submitBtn){ submitBtn.textContent="Sending..."; submitBtn.style.opacity="0.7"; }
      fetch(form.action, { method:"POST", body:new FormData(form), headers:{ 'Accept':'application/json' } })
      .then(res => {
        if(res.ok){
          form.style.display="none";
          if(successMsg) successMsg.style.display="block";
        } else {
          alert("Oops! Problem submitting.");
          if(submitBtn) submitBtn.textContent="Try Again";
        }
      })
      .catch(() => {
        alert("Oops! Problem submitting.");
        if(submitBtn) submitBtn.textContent="Try Again";
      });
    });
  }

  let currentMarker = null;
  let rotationFrame = null;
  let modelSyncFrame = null;
  let activePopupProduct = null;

  const map3dPopup = document.getElementById('map3dPopup');
  const map3dInner = document.getElementById('map3dInner');

  function hideMap3D(){
    if(modelSyncFrame){ cancelAnimationFrame(modelSyncFrame); modelSyncFrame=null; }
    if(map3dInner) map3dInner.innerHTML = "";
    if(map3dPopup) map3dPopup.classList.remove('show');
    activePopupProduct = null;
  }

  function showMap3D(product){
    if(!product || !product.model) return;
    activePopupProduct = product;

    const safeUrl = (product.model || "")
      .replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/ /g,'%20');

    if(map3dInner){
      map3dInner.innerHTML = `
        <model-viewer
          id="popupViewer"
          src="${safeUrl}"
          camera-controls
          interaction-prompt="none"
          shadow-intensity="1"
          environment-image="neutral"
          style="background:transparent;"
          alt="${product.name || '3D'}">
        </model-viewer>
      `;
    }
    if(map3dPopup) map3dPopup.classList.add('show');

    const viewer = document.getElementById('popupViewer');
    if(!viewer) return;

    let userIsInteracting = false;
    let userThetaOffsetDeg = 0;
    let userPhiDeg = 75;
    let userRadius = '4.5m';
    const baseHeadingDeg = 45;

    const parseOrbit = (orbit) => {
      if(!orbit || typeof orbit !== 'string') return null;
      const m = orbit.trim().match(/^(-?\d*\.?\d+)(deg|rad)\s+(-?\d*\.?\d+)(deg|rad)\s+([^\s]+)$/);
      if(!m) return null;
      const toDeg = (v, unit) => unit === 'rad' ? (parseFloat(v) * (180 / Math.PI)) : parseFloat(v);
      return { thetaDeg: toDeg(m[1], m[2]), phiDeg: toDeg(m[3], m[4]), radius: m[5] };
    };

    const captureUserOrbit = () => {
      const o = parseOrbit(viewer.cameraOrbit);
      if(!o) return;
      userPhiDeg = o.phiDeg;
      userRadius = o.radius;
      userThetaOffsetDeg = o.thetaDeg - (map.getBearing() + baseHeadingDeg);
    };

    viewer.addEventListener('pointerdown', () => { userIsInteracting = true; }, { passive:true });
    const endInteraction = () => { userIsInteracting = false; captureUserOrbit(); };
    viewer.addEventListener('pointerup', endInteraction, { passive:true });
    viewer.addEventListener('pointercancel', endInteraction, { passive:true });
    viewer.addEventListener('lostpointercapture', endInteraction, { passive:true });

    // ✅ Keep BOX fixed, rotate MODEL inside based on map bearing (and fix “contrary direction” by inverting)
    const sync = () => {
      if(!activePopupProduct) return;
      if(!userIsInteracting){
        const b = map.getBearing(); // Mapbox bearing increases clockwise
        const az = (b + baseHeadingDeg + userThetaOffsetDeg);
        viewer.cameraOrbit = `${az}deg ${userPhiDeg}deg ${userRadius}`;
      }
      modelSyncFrame = requestAnimationFrame(sync);
    };
    if(modelSyncFrame){ cancelAnimationFrame(modelSyncFrame); modelSyncFrame=null; }
    sync();
  }

  function gotoStore(store, productFor3D){
    if(!store) return;

    // stop loops
    if(rotationFrame){ cancelAnimationFrame(rotationFrame); rotationFrame=null; }
    if(modelSyncFrame){ cancelAnimationFrame(modelSyncFrame); modelSyncFrame=null; }

    // hide popup until zoom finished
    hideMap3D();

    if(currentMarker) currentMarker.remove();

    const el = document.createElement('div');
    el.style.backgroundColor='#111';
    el.style.width='20px';
    el.style.height='20px';
    el.style.borderRadius='50%';
    el.style.border='2px solid white';

    currentMarker = new mapboxgl.Marker(el).setLngLat(store.coords).addTo(map);

    map.flyTo({
      center: store.coords,
      zoom: 16.5,
      pitch: 65,
      bearing: Math.random()*90,
      speed: 0.3,
      curve: 1.2,
      essential: true,
      duration: 9000
    });

    // ✅ show popup AFTER zoom finishes, then start map rotation + model sync
    map.once('moveend', () => {
      showMap3D(productFor3D);

      function rotate(){
        map.rotateTo((map.getBearing()+0.05)%360, { duration:0 });
        rotationFrame = requestAnimationFrame(rotate);
      }
      rotate();
    });
  }

  const DEFAULT_IMAGES = [
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca9c47857d958372698_Gemini_Generated_Image_yiit8eyiit8eyiit.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca9fd2fa99da51c575a_Gemini_Generated_Image_qrrx4iqrrx4iqrrx.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca9978004d5fa2a3d3a_Gemini_Generated_Image_6hnali6hnali6hna.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca9ff7c4713583ae7b5_Gemini_Generated_Image_im37uhim37uhim37.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca8c4a4dc0af86da352_Gemini_Generated_Image_rn5h5urn5h5urn5h.png",
    "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/693c1ca8c641d77b3de17010_Gemini_Generated_Image_mhci8mmhci8mmhci.png"
  ];

  const VIDEO_360 = "https://raw.githubusercontent.com/lwiise/3d-models/main/Product_Video_Generation_With_Rotation.mp4";
  const VIDEO_NORMAL = "https://raw.githubusercontent.com/lwiise/3d-models/main/Artistic_Video_Generation_Request.mp4";

  function buildMediaTabs(active){
    const tabs = [
      { key:'images', label:'Images' },
      { key:'v360', label:'360' },
      { key:'video', label:'Video' },
      { key:'d3', label:'3D' }
    ];
    return `
      <div class="media-tabs" id="mediaTabs">
        ${tabs.map(t => `
          <button class="media-tab ${t.key===active?'active':''}" data-tab="${t.key}">${t.label}</button>
        `).join('')}
      </div>
    `;
  }

  function renderImages(images){
    let idx = 0;
    const html = `
      <img id="imgSlide" src="${images[0]}" alt="Image" />
      <button class="img-arrow left" id="imgPrev">&lsaquo;</button>
      <button class="img-arrow right" id="imgNext">&rsaquo;</button>
    `;
    return { html, mount: (container) => {
      const img = container.querySelector('#imgSlide');
      const prev = container.querySelector('#imgPrev');
      const next = container.querySelector('#imgNext');
      const show = () => { if(img) img.src = images[idx]; };
      if(prev) prev.onclick = () => { idx = (idx - 1 + images.length) % images.length; show(); };
      if(next) next.onclick = () => { idx = (idx + 1) % images.length; show(); };
    }};
  }

  function render360(){
    const html = `
      <video id="v360" src="${VIDEO_360}" playsinline preload="metadata"></video>
      <div class="v360-ui">
        <button class="v360-btn" id="v360Toggle">II</button>
        <input class="v360-range" id="v360Range" type="range" min="0" max="1000" value="0" />
      </div>
    `;
    return { html, mount: (container) => {
      const v = container.querySelector('#v360');
      const btn = container.querySelector('#v360Toggle');
      const range = container.querySelector('#v360Range');
      if(!v || !btn || !range) return;
      v.controls = false;
      v.loop = true;
      v.muted = true;
      v.play().catch(()=>{});
      const syncRange = () => {
        if(!v.duration || !isFinite(v.duration)) return;
        range.value = Math.floor((v.currentTime / v.duration) * 1000);
      };
      v.addEventListener('timeupdate', syncRange);
      range.addEventListener('input', () => {
        if(!v.duration || !isFinite(v.duration)) return;
        const t = (parseInt(range.value,10)/1000) * v.duration;
        v.currentTime = t;
      });
      btn.addEventListener('click', () => {
        if(v.paused){
          v.play().catch(()=>{});
          btn.textContent = "II";
        }else{
          v.pause();
          btn.textContent = "▶";
        }
      });
    }};
  }

  function renderVideo(){
    const html = `<video src="${VIDEO_NORMAL}" controls playsinline preload="metadata"></video>`;
    return { html, mount: ()=>{} };
  }

  function render3D(modelUrl, fallbackImg, productName){
    const safeUrl = (modelUrl || "").replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/ /g,'%20');
    const html = `
      <model-viewer
        id="viewer3d"
        src="${safeUrl}"
        camera-controls
        auto-rotate
        shadow-intensity="1"
        style="background:transparent; width:100%; height:100%;"
        camera-orbit="45deg 75deg 4.5m"
        environment-image="neutral"
        alt="${productName || '3D'}">
      </model-viewer>
    `;
    return { html, mount: (container) => {
      const viewer = container.querySelector('#viewer3d');
      if(viewer){
        viewer.addEventListener('error', () => {
          container.innerHTML = `<img src="${fallbackImg}" alt="Fallback" />`;
        });
      }
    }};
  }

  function renderActiveMedia(p, tabKey){
    const soloMedia = document.getElementById("soloMedia");
    const soloTabs = document.getElementById("soloTabs");
    if(!soloMedia || !soloTabs) return;

    soloTabs.innerHTML = buildMediaTabs(tabKey);

    let pack;
    if(tabKey === 'images') pack = renderImages(p.images || DEFAULT_IMAGES);
    if(tabKey === 'v360') pack = render360();
    if(tabKey === 'video') pack = renderVideo();
    if(tabKey === 'd3') pack = render3D(p.model, (p.images && p.images[0]) ? p.images[0] : p.img, p.name);

    soloMedia.innerHTML = pack.html;
    pack.mount(soloMedia);

    attachTabHandlers(p);
  }

  function attachTabHandlers(p){
    const soloTabs = document.getElementById("soloTabs");
    if(!soloTabs) return;

    const tabs = soloTabs.querySelector('#mediaTabs');
    if(!tabs) return;

    if(tabs.dataset.bound === "1") return;
    tabs.dataset.bound = "1";

    tabs.addEventListener('click', (e) => {
      const btn = e.target.closest('.media-tab');
      if(!btn) return;
      const tab = btn.dataset.tab;
      renderActiveMedia(p, tab);
    });
  }

  // ✅ 12 products (kept)
  let PRODUCTS = [
    { id:"item-1", name:"Arch Cabinet", category:"cabinet", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a23d0fd8b7e2bc457_Screenshot_2025-11-23_141726-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/base%20(5).glb", specs:{ mat:"Velvet & Wood", dim:"120x60x90" }, store:{ name:"Milan Design District", coords:[9.1900,45.4642] }, artist:{ name:"Alessandro Rossi", role:"Art Director, Milano", img:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=100&q=80", bio:"Alessandro combines classical Italian joinery with bold, modern geometric forms." } },
    { id:"item-2", name:"Geometric Side", category:"sideboard", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a7e9f217180e18c6d_Screenshot_2025-11-23_142545-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/base%20%289%29.glb", specs:{ mat:"Lacquered Wood", dim:"180x50x200" }, store:{ name:"Paris Le Marais", coords:[2.3522,48.8566] }, artist:{ name:"Claire Dubois", role:"Sculptor, Paris", img:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?auto=format&fit=crop&w=100&q=80", bio:"Claire challenges the perception of stability with her organic, tree-like structures." } },
    { id:"item-3", name:"Art Deco Tall", category:"cabinet", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a3f4cd0cdf6848da0_Screenshot_2025-11-23_142423-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/base%20(7).glb", specs:{ mat:"Marble & Brass", dim:"220x80x95" }, store:{ name:"New York SoHo", coords:[-74.006,40.7128] }, artist:{ name:"Marcus Thorne", role:"Industrial Designer, NY", img:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=100&q=80", bio:"Marcus revives 1920s Art Deco aesthetics for the modern Manhattan loft." } },
    { id:"item-4", name:"Striped Console", category:"decor", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a8659147dcb3f38ed_Screenshot_2025-11-23_142604-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1763910785694_base%20(4).glb", specs:{ mat:"Resin & Paint", dim:"100x60x140" }, store:{ name:"Tokyo Harajuku", coords:[139.7034,35.6719] }, artist:{ name:"Kenji Sato", role:"Pop Artist, Tokyo", img:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=100&q=80", bio:"Kenji blurs the lines between collectible toys and functional high-end furniture." } },
    { id:"item-5", name:"Radiance Credenza", category:"sideboard", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a361104af2bd0614b_Screenshot_2025-11-23_142501-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/base%20(8).compressed.glb", specs:{ mat:"Ebony & Gold", dim:"200x55x85" }, store:{ name:"Dubai Design Dist", coords:[55.2962,25.2769] }, artist:{ name:"Zara Al-Fayed", role:"Luxury Artisan, Dubai", img:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=crop&w=100&q=80", bio:"Zara's work is a fusion of traditional Middle Eastern patterns and ultra-modern luxury." } },
    { id:"item-6", name:"Modular Unit", category:"decor", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a36286c4236e924d2_Screenshot_2025-11-23_142346-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/base%20%286%29.glb", specs:{ mat:"Ceramic Composite", dim:"120x120x120" }, store:{ name:"Copenhagen", coords:[12.5683,55.6761] }, artist:{ name:"Erik Jensen", role:"Minimalist, Copenhagen", img:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?auto=format&fit=crop&w=100&q=80", bio:"Erik believes in infinite adaptability. His modular systems grow with the user." } },
    { id:"item-7", name:"Lunar Chest", category:"cabinet", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620c47e4acac61094bf_Screenshot_2025-11-24_171517-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071266806_base%20(15).glb", specs:{ mat:"Oak & Silver", dim:"110x55x130" }, store:{ name:"London Tate Modern", coords:[-0.099,51.507] }, artist:{ name:"Oliver Sterling", role:"Modernist, London", img:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=100&q=80", bio:"Oliver explores celestial themes using industrial materials." } },
    { id:"item-8", name:"Obsidian Block", category:"sideboard", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620636bab60cf866e4e_Screenshot_2025-11-24_171459-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071270533_base%20(14).glb", specs:{ mat:"Blackened Steel", dim:"200x60x80" }, store:{ name:"Berlin Mitte", coords:[13.405,52.520] }, artist:{ name:"Klaus Weber", role:"Architect, Berlin", img:"https://images.unsplash.com/photo-1492562080023-ab3db95bfbce?auto=format&fit=crop&w=100&q=80", bio:"Klaus brings brutalist architecture principles into interior design." } },
    { id:"item-9", name:"Azure Tower", category:"cabinet", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620466eab1b5ac247c4_Screenshot_2025-11-24_171450-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071273205_base%20(13).glb", specs:{ mat:"Blue Lacquer", dim:"80x80x180" }, store:{ name:"Barcelona Eixample", coords:[2.168,41.387] }, artist:{ name:"Sofia Miró", role:"Colorist, Barcelona", img:"https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=100&q=80", bio:"Sofia's work is a vibrant homage to the Mediterranean spirit." } },
    { id:"item-10", name:"Solar Credenza", category:"sideboard", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/692486204f857514d1d4b590_Screenshot_2025-11-24_171432-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071348834_base%20(12).glb", specs:{ mat:"Teak & Brass", dim:"220x50x75" }, store:{ name:"Mexico City Polanco", coords:[-99.19,19.43] }, artist:{ name:"Diego Rivera", role:"Carpenter, CDMX", img:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=100&q=80", bio:"Diego fuses Aztec geometry with mid-century modern lines." } },
    { id:"item-11", name:"Nordic Wave", category:"decor", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620b770e284e36cee5d_Screenshot_2025-11-24_171419-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071190268_base%20(11).glb", specs:{ mat:"Ash Wood", dim:"140x40x90" }, store:{ name:"Stockholm Södermalm", coords:[18.068,59.329] }, artist:{ name:"Elina Vinter", role:"Designer, Stockholm", img:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?auto=format&fit=crop&w=100&q=80", bio:"Elina captures the fluidity of water in solid wood forms." } },
    { id:"item-12", name:"Crimson Vanity", category:"cabinet", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69248620cbc59348dc423f83_Screenshot_2025-11-24_171401-removebg-preview.png", model:"https://raw.githubusercontent.com/lwiise/3d-models/main/compressed_1764071194478_base%20(10).glb", specs:{ mat:"Red Velvet & Gold", dim:"100x50x150" }, store:{ name:"Seoul Gangnam", coords:[127.027,37.497] }, artist:{ name:"Min-Jun Kim", role:"Fashion Designer, Seoul", img:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=crop&w=100&q=80", bio:"Min-Jun treats furniture like haute couture, focusing on texture and drama." } }
  ];

  let BOOKS = [
    { id:"book-1", name:"Hajj and the Arts of Pilgrimage", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba2585301af28c70de99_hajj-and-the-arts-of-pilgrimage-assouline-2.jpg", theme:"Pilgrimage", color:"Warm", size:"Large", price:"$1,400 USD", priceValue:1400, tag:"Back in Stock", kicker:"The Ultimate Collection" },
    { id:"book-2", name:"St. Catherine's Monastery: Behind Sacred Doors", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba25efadf9246061f732_st-catherine-s-monastery-behind-sacred-doors-assouline-1.jpg", theme:"Heritage", color:"Cool", size:"Classic", price:"$980 USD", priceValue:980, tag:"New Arrival", kicker:"Sacred Places Series" },
    { id:"book-3", name:"Makkah", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba25d89ff47bf803d306_Makkah-IC_01_8fee0b8d-7690-4cfc-aed6-21495a0022f9.webp", theme:"Pilgrimage", color:"Warm", size:"Large", price:"$1,250 USD", priceValue:1250, tag:"Collector's Edition", kicker:"The Ultimate Collection" },
    { id:"book-4", name:"Qatar: Our Home", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba252ca2a04b62c99557_Qatar-Our-Home_02_00b26bd5-15cf-43d7-ba3c-f2016acea17b.webp", theme:"Culture", color:"Bold", size:"Classic", price:"$900 USD", priceValue:900, tag:"Limited Run", kicker:"Modern Heritage" },
    { id:"book-5", name:"Al Madinah", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba24df2d1dfd14a47e6a_AlMadinah-IC_01_b86a3bce-4fd0-4fe1-aa99-96c9a580ba2c.webp", theme:"Pilgrimage", color:"Cool", size:"Large", price:"$1,150 USD", priceValue:1150, tag:"Back in Stock", kicker:"The Ultimate Collection" },
    { id:"book-6", name:"Sheikh Zayed", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba24b670baf7a60642c9_Sheikh-Zayed_01_9d8b1f29-584d-4399-9379-4faf8eb4f2e7.webp", theme:"Architecture", color:"Neutral", size:"Classic", price:"$1,000 USD", priceValue:1000, tag:"Museum Edition", kicker:"Icons of Architecture" },
    { id:"book-7", name:"Wine & Travel: Mediterranean Islands", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba241771f110336e2c43_Wine_TravelMediterraneanIslands_Classic_01.webp", theme:"Travel", color:"Warm", size:"Compact", price:"$750 USD", priceValue:750, tag:"Traveler's Pick", kicker:"The Travel Desk" },
    { id:"book-8", name:"Uzbekistan: Masterpieces of the Silk Road", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba249f5080bcedbd67d7_Uzbekistan_Materpieces_of_the_Silk_Road_01.webp", theme:"Heritage", color:"Warm", size:"Classic", price:"$820 USD", priceValue:820, tag:"Collector's Choice", kicker:"The Silk Road Series" },
    { id:"book-9", name:"Mleiha: Ancient Treasures of the UAE", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba24e192b9193b952524_MLEIHA_Ancient_Treausures_of_the_UAE_Classic_01.webp", theme:"Heritage", color:"Neutral", size:"Classic", price:"$880 USD", priceValue:880, tag:"Featured", kicker:"Desert Histories" },
    { id:"book-10", name:"Greek Islands", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba24e443e5bee39a7878_greek-islands-assouline-1.jpg", theme:"Travel", color:"Cool", size:"Compact", price:"$720 USD", priceValue:720, tag:"Best Seller", kicker:"The Travel Desk" },
    { id:"book-11", name:"Sharjah: The Capital of Culture", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/697cba248e409ad226f097f9_SharjahTheCapitalofCulture_Classic001.webp", theme:"Culture", color:"Bold", size:"Classic", price:"$950 USD", priceValue:950, tag:"New Arrival", kicker:"Modern Heritage" }
  ];

  const BOOK_INFO = {
    note: "Enjoy complimentary shipping on select orders.",
    accordion: [
      {
        title:"Description",
        body:"A collectible volume featuring rich photography, archival imagery, and cultural essays that trace the story behind the destination."
      },
      {
        title:"Care instructions",
        body:"Keep in the dust jacket when not in use. Store away from direct sunlight and moisture to preserve the cover and pages."
      },
      {
        title:"Shipping, returns & exchanges",
        body:"Standard delivery in 3-5 business days. Returns accepted within 14 days in original condition. Exchanges are subject to availability."
      },
      {
        title:"Press",
        body:"Featured by international art and design publications for its photography, craftsmanship, and editorial direction."
      },
      {
        title:"About the author",
        body:"Written by a leading cultural historian with decades of experience documenting heritage, travel, and contemporary art."
      }
    ],
    accessories: [
      "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a23d0fd8b7e2bc457_Screenshot_2025-11-23_141726-removebg-preview.png",
      "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a7e9f217180e18c6d_Screenshot_2025-11-23_142545-removebg-preview.png",
      "https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6923267a361104af2bd0614b_Screenshot_2025-11-23_142501-removebg-preview.png"
    ]
  };

  const ART_INFO = {
    payNote:"",
    aboutTitle:"About Framed Art",
    aboutItems:[
      "High-quality art prints created with non-toxic, archival inks.",
      "Decorative white mat enhances the artwork while preserving longevity.",
      "Art is protected by clear acrylic that is lighter and more impact resistant.",
      "Hanging hardware comes affixed to each framed art piece."
    ]
  };

  const SCULPTURE_INFO = {
    payNote:"Pay in 4 interest-free payments. Learn more<br>Custom crating available on select sizes.",
    aboutTitle:"About Sculptures",
    aboutItems:[
      "Cast and finished by artisan studios with museum-grade materials.",
      "Protective coating resists UV and surface wear.",
      "Optional bases add stability and display versatility.",
      "Includes care instructions and authenticity documentation."
    ]
  };

  let ARTWORKS = [
    { id:"art-1", type:"art", sub:"Artwork", name:"Praying Girl (19th Century)", artist:"Roberto Ferruzzi", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69808d125a462d348c95595c_roberto-ferruzzi-praying-girl-italian-painting-of-19th-century_u-l-ptiifl0.jpg", rating:4.8, ratingCount:"50+", basePrice:32, year:1890, period:"19th Century", medium:"Oil on Canvas" },
    { id:"art-2", type:"art", sub:"Artwork", name:"Wanderer Above the Sea of Fog (1818)", artist:"Caspar David Friedrich", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69808d123128617c5399b765_caspar-david-friedrich-the-wanderer-above-the-sea-of-fog-1818_u-l-o29rl0.jpg", rating:4.9, ratingCount:"60+", basePrice:36, year:1818, period:"Romanticism", medium:"Oil on Canvas" },
    { id:"art-3", type:"art", sub:"Artwork", name:"Starry Night Over the Rhone (c. 1888)", artist:"Vincent van Gogh", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69808d1278b4e01616f679ea_vincent-van-gogh-starry-night-over-the-rhone-c-1888_u-l-o4jl10.jpg", rating:4.7, ratingCount:"40+", basePrice:34, year:1888, period:"Post-Impressionism", medium:"Oil on Canvas" },
    { id:"art-4", type:"art", sub:"Artwork", name:"The Storm on the Sea of Galilee", artist:"Rembrandt van Rijn", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69808d121b4490b3b755b3a4_rembrandt-van-rijn-the-storm-on-the-sea-of-galilee_u-l-q1h9yxy0.jpg", rating:4.6, ratingCount:"30+", basePrice:38, year:1633, period:"Baroque", medium:"Oil on Canvas" },
    { id:"art-5", type:"art", sub:"Artwork", name:"The Starry Night (June 1889)", artist:"Vincent van Gogh", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69808d1205b58982c0229dd3_vincent-van-gogh-the-starry-night-june-1889_u-l-q1qizd70.jpg", rating:5.0, ratingCount:"80+", basePrice:42, year:1889, period:"Post-Impressionism", medium:"Oil on Canvas" },
    { id:"art-6", type:"art", sub:"Artwork", name:"Impression, Sunrise (1872)", artist:"Claude Monet", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/69808d121c9587dfd8644b43_claude-monet-impression-sunrise-impression-soleil-levan-1872_u-l-ptohbt0.jpg", rating:4.7, ratingCount:"45+", basePrice:33, year:1872, period:"Impressionism", medium:"Oil on Canvas" }
  ];

  let SCULPTURES = [
    { id:"sculpt-1", type:"sculpture", sub:"Sculpture", name:"David", artist:"Michelangelo Buonarroti", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6980967c1857e82c35452c8e_michelangelo-buonarroti-david_u-l-puqrgp0.jpg", rating:4.9, ratingCount:"90+", basePrice:1200, year:1504, era:"Renaissance", material:"Marble", period:"Renaissance", medium:"Marble" },
    { id:"sculpt-2", type:"sculpture", sub:"Sculpture", name:"Marcus Aurelius", artist:"Unknown Roman", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6980967c614592d086fd92fa_marcus-aurelius-statue_u-l-q1074ct0.jpg", rating:4.7, ratingCount:"60+", basePrice:980, year:175, era:"Roman", material:"Bronze", period:"Roman", medium:"Bronze" },
    { id:"sculpt-3", type:"sculpture", sub:"Sculpture", name:"Plato at the Hellenic Academy", artist:"Jon Hicks", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6980967c4e4b28f77296cd98_jon-hicks-plato-statue-outside-the-hellenic-academy_u-l-pzrr0a0.jpg", rating:4.6, ratingCount:"40+", basePrice:860, year:1886, era:"Classical", material:"Marble", period:"Classical", medium:"Marble" },
    { id:"sculpt-4", type:"sculpture", sub:"Sculpture", name:"Winged Victory of Samothrace", artist:"Unknown Hellenistic", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6980967caf8971c9ac8a8950_victoire-de-samothrace_u-l-q1igl1h0.jpg", rating:4.8, ratingCount:"70+", basePrice:1400, year:190, era:"Hellenistic", material:"Marble", period:"Hellenistic", medium:"Marble" },
    { id:"sculpt-5", type:"sculpture", sub:"Sculpture", name:"Pietà", artist:"Michelangelo Buonarroti", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6980967c81c72c8235724d17_pieta-by-michelangelo-buonarroti_u-l-pzo61k0.jpg", rating:5.0, ratingCount:"120+", basePrice:1350, year:1499, era:"Renaissance", material:"Marble", period:"Renaissance", medium:"Marble" },
    { id:"sculpt-6", type:"sculpture", sub:"Sculpture", name:"Buste de Rome Casquée", artist:"Unknown Roman", img:"https://cdn.prod.website-files.com/6915e045b3e3d5a1e709a05d/6980967ce3345ac63325b131_buste-de-rome-casquee_u-l-q1kypts0.jpg", rating:4.5, ratingCount:"35+", basePrice:920, year:100, era:"Roman", material:"Marble", period:"Roman", medium:"Marble" }
  ];

  let ART_ITEMS = ARTWORKS.concat(SCULPTURES);

  function slugifyArtist(name){
    return (name || "unknown")
      .toLowerCase()
      .replace(/[^a-z0-9]+/g, "-")
      .replace(/(^-|-$)/g, "");
  }

  function addArtistWork(map, name, details, work){
    const safeName = (name || "Unknown Artist").trim() || "Unknown Artist";
    const id = slugifyArtist(safeName);
    if(!map.has(id)){
      map.set(id, {
        id,
        name: safeName,
        role: details.role || "Artist",
        img: details.img || "",
        bio: details.bio || "",
        works: []
      });
    }
    const artist = map.get(id);
    if((!artist.role || artist.role === "Artist") && details.role) artist.role = details.role;
    if(!artist.img && details.img) artist.img = details.img;
    if(!artist.bio && details.bio) artist.bio = details.bio;
    if(work && !artist.works.some(w => w.id === work.id)) artist.works.push(work);
  }

  function buildArtistProducts(artist){
    const base = artist.works.length ? artist.works : [];
    const picks = base.slice(0, 3).map(w => ({ ...w }));
    if(picks.length >= 3) return picks;

    const seed = base[0] || { name: artist.name, img: artist.img, kind:"Artwork", data:null };
    const labels = ["Signature Edition", "Studio Proof", "Collector's Print"];
    while(picks.length < 3){
      const idx = picks.length;
      picks.push({
        id:`${artist.id}-product-${idx + 1}`,
        name:`${seed.name} — ${labels[idx] || "Edition"}`,
        img: seed.img || artist.img || "",
        kind: seed.kind || "Artwork",
        data: seed.data || null,
        generated:true
      });
    }
    return picks;
  }

  function buildArtists(){
    const map = new Map();
    PRODUCTS.forEach(p => {
      const a = p.artist || {};
      addArtistWork(map, a.name, { role:a.role, img:a.img, bio:a.bio }, {
        id:p.id,
        name:p.name,
        img:p.img,
        kind:"Design",
        data:p
      });
    });

    ARTWORKS.forEach(a => {
      addArtistWork(map, a.artist, { role: a.period ? `${a.period} Artist` : "Artist" }, {
        id:a.id,
        name:a.name,
        img:a.img,
        kind:"Artwork",
        data:a
      });
    });

    SCULPTURES.forEach(s => {
      addArtistWork(map, s.artist, { role: s.era ? `${s.era} Sculptor` : "Sculptor" }, {
        id:s.id,
        name:s.name,
        img:s.img,
        kind:"Sculpture",
        data:s
      });
    });

    return Array.from(map.values()).map(artist => {
      artist.products = buildArtistProducts(artist);
      return artist;
    }).sort((a,b) => a.name.localeCompare(b.name));
  }

  function getArtistSummary(artist){
    if(artist.bio) return artist.bio;
    const types = Array.from(new Set(artist.works.map(w => w.kind)));
    const picks = artist.works.slice(0, 3).map(w => w.name).join(", ");
    const typeLine = types.length ? `Featured in ${types.join(" & ")} collections.` : "Featured in the collection.";
    const worksLine = picks ? `Selected works: ${picks}.` : "";
    return `${typeLine}${worksLine ? " " + worksLine : ""}`;
  }

  let ARTISTS = buildArtists();
  const deepClone = (value) => JSON.parse(JSON.stringify(value));
  const FALLBACK_PRODUCTS = deepClone(PRODUCTS);
  const FALLBACK_BOOKS = deepClone(BOOKS);
  const FALLBACK_ARTWORKS = deepClone(ARTWORKS);
  const FALLBACK_SCULPTURES = deepClone(SCULPTURES);

  function refreshDerivedCollections(){
    ART_ITEMS = ARTWORKS.concat(SCULPTURES);
    ARTISTS = buildArtists();
  }

  const grid = document.getElementById("grid");
  const galleryTabs = document.getElementById("galleryTabs");
  const galleryEmpty = document.getElementById("galleryEmpty");
  const filtersEl = document.getElementById("filters");
  const bookFilterBar = document.getElementById("bookFilterBar");
  const bookFilterBtn = document.getElementById("bookFilterBtn");
  const bookFilterSummary = document.getElementById("bookFilterSummary");
  const bookFilterModal = document.getElementById("bookFilterModal");
  const bookFilterClose = document.getElementById("bookFilterClose");
  const bookSortSelect = document.getElementById("bookSortSelect");
  const bookFilterClear = document.getElementById("bookFilterClear");
  const bookFilterApply = document.getElementById("bookFilterApply");
  const artFilterBar = document.getElementById("artFilterBar");
  const artFilterBtn = document.getElementById("artFilterBtn");
  const artFilterSummary = document.getElementById("artFilterSummary");
  const artFilterModal = document.getElementById("artFilterModal");
  const artFilterClose = document.getElementById("artFilterClose");
  const artSortSelect = document.getElementById("artSortSelect");
  const artFilterClear = document.getElementById("artFilterClear");
  const artFilterApply = document.getElementById("artFilterApply");
  const sculptureFilterBar = document.getElementById("sculptureFilterBar");
  const sculptureFilterBtn = document.getElementById("sculptureFilterBtn");
  const sculptureFilterSummary = document.getElementById("sculptureFilterSummary");
  const sculptureFilterModal = document.getElementById("sculptureFilterModal");
  const sculptureFilterClose = document.getElementById("sculptureFilterClose");
  const sculptureSortSelect = document.getElementById("sculptureSortSelect");
  const sculptureFilterClear = document.getElementById("sculptureFilterClear");
  const sculptureFilterApply = document.getElementById("sculptureFilterApply");
  const galleryArtistsLink = document.getElementById("galleryArtistsLink");
  const artistsBackBtn = document.getElementById("artistsBackBtn");
  const artistsGrid = document.getElementById("artistsGrid");
  const artistsCount = document.getElementById("artistsCount");
  const artistsWorksCount = document.getElementById("artistsWorksCount");
  const artistsProductsCount = document.getElementById("artistsProductsCount");
  const artistDetailBack = document.getElementById("artistDetailBack");
  const artistDetailImg = document.getElementById("artistDetailImg");
  const artistDetailName = document.getElementById("artistDetailName");
  const artistDetailRole = document.getElementById("artistDetailRole");
  const artistDetailBio = document.getElementById("artistDetailBio");
  const artistDetailFocus = document.getElementById("artistDetailFocus");
  const artistProductsGrid = document.getElementById("artistProductsGrid");
  const artistWorksGrid = document.getElementById("artistWorksGrid");
  const artistWorksCount = document.getElementById("artistWorksCount");
  const artistWorksCountLabel = document.getElementById("artistWorksCountLabel");
  const adminAuthCard = document.getElementById("adminAuthCard");
  const adminPanel = document.getElementById("adminPanel");
  const adminEmail = document.getElementById("adminEmail");
  const adminPassword = document.getElementById("adminPassword");
  const adminLoginBtn = document.getElementById("adminLoginBtn");
  const adminAuthStatus = document.getElementById("adminAuthStatus");
  const adminRefreshBtn = document.getElementById("adminRefreshBtn");
  const adminSeedBtn = document.getElementById("adminSeedBtn");
  const adminLogoutBtn = document.getElementById("adminLogoutBtn");
  const adminUserEmail = document.getElementById("adminUserEmail");
  const adminTypeFilter = document.getElementById("adminTypeFilter");
  const adminProductList = document.getElementById("adminProductList");
  const adminNewProductBtn = document.getElementById("adminNewProductBtn");
  const adminProductId = document.getElementById("adminProductId");
  const adminName = document.getElementById("adminName");
  const adminGalleryType = document.getElementById("adminGalleryType");
  const adminArtType = document.getElementById("adminArtType");
  const adminArtTypeRow = document.getElementById("adminArtTypeRow");
  const adminCategory = document.getElementById("adminCategory");
  const adminSortOrder = document.getElementById("adminSortOrder");
  const adminArtistName = document.getElementById("adminArtistName");
  const adminArtistRole = document.getElementById("adminArtistRole");
  const adminArtistImageUrl = document.getElementById("adminArtistImageUrl");
  const adminArtistBio = document.getElementById("adminArtistBio");
  const adminCoverImageUrl = document.getElementById("adminCoverImageUrl");
  const adminModelUrl = document.getElementById("adminModelUrl");
  const adminCoverUpload = document.getElementById("adminCoverUpload");
  const adminModelUpload = document.getElementById("adminModelUpload");
  const adminImagesInput = document.getElementById("adminImagesInput");
  const adminImagesUpload = document.getElementById("adminImagesUpload");
  const adminTheme = document.getElementById("adminTheme");
  const adminColor = document.getElementById("adminColor");
  const adminSize = document.getElementById("adminSize");
  const adminTag = document.getElementById("adminTag");
  const adminKicker = document.getElementById("adminKicker");
  const adminMaterial = document.getElementById("adminMaterial");
  const adminDimensions = document.getElementById("adminDimensions");
  const adminStoreName = document.getElementById("adminStoreName");
  const adminStoreLng = document.getElementById("adminStoreLng");
  const adminStoreLat = document.getElementById("adminStoreLat");
  const adminMedium = document.getElementById("adminMedium");
  const adminPeriod = document.getElementById("adminPeriod");
  const adminArtMaterial = document.getElementById("adminArtMaterial");
  const adminEra = document.getElementById("adminEra");
  const adminYear = document.getElementById("adminYear");
  const adminRating = document.getElementById("adminRating");
  const adminRatingCount = document.getElementById("adminRatingCount");
  const adminBasePrice = document.getElementById("adminBasePrice");
  const adminBooksFields = document.getElementById("adminBooksFields");
  const adminFurnitureFields = document.getElementById("adminFurnitureFields");
  const adminArtFields = document.getElementById("adminArtFields");
  const adminSaveBtn = document.getElementById("adminSaveBtn");
  const adminDeleteBtn = document.getElementById("adminDeleteBtn");
  const adminSaveStatus = document.getElementById("adminSaveStatus");

  let currentFilter = "all";
  let currentGallery = "furniture";
  const bookFilterState = {
    sort: "featured",
    themes: new Set(),
    colors: new Set(),
    sizes: new Set()
  };
  const artFilterState = {
    sort: "featured",
    types: new Set(),
    artists: new Set(),
    periods: new Set(),
    media: new Set()
  };
  const sculptureFilterState = {
    sort: "featured",
    artists: new Set(),
    eras: new Set(),
    materials: new Set()
  };
  const ADMIN_BUCKET = "product-assets";
  let adminSession = null;
  let adminAuthorized = false;
  let adminRows = [];
  let adminSelectedId = null;

  function toOptionalNumber(value){
    if(value === null || value === undefined) return null;
    const raw = String(value).trim();
    if(!raw) return null;
    const num = Number(raw);
    return Number.isFinite(num) ? num : null;
  }

  async function withTimeout(promise, ms, message){
    let timer = null;
    try{
      return await Promise.race([
        promise,
        new Promise((_, reject) => {
          timer = setTimeout(() => reject(new Error(message)), ms);
        })
      ]);
    } finally {
      if(timer) clearTimeout(timer);
    }
  }

  function generateUuid(){
    if(window.crypto && typeof window.crypto.randomUUID === "function") return window.crypto.randomUUID();
    return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (c) => {
      const r = Math.random() * 16 | 0;
      const v = c === "x" ? r : (r & 0x3 | 0x8);
      return v.toString(16);
    });
  }

  function parseMediaImagesValue(value){
    if(Array.isArray(value)) return value.filter(Boolean).map(v => String(v).trim()).filter(Boolean);
    if(typeof value === "string"){
      const trimmed = value.trim();
      if(!trimmed) return [];
      if(trimmed.startsWith("[")){
        try{
          const parsed = JSON.parse(trimmed);
          if(Array.isArray(parsed)) return parsed.filter(Boolean).map(v => String(v).trim()).filter(Boolean);
        }catch(e){}
      }
      return trimmed.split(/\r?\n/).map(v => v.trim()).filter(Boolean);
    }
    return [];
  }

  function uniqueUrlList(list){
    const seen = new Set();
    const out = [];
    (list || []).forEach(item => {
      const value = String(item || "").trim();
      if(!value) return;
      if(seen.has(value)) return;
      seen.add(value);
      out.push(value);
    });
    return out;
  }

  function mapProductRow(row){
    if(!row || !row.gallery_type) return null;
    const id = row.legacy_id || row.id;
    const cover = row.image_url || "";
    const extras = parseMediaImagesValue(row.media_images);
    const images = uniqueUrlList([cover].concat(extras));
    const artistObj = {
      name: row.artist_name || "Unknown",
      role: row.artist_role || "Artist",
      img: row.artist_image_url || cover || "",
      bio: row.artist_bio || ""
    };

    if(row.gallery_type === "furniture"){
      return {
        bucket: "furniture",
        item: {
          id,
          name: row.name || "Untitled",
          category: row.category || "decor",
          img: cover || "",
          images,
          model: row.model_url || "",
          specs: {
            mat: row.material || "--",
            dim: row.dimensions || "--"
          },
          store: {
            name: row.store_name || "Gallery",
            coords: [
              toOptionalNumber(row.store_lng) ?? 0,
              toOptionalNumber(row.store_lat) ?? 20
            ]
          },
          artist: artistObj
        }
      };
    }

    if(row.gallery_type === "books"){
      return {
        bucket: "books",
        item: {
          id,
          name: row.name || "Untitled",
          img: cover || "",
          images,
          theme: row.theme || "General",
          color: row.color || "Neutral",
          size: row.size || "Classic",
          price: "",
          priceValue: toOptionalNumber(row.base_price) ?? 0,
          tag: row.tag || "",
          kicker: row.kicker || ""
        }
      };
    }

    if(row.gallery_type === "art"){
      return {
        bucket: "art",
        item: {
          id,
          type: "art",
          sub: "Artwork",
          name: row.name || "Untitled",
          artist: row.artist_name || "Unknown",
          img: cover || "",
          images,
          model: row.model_url || "",
          rating: toOptionalNumber(row.rating) ?? 5,
          ratingCount: row.rating_count || "50+",
          basePrice: toOptionalNumber(row.base_price) ?? 32,
          year: toOptionalNumber(row.year) ?? null,
          period: row.period || "--",
          medium: row.medium || row.material || "--"
        }
      };
    }

    if(row.gallery_type === "sculpture"){
      return {
        bucket: "sculpture",
        item: {
          id,
          type: "sculpture",
          sub: "Sculpture",
          name: row.name || "Untitled",
          artist: row.artist_name || "Unknown",
          img: cover || "",
          images,
          model: row.model_url || "",
          rating: toOptionalNumber(row.rating) ?? 5,
          ratingCount: row.rating_count || "50+",
          basePrice: toOptionalNumber(row.base_price) ?? 1200,
          year: toOptionalNumber(row.year) ?? null,
          era: row.era || row.period || "--",
          period: row.period || row.era || "--",
          material: row.material || row.medium || "--",
          medium: row.medium || row.material || "--"
        }
      };
    }

    return null;
  }

  function resetToFallbackCollections(){
    PRODUCTS = deepClone(FALLBACK_PRODUCTS);
    BOOKS = deepClone(FALLBACK_BOOKS);
    ARTWORKS = deepClone(FALLBACK_ARTWORKS);
    SCULPTURES = deepClone(FALLBACK_SCULPTURES);
    refreshDerivedCollections();
  }

  function applyDatabaseRows(rows){
    if(!Array.isArray(rows) || rows.length === 0){
      resetToFallbackCollections();
      return;
    }
    const furniture = [];
    const books = [];
    const artworks = [];
    const sculptures = [];
    rows.forEach(row => {
      const mapped = mapProductRow(row);
      if(!mapped) return;
      if(mapped.bucket === "furniture") furniture.push(mapped.item);
      if(mapped.bucket === "books") books.push(mapped.item);
      if(mapped.bucket === "art") artworks.push(mapped.item);
      if(mapped.bucket === "sculpture") sculptures.push(mapped.item);
    });
    PRODUCTS = furniture;
    BOOKS = books;
    ARTWORKS = artworks;
    SCULPTURES = sculptures;
    refreshDerivedCollections();
  }

  function rerenderVisibleCollections(){
    if(currentGallery === "furniture") renderFurniture();
    if(currentGallery === "books") renderBooks();
    if(currentGallery === "art") renderArt();
    if(currentGallery === "designs" && galleryEmpty){
      const titleEl = galleryEmpty.querySelector(".gallery-empty-title");
      if(titleEl) titleEl.textContent = "Photography collection coming soon";
    }
    renderArtists();
  }

  async function loadCatalogFromSupabase(){
    if(!supabaseClient) return false;
    const { data, error } = await supabaseClient
      .from("products")
      .select("*")
      .eq("status", "active")
      .order("sort_order", { ascending:true })
      .order("created_at", { ascending:true });
    if(error){
      console.warn("Supabase load failed:", error.message);
      return false;
    }
    applyDatabaseRows(data || []);
    return true;
  }

  function setAdminAuthStatus(text, isError){
    if(!adminAuthStatus) return;
    adminAuthStatus.textContent = text;
    adminAuthStatus.style.color = isError ? "#b03333" : "#555";
  }

  function setAdminSaveStatus(text, isError){
    if(!adminSaveStatus) return;
    adminSaveStatus.textContent = text;
    adminSaveStatus.style.color = isError ? "#b03333" : "#555";
  }

  async function checkAdminAuthorization(session){
    const email = ((session && session.user && session.user.email) || "").toLowerCase();
    if(!email) return false;
    if(email === DEFAULT_ADMIN_EMAIL.toLowerCase()) return true;
    if(!supabaseClient) return false;
    try{
      const { data, error } = await supabaseClient
        .from("admin_users")
        .select("email")
        .eq("email", email)
        .maybeSingle();
      if(error){
        console.warn("Admin table check skipped:", error.message);
        return false;
      }
      return !!data;
    }catch(e){
      return false;
    }
  }

  function getAdminCategoryLabel(type){
    if(type === "furniture") return "Designs";
    if(type === "books") return "Books";
    if(type === "art") return "Art";
    if(type === "sculpture") return "Sculpture";
    return type || "Type";
  }

  function setAdminFieldVisibility(){
    const type = adminGalleryType ? adminGalleryType.value : "furniture";
    if(adminBooksFields) adminBooksFields.hidden = type !== "books";
    if(adminFurnitureFields) adminFurnitureFields.hidden = type !== "furniture";
    if(adminArtFields) adminArtFields.hidden = !(type === "art" || type === "sculpture");
    if(adminArtTypeRow) adminArtTypeRow.hidden = type !== "art";
  }

  function clearAdminForm(){
    if(adminProductId) adminProductId.value = "";
    if(adminName) adminName.value = "";
    if(adminCategory) adminCategory.value = "";
    if(adminSortOrder) adminSortOrder.value = "0";
    if(adminArtistName) adminArtistName.value = "";
    if(adminArtistRole) adminArtistRole.value = "";
    if(adminArtistImageUrl) adminArtistImageUrl.value = "";
    if(adminArtistBio) adminArtistBio.value = "";
    if(adminCoverImageUrl) adminCoverImageUrl.value = "";
    if(adminModelUrl) adminModelUrl.value = "";
    if(adminImagesInput) adminImagesInput.value = "";
    if(adminTheme) adminTheme.value = "";
    if(adminColor) adminColor.value = "";
    if(adminSize) adminSize.value = "";
    if(adminTag) adminTag.value = "";
    if(adminKicker) adminKicker.value = "";
    if(adminMaterial) adminMaterial.value = "";
    if(adminDimensions) adminDimensions.value = "";
    if(adminStoreName) adminStoreName.value = "";
    if(adminStoreLng) adminStoreLng.value = "";
    if(adminStoreLat) adminStoreLat.value = "";
    if(adminMedium) adminMedium.value = "";
    if(adminPeriod) adminPeriod.value = "";
    if(adminArtMaterial) adminArtMaterial.value = "";
    if(adminEra) adminEra.value = "";
    if(adminYear) adminYear.value = "";
    if(adminRating) adminRating.value = "";
    if(adminRatingCount) adminRatingCount.value = "";
    if(adminBasePrice) adminBasePrice.value = "";
    if(adminCoverUpload) adminCoverUpload.value = "";
    if(adminImagesUpload) adminImagesUpload.value = "";
    if(adminModelUpload) adminModelUpload.value = "";
    adminSelectedId = null;
    if(adminGalleryType) adminGalleryType.value = "furniture";
    if(adminArtType) adminArtType.value = "art";
    setAdminFieldVisibility();
    setAdminSaveStatus("Ready", false);
  }

  function fillAdminForm(record){
    if(!record) return;
    adminSelectedId = record.id;
    if(adminProductId) adminProductId.value = record.id || "";
    const recType = record.gallery_type || "furniture";
    if(adminGalleryType) adminGalleryType.value = recType === "sculpture" ? "art" : recType;
    if(adminArtType) adminArtType.value = recType === "sculpture" ? "sculpture" : "art";
    if(adminName) adminName.value = record.name || "";
    if(adminCategory) adminCategory.value = record.category || "";
    if(adminSortOrder) adminSortOrder.value = String(record.sort_order || 0);
    if(adminArtistName) adminArtistName.value = record.artist_name || "";
    if(adminArtistRole) adminArtistRole.value = record.artist_role || "";
    if(adminArtistImageUrl) adminArtistImageUrl.value = record.artist_image_url || "";
    if(adminArtistBio) adminArtistBio.value = record.artist_bio || "";
    if(adminCoverImageUrl) adminCoverImageUrl.value = record.image_url || "";
    if(adminModelUrl) adminModelUrl.value = record.model_url || "";
    if(adminImagesInput) adminImagesInput.value = parseMediaImagesValue(record.media_images).join("\n");
    if(adminTheme) adminTheme.value = record.theme || "";
    if(adminColor) adminColor.value = record.color || "";
    if(adminSize) adminSize.value = record.size || "";
    if(adminTag) adminTag.value = record.tag || "";
    if(adminKicker) adminKicker.value = record.kicker || "";
    if(adminMaterial) adminMaterial.value = record.material || "";
    if(adminDimensions) adminDimensions.value = record.dimensions || "";
    if(adminStoreName) adminStoreName.value = record.store_name || "";
    if(adminStoreLng) adminStoreLng.value = record.store_lng ?? "";
    if(adminStoreLat) adminStoreLat.value = record.store_lat ?? "";
    if(adminMedium) adminMedium.value = record.medium || "";
    if(adminPeriod) adminPeriod.value = record.period || "";
    if(adminArtMaterial) adminArtMaterial.value = record.material || "";
    if(adminEra) adminEra.value = record.era || "";
    if(adminYear) adminYear.value = record.year ?? "";
    if(adminRating) adminRating.value = record.rating ?? "";
    if(adminRatingCount) adminRatingCount.value = record.rating_count || "";
    if(adminBasePrice) adminBasePrice.value = record.base_price ?? "";
    setAdminFieldVisibility();
    setAdminSaveStatus("Editing selected product", false);
  }

  function buildAdminListItem(record){
    const item = document.createElement("div");
    item.className = "admin-item" + (adminSelectedId === record.id ? " active" : "");

    const left = document.createElement("div");
    const name = document.createElement("div");
    name.className = "admin-item-name";
    name.textContent = record.name || "Untitled";
    const meta = document.createElement("div");
    meta.className = "admin-item-meta";
    meta.textContent = `${getAdminCategoryLabel(record.gallery_type)} · ${(record.status || "active").toUpperCase()}`;
    left.appendChild(name);
    left.appendChild(meta);

    const actions = document.createElement("div");
    actions.className = "admin-item-actions";
    const editBtn = document.createElement("button");
    editBtn.className = "admin-item-btn";
    editBtn.type = "button";
    editBtn.textContent = "Edit";
    editBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      fillAdminForm(record);
      renderAdminProductList();
    });
    const delBtn = document.createElement("button");
    delBtn.className = "admin-item-btn";
    delBtn.type = "button";
    delBtn.textContent = "Delete";
    delBtn.addEventListener("click", async (e) => {
      e.stopPropagation();
      await deleteAdminProduct(record.id);
    });
    actions.appendChild(editBtn);
    actions.appendChild(delBtn);

    item.appendChild(left);
    item.appendChild(actions);
    item.addEventListener("click", () => {
      fillAdminForm(record);
      renderAdminProductList();
    });
    return item;
  }

  function renderAdminProductList(){
    if(!adminProductList) return;
    adminProductList.innerHTML = "";
    const typeFilter = adminTypeFilter ? adminTypeFilter.value : "all";
    const list = typeFilter === "all"
      ? adminRows
      : (typeFilter === "art"
        ? adminRows.filter(row => row.gallery_type === "art" || row.gallery_type === "sculpture")
        : adminRows.filter(row => row.gallery_type === typeFilter));
    list.forEach(record => adminProductList.appendChild(buildAdminListItem(record)));
  }

  async function loadAdminRows(){
    if(!supabaseClient || !adminAuthorized) return;
    const { data, error } = await supabaseClient
      .from("products")
      .select("*")
      .order("sort_order", { ascending:true })
      .order("created_at", { ascending:true });
    if(error){
      const msg = String(error.message || "");
      if(msg.toLowerCase().includes("does not exist")){
        setAdminSaveStatus("Load failed: 'products' table missing. Run supabase/schema.sql.", true);
      }else{
        setAdminSaveStatus(`Load failed: ${msg}`, true);
      }
      return;
    }
    adminRows = data || [];
    renderAdminProductList();
  }

  async function uploadAsset(file, folder, productId){
    if(!supabaseClient || !file) return "";
    const cleanName = (file.name || "file").replace(/[^a-zA-Z0-9._-]/g, "-");
    const path = `${folder}/${productId}/${Date.now()}-${cleanName}`;
    const { error } = await withTimeout(
      supabaseClient.storage.from(ADMIN_BUCKET).upload(path, file, { upsert:true }),
      45000,
      "Upload timed out. Check your network or file size and try again."
    );
    if(error){
      const msg = String(error.message || error || "");
      if(msg.toLowerCase().includes("bucket") || msg.toLowerCase().includes("not found")){
        throw new Error(`Storage bucket '${ADMIN_BUCKET}' is missing. Run supabase/schema.sql in SQL editor.`);
      }
      if(msg.toLowerCase().includes("row-level security") || msg.toLowerCase().includes("permission")){
        throw new Error(`Storage permission denied. Add your email to public.admin_users and run supabase/schema.sql policies.`);
      }
      throw new Error(msg || "Storage upload failed");
    }
    const { data } = supabaseClient.storage.from(ADMIN_BUCKET).getPublicUrl(path);
    return (data && data.publicUrl) ? data.publicUrl : "";
  }

  function getAdminInputValue(el){
    return el ? String(el.value || "").trim() : "";
  }

  function buildAdminPayload(existing){
    const selectedType = getAdminInputValue(adminGalleryType) || "furniture";
    const nowType = selectedType === "art"
      ? ((getAdminInputValue(adminArtType) === "sculpture") ? "sculpture" : "art")
      : selectedType;
    const id = (existing && existing.id) || getAdminInputValue(adminProductId) || generateUuid();
    const legacyId = (existing && existing.legacy_id) || id;
    const payload = {
      id,
      legacy_id: legacyId,
      gallery_type: nowType,
      status: "active",
      sort_order: toOptionalNumber(getAdminInputValue(adminSortOrder)) ?? 0,
      name: getAdminInputValue(adminName),
      category: getAdminInputValue(adminCategory) || null,
      artist_name: getAdminInputValue(adminArtistName) || null,
      artist_role: getAdminInputValue(adminArtistRole) || null,
      artist_image_url: getAdminInputValue(adminArtistImageUrl) || null,
      artist_bio: getAdminInputValue(adminArtistBio) || null,
      image_url: getAdminInputValue(adminCoverImageUrl) || null,
      model_url: getAdminInputValue(adminModelUrl) || null,
      media_images: uniqueUrlList(parseMediaImagesValue(getAdminInputValue(adminImagesInput))),
      theme: null,
      color: null,
      size: null,
      tag: null,
      kicker: null,
      material: null,
      dimensions: null,
      store_name: null,
      store_lng: null,
      store_lat: null,
      medium: null,
      period: null,
      era: null,
      year: null,
      rating: null,
      rating_count: null,
      base_price: null
    };

    if(nowType === "books"){
      payload.theme = getAdminInputValue(adminTheme) || null;
      payload.color = getAdminInputValue(adminColor) || null;
      payload.size = getAdminInputValue(adminSize) || null;
      payload.tag = getAdminInputValue(adminTag) || null;
      payload.kicker = getAdminInputValue(adminKicker) || null;
      payload.base_price = toOptionalNumber(getAdminInputValue(adminBasePrice));
    }

    if(nowType === "furniture"){
      payload.material = getAdminInputValue(adminMaterial) || null;
      payload.dimensions = getAdminInputValue(adminDimensions) || null;
      payload.store_name = getAdminInputValue(adminStoreName) || null;
      payload.store_lng = toOptionalNumber(getAdminInputValue(adminStoreLng));
      payload.store_lat = toOptionalNumber(getAdminInputValue(adminStoreLat));
    }

    if(nowType === "art" || nowType === "sculpture"){
      payload.medium = getAdminInputValue(adminMedium) || null;
      payload.period = getAdminInputValue(adminPeriod) || null;
      payload.material = getAdminInputValue(adminArtMaterial) || null;
      payload.era = getAdminInputValue(adminEra) || null;
      payload.year = toOptionalNumber(getAdminInputValue(adminYear));
      payload.rating = toOptionalNumber(getAdminInputValue(adminRating));
      payload.rating_count = getAdminInputValue(adminRatingCount) || null;
      payload.base_price = toOptionalNumber(getAdminInputValue(adminBasePrice));
    }

    return payload;
  }

  async function saveAdminProduct(){
    if(!supabaseClient || !adminAuthorized){
      setAdminSaveStatus("Admin access required", true);
      return;
    }
    const current = adminRows.find(row => row.id === adminSelectedId) || null;
    const payload = buildAdminPayload(current);
    if(!payload.name){
      setAdminSaveStatus("Product name is required", true);
      return;
    }
    const hasUploads =
      !!(adminCoverUpload && adminCoverUpload.files && adminCoverUpload.files[0]) ||
      !!(adminModelUpload && adminModelUpload.files && adminModelUpload.files[0]) ||
      !!(adminImagesUpload && adminImagesUpload.files && adminImagesUpload.files.length);
    setAdminSaveStatus(hasUploads ? "Uploading assets..." : "Saving product...", false);

    try{
      if(adminCoverUpload && adminCoverUpload.files && adminCoverUpload.files[0]){
        payload.image_url = await uploadAsset(adminCoverUpload.files[0], "images", payload.id);
      }
      if(adminModelUpload && adminModelUpload.files && adminModelUpload.files[0]){
        payload.model_url = await uploadAsset(adminModelUpload.files[0], "models", payload.id);
      }
      if(adminImagesUpload && adminImagesUpload.files && adminImagesUpload.files.length){
        const uploaded = [];
        const files = Array.from(adminImagesUpload.files);
        for(const file of files){
          const url = await uploadAsset(file, "gallery", payload.id);
          if(url) uploaded.push(url);
        }
        payload.media_images = uniqueUrlList((payload.media_images || []).concat(uploaded));
      }
    }catch(e){
      setAdminSaveStatus(`Upload failed: ${e.message || e}`, true);
      return;
    }

    let saveResult;
    try{
      saveResult = await withTimeout(
        supabaseClient
          .from("products")
          .upsert(payload, { onConflict:"id" })
          .select("*")
          .single(),
        30000,
        "Save timed out. Check Supabase connection and try again."
      );
    }catch(e){
      setAdminSaveStatus(`Save failed: ${e.message || e}`, true);
      return;
    }

    const { data, error } = saveResult || {};
    if(error){
      const msg = String(error.message || "");
      if(msg.toLowerCase().includes("row-level security")){
        setAdminSaveStatus("Save failed: permission denied. Add your email to public.admin_users.", true);
      }else if(msg.toLowerCase().includes("does not exist")){
        setAdminSaveStatus("Save failed: 'products' table missing. Run supabase/schema.sql.", true);
      }else{
        setAdminSaveStatus(`Save failed: ${msg}`, true);
      }
      return;
    }
    adminSelectedId = data.id;
    setAdminSaveStatus("Saved", false);
    await loadAdminRows();
    await loadCatalogFromSupabase();
    rerenderVisibleCollections();
    fillAdminForm(data);
  }

  async function deleteAdminProduct(id){
    if(!supabaseClient || !adminAuthorized || !id) return;
    const allow = window.confirm("Delete this product?");
    if(!allow) return;
    const { error } = await supabaseClient.from("products").delete().eq("id", id);
    if(error){
      setAdminSaveStatus(`Delete failed: ${error.message}`, true);
      return;
    }
    if(adminSelectedId === id) clearAdminForm();
    setAdminSaveStatus("Deleted", false);
    await loadAdminRows();
    await loadCatalogFromSupabase();
    rerenderVisibleCollections();
  }

  function buildSeedRows(){
    const rows = [];
    FALLBACK_PRODUCTS.forEach((p, idx) => {
      rows.push({
        legacy_id: p.id,
        gallery_type: "furniture",
        status: "active",
        sort_order: idx,
        name: p.name,
        category: p.category || null,
        artist_name: p.artist && p.artist.name ? p.artist.name : null,
        artist_role: p.artist && p.artist.role ? p.artist.role : null,
        artist_image_url: p.artist && p.artist.img ? p.artist.img : null,
        artist_bio: p.artist && p.artist.bio ? p.artist.bio : null,
        image_url: p.img || null,
        model_url: p.model || null,
        media_images: uniqueUrlList(p.images || []),
        material: p.specs && p.specs.mat ? p.specs.mat : null,
        dimensions: p.specs && p.specs.dim ? p.specs.dim : null,
        store_name: p.store && p.store.name ? p.store.name : null,
        store_lng: p.store && p.store.coords ? p.store.coords[0] : null,
        store_lat: p.store && p.store.coords ? p.store.coords[1] : null
      });
    });

    FALLBACK_BOOKS.forEach((b, idx) => {
      rows.push({
        legacy_id: b.id,
        gallery_type: "books",
        status: "active",
        sort_order: idx,
        name: b.name,
        image_url: b.img || null,
        media_images: uniqueUrlList(b.images || []),
        theme: b.theme || null,
        color: b.color || null,
        size: b.size || null,
        tag: b.tag || null,
        kicker: b.kicker || null,
        base_price: toOptionalNumber(b.priceValue)
      });
    });

    FALLBACK_ARTWORKS.forEach((a, idx) => {
      rows.push({
        legacy_id: a.id,
        gallery_type: "art",
        status: "active",
        sort_order: idx,
        name: a.name,
        artist_name: a.artist || null,
        image_url: a.img || null,
        model_url: a.model || null,
        media_images: uniqueUrlList(a.images || []),
        medium: a.medium || null,
        period: a.period || null,
        year: toOptionalNumber(a.year),
        rating: toOptionalNumber(a.rating),
        rating_count: a.ratingCount || null,
        base_price: toOptionalNumber(a.basePrice)
      });
    });

    FALLBACK_SCULPTURES.forEach((s, idx) => {
      rows.push({
        legacy_id: s.id,
        gallery_type: "sculpture",
        status: "active",
        sort_order: idx,
        name: s.name,
        artist_name: s.artist || null,
        image_url: s.img || null,
        model_url: s.model || null,
        media_images: uniqueUrlList(s.images || []),
        medium: s.medium || null,
        period: s.period || null,
        era: s.era || null,
        material: s.material || null,
        year: toOptionalNumber(s.year),
        rating: toOptionalNumber(s.rating),
        rating_count: s.ratingCount || null,
        base_price: toOptionalNumber(s.basePrice)
      });
    });

    return rows;
  }

  async function seedSupabaseFromFallback(){
    if(!supabaseClient || !adminAuthorized){
      setAdminSaveStatus("Admin access required", true);
      return;
    }
    const rows = buildSeedRows();
    if(!rows.length){
      setAdminSaveStatus("No seed data found", true);
      return;
    }
    setAdminSaveStatus("Seeding products...", false);
    const { error } = await supabaseClient.from("products").upsert(rows, { onConflict:"legacy_id" });
    if(error){
      setAdminSaveStatus(`Seed failed: ${error.message}`, true);
      return;
    }
    setAdminSaveStatus("Seed completed", false);
    await loadAdminRows();
    await loadCatalogFromSupabase();
    rerenderVisibleCollections();
  }

  function updateAdminViewState(){
    if(adminUserEmail){
      const email = adminSession && adminSession.user ? adminSession.user.email : "";
      adminUserEmail.textContent = email || "Not signed in";
    }
    if(adminAuthCard) adminAuthCard.hidden = !!adminSession && adminAuthorized;
    if(adminPanel) adminPanel.hidden = !adminAuthorized;
  }

  async function handleAdminSession(session){
    adminSession = session || null;
    adminAuthorized = await checkAdminAuthorization(adminSession);
    if(!adminSession){
      setAdminAuthStatus("Not signed in", false);
      updateAdminViewState();
      return;
    }
    if(!adminAuthorized){
      setAdminAuthStatus("Signed in but not authorized as admin", true);
      updateAdminViewState();
      return;
    }
    setAdminAuthStatus("Authenticated", false);
    updateAdminViewState();
    await loadAdminRows();
  }

  async function initSupabaseAuth(){
    if(!supabaseClient){
      setAdminAuthStatus("Supabase client not available", true);
      return;
    }
    const { data } = await supabaseClient.auth.getSession();
    await handleAdminSession(data ? data.session : null);
    supabaseClient.auth.onAuthStateChange(async (_event, session) => {
      await handleAdminSession(session);
    });
  }

  function renderCards(list, options){
    if(!grid) return;
    grid.innerHTML = "";
    const clickable = options && options.clickable;
    const defaultSub = options && options.subLabel ? options.subLabel : "";
    const extraClass = options && options.className ? options.className : "";
    const onClick = options && typeof options.onClick === "function" ? options.onClick : null;
    list.forEach(p => {
      const el = document.createElement("article");
      el.className = extraClass ? `card ${extraClass}` : "card";
      const title = p.name || "Item";
      const sub = (p.sub || defaultSub).trim();
      el.innerHTML = `
        <div class="card-media"><img src="${p.img}" alt="${title}"/></div>
        <div class="card-name">${title}</div>
        ${sub ? `<div class="card-sub">${sub}</div>` : ""}
      `;
      if(clickable){
        if(onClick) el.addEventListener("click", () => onClick(p));
        else el.addEventListener("click", () => openSolo(p));
      }
      grid.appendChild(el);
    });
  }

  function renderFurniture(){
    const list = currentFilter === "all" ? PRODUCTS : PRODUCTS.filter(p => p.category === currentFilter);
    renderCards(list, { clickable:true, subLabel:"Edition 2024", onClick:openSolo });
  }

  function getBookSortLabel(value){
    if(value === "price-low") return "Price: Low to High";
    if(value === "price-high") return "Price: High to Low";
    if(value === "title-asc") return "Title: A–Z";
    return "Featured";
  }

  function summarizeSet(set, label){
    if(!set || set.size === 0) return `All ${label}`;
    const items = Array.from(set);
    if(items.length <= 2) return items.join(", ");
    return `${items.length} ${label}`;
  }

  function updateBookFilterSummary(){
    if(!bookFilterSummary) return;
    const parts = [
      getBookSortLabel(bookFilterState.sort),
      summarizeSet(bookFilterState.themes, "Themes"),
      summarizeSet(bookFilterState.colors, "Colors"),
      summarizeSet(bookFilterState.sizes, "Sizes")
    ];
    bookFilterSummary.textContent = parts.join(" · ");
  }

  function applyBookFilters(list){
    let result = list.slice();
    if(bookFilterState.themes.size){
      result = result.filter(b => bookFilterState.themes.has(b.theme));
    }
    if(bookFilterState.colors.size){
      result = result.filter(b => bookFilterState.colors.has(b.color));
    }
    if(bookFilterState.sizes.size){
      result = result.filter(b => bookFilterState.sizes.has(b.size));
    }
    if(bookFilterState.sort === "price-low"){
      result.sort((a,b) => (a.priceValue || 0) - (b.priceValue || 0));
    }else if(bookFilterState.sort === "price-high"){
      result.sort((a,b) => (b.priceValue || 0) - (a.priceValue || 0));
    }else if(bookFilterState.sort === "title-asc"){
      result.sort((a,b) => (a.name || "").localeCompare(b.name || ""));
    }
    return result;
  }

  function renderBooks(){
    const list = applyBookFilters(BOOKS);
    renderCards(list, { clickable:true, subLabel:"Book", className:"book-card", onClick:openBook });
    updateBookFilterSummary();
  }

  function renderArt(){
    const list = applyArtFilters(ART_ITEMS);
    renderCards(list, { clickable:true, subLabel:"Artwork", className:"art-card", onClick:openArtItem });
    updateArtFilterSummary();
  }

  function openArtItem(item){
    if(item.type === "sculpture") openSculpture(item);
    else openArt(item);
  }

  function renderSculptures(){
    const list = applySculptureFilters(SCULPTURES);
    renderCards(list, { clickable:true, subLabel:"Sculpture", className:"sculpture-card", onClick:openSculpture });
    updateSculptureFilterSummary();
  }

  function renderArtists(){
    if(!artistsGrid) return;
    artistsGrid.innerHTML = "";
    const totalWorks = ARTISTS.reduce((sum, artist) => sum + artist.works.length, 0);
    if(artistsCount) artistsCount.textContent = String(ARTISTS.length);
    if(artistsWorksCount) artistsWorksCount.textContent = String(totalWorks);
    if(artistsProductsCount) artistsProductsCount.textContent = String(ARTISTS.length * 3);
    ARTISTS.forEach(artist => {
      const img = artist.img || (artist.works[0] && artist.works[0].img) || "";
      const summary = getArtistSummary(artist);
      const products = (artist.products || []).slice(0, 3);
      const productHtml = products.map(p => `
        <div class="artist-card-product"><img src="${p.img}" alt="${p.name}"></div>
      `).join("");
      const card = document.createElement("article");
      card.className = "artist-card";
      card.innerHTML = `
        <div class="artist-card-media"><img src="${img}" alt="${artist.name}"></div>
        <div class="artist-card-name">${artist.name}</div>
        <div class="artist-card-role">${artist.role || "Artist"}</div>
        <div class="artist-card-bio">${summary}</div>
        <div class="artist-card-products">${productHtml}</div>
        <div class="artist-card-footer">
          <div class="artist-card-cta">View profile →</div>
          <div class="artist-works-count">${artist.works.length} works</div>
        </div>
      `;
      card.addEventListener("click", () => openArtistDetail(artist.id));
      artistsGrid.appendChild(card);
    });
  }

  function renderArtistProducts(artist){
    if(!artistProductsGrid) return;
    artistProductsGrid.innerHTML = "";
    const products = (artist.products || []).slice(0, 3);
    products.forEach(product => {
      const el = document.createElement("article");
      el.className = "artist-product-card";
      el.innerHTML = `
        <div class="card-media"><img src="${product.img}" alt="${product.name}"/></div>
        <div class="card-name">${product.name}</div>
        <div class="card-sub">${product.kind}</div>
      `;
      el.addEventListener("click", () => openWorkFromArtist(product));
      artistProductsGrid.appendChild(el);
    });
  }

  function renderArtistWorks(artist){
    if(!artistWorksGrid) return;
    artistWorksGrid.innerHTML = "";
    artist.works.forEach(work => {
      const el = document.createElement("article");
      el.className = "card artist-work-card";
      el.innerHTML = `
        <div class="card-media"><img src="${work.img}" alt="${work.name}"/></div>
        <div class="card-name">${work.name}</div>
        <div class="card-sub">${work.kind}</div>
      `;
      el.addEventListener("click", () => openWorkFromArtist(work));
      artistWorksGrid.appendChild(el);
    });
  }

  function openArtistDetail(id){
    const artist = ARTISTS.find(a => a.id === id);
    if(!artist) return;
    const img = artist.img || (artist.works[0] && artist.works[0].img) || "";
    if(artistDetailImg){
      artistDetailImg.src = img;
      artistDetailImg.alt = artist.name;
    }
    if(artistDetailName) artistDetailName.textContent = artist.name;
    if(artistDetailRole) artistDetailRole.textContent = artist.role || "Artist";
    if(artistDetailBio) artistDetailBio.textContent = getArtistSummary(artist);
    const types = Array.from(new Set(artist.works.map(w => w.kind))).filter(Boolean);
    const focusText = types.length ? types.join(" / ") : (artist.role || "Artist");
    if(artistDetailFocus) artistDetailFocus.textContent = focusText;
    if(artistWorksCount) artistWorksCount.textContent = `${artist.works.length} works`;
    if(artistWorksCountLabel) artistWorksCountLabel.textContent = `${artist.works.length} works`;
    renderArtistProducts(artist);
    renderArtistWorks(artist);
    switchSection("sect-artist-detail");
  }

  function openWorkFromArtist(work){
    if(!work || !work.data){
      switchSection("sect-artist-detail");
      return;
    }
    switchSection("sect-gallery");
    if(work.kind === "Design"){
      setGallery("furniture");
      openSolo(work.data);
      return;
    }
    if(work.kind === "Artwork"){
      setGallery("art");
      openArt(work.data);
      return;
    }
    if(work.kind === "Sculpture"){
      setGallery("art");
      openSculpture(work.data);
    }
  }

  function getArtSortLabel(value){
    if(value === "title-asc") return "Title: A–Z";
    if(value === "year-asc") return "Year: Oldest First";
    if(value === "year-desc") return "Year: Newest First";
    return "Featured";
  }

  function updateArtFilterSummary(){
    if(!artFilterSummary) return;
    const parts = [
      getArtSortLabel(artFilterState.sort),
      summarizeSet(artFilterState.types, "Types"),
      summarizeSet(artFilterState.artists, "Artists"),
      summarizeSet(artFilterState.periods, "Periods"),
      summarizeSet(artFilterState.media, "Media")
    ];
    artFilterSummary.textContent = parts.join(" · ");
  }

  function applyArtFilters(list){
    let result = list.slice();
    if(artFilterState.types.size){
      result = result.filter(a => artFilterState.types.has(a.type));
    }
    if(artFilterState.artists.size){
      result = result.filter(a => artFilterState.artists.has(a.artist));
    }
    if(artFilterState.periods.size){
      result = result.filter(a => artFilterState.periods.has(a.period));
    }
    if(artFilterState.media.size){
      result = result.filter(a => artFilterState.media.has(a.medium));
    }
    if(artFilterState.sort === "title-asc"){
      result.sort((a,b) => (a.name || "").localeCompare(b.name || ""));
    }else if(artFilterState.sort === "year-asc"){
      result.sort((a,b) => (a.year || 0) - (b.year || 0));
    }else if(artFilterState.sort === "year-desc"){
      result.sort((a,b) => (b.year || 0) - (a.year || 0));
    }
    return result;
  }

  function getSculptureSortLabel(value){
    if(value === "title-asc") return "Title: A–Z";
    if(value === "year-asc") return "Year: Oldest First";
    if(value === "year-desc") return "Year: Newest First";
    return "Featured";
  }

  function updateSculptureFilterSummary(){
    if(!sculptureFilterSummary) return;
    const parts = [
      getSculptureSortLabel(sculptureFilterState.sort),
      summarizeSet(sculptureFilterState.artists, "Artists"),
      summarizeSet(sculptureFilterState.eras, "Eras"),
      summarizeSet(sculptureFilterState.materials, "Materials")
    ];
    sculptureFilterSummary.textContent = parts.join(" · ");
  }

  function applySculptureFilters(list){
    let result = list.slice();
    if(sculptureFilterState.artists.size){
      result = result.filter(s => sculptureFilterState.artists.has(s.artist));
    }
    if(sculptureFilterState.eras.size){
      result = result.filter(s => sculptureFilterState.eras.has(s.era));
    }
    if(sculptureFilterState.materials.size){
      result = result.filter(s => sculptureFilterState.materials.has(s.material));
    }
    if(sculptureFilterState.sort === "title-asc"){
      result.sort((a,b) => (a.name || "").localeCompare(b.name || ""));
    }else if(sculptureFilterState.sort === "year-asc"){
      result.sort((a,b) => (a.year || 0) - (b.year || 0));
    }else if(sculptureFilterState.sort === "year-desc"){
      result.sort((a,b) => (b.year || 0) - (a.year || 0));
    }
    return result;
  }

  function setGallery(galleryKey){
    currentGallery = galleryKey;
    const isFurniture = galleryKey === "furniture";
    const isBooks = galleryKey === "books";
    const isArt = galleryKey === "art";
    const isDesigns = galleryKey === "designs";
    const showGrid = isFurniture || isBooks || isArt;
    const galleryEl = document.getElementById("sect-gallery");
    if(galleryEl) galleryEl.classList.toggle("gallery-empty-state", !showGrid);

    if(galleryTabs){
      galleryTabs.querySelectorAll(".gallery-chip").forEach(btn => {
        btn.classList.toggle("active", btn.dataset.gallery === galleryKey);
      });
    }

    if(filtersEl){
      filtersEl.hidden = !isFurniture;
      filtersEl.setAttribute("aria-hidden", isFurniture ? "false" : "true");
    }
    if(bookFilterBar){
      bookFilterBar.hidden = !isBooks;
    }
    if(artFilterBar){
      artFilterBar.hidden = !isArt;
    }

    if(grid){
      grid.style.display = "";
    }

    if(galleryEmpty){
      if(showGrid){
        galleryEmpty.hidden = true;
      }else{
        const labelEl = galleryTabs ? galleryTabs.querySelector(`[data-gallery="${galleryKey}"]`) : null;
        const label = labelEl ? labelEl.textContent.trim() : galleryKey;
        const titleEl = galleryEmpty.querySelector(".gallery-empty-title");
        if(titleEl) titleEl.textContent = `${label} collection coming soon`;
        galleryEmpty.hidden = false;
      }
    }

    if(galleryEl && galleryEl.classList.contains("solo")) closeSolo();
    if(!isBooks){
      if(bookFilterModal) bookFilterModal.classList.remove("open");
    }
    if(!isArt){
      if(artFilterModal) artFilterModal.classList.remove("open");
    }

    if(isFurniture) renderFurniture();
    if(isBooks) renderBooks();
    if(isArt) renderArt();
    if(isDesigns){
      if(galleryEl && galleryEl.classList.contains("solo")) closeSolo();
    }
  }

  if(filtersEl){
    filtersEl.addEventListener("click", e => {
      const btn = e.target.closest(".chip");
      if(!btn || currentGallery !== "furniture") return;
      currentFilter = btn.dataset.filter || "all";
      filtersEl.querySelectorAll(".chip").forEach(c => c.classList.remove("active"));
      btn.classList.add("active");
      renderFurniture();
    });
  }

  if(galleryTabs){
    galleryTabs.addEventListener("click", e => {
      const btn = e.target.closest(".gallery-chip");
      if(!btn) return;
      const g = btn.dataset.gallery;
      if(!g || g === currentGallery) return;
      setGallery(g);
    });
  }

  let soloSelectedColor = "Red";
  let soloSelectedSize = "Medium";
  let activeSoloType = "furniture";
  let activeBook = null;
  let bookCustoms = { giftWrap:false, eGift:false };
  const SOLO_DEFAULT_DESC = "Contemporary design meeting functionality.";

  function syncSoloSelections(){
    if(activeSoloType !== "furniture") return;
    const setActive = (selector, attr, value) => {
      document.querySelectorAll(selector).forEach(el => {
        const v = el.getAttribute(attr);
        el.classList.toggle('active', !!value && v === value);
      });
    };
    setActive('#soloColorPopover .solo-suboption', 'data-color', soloSelectedColor);
    setActive('#soloConfigColors .solo-config-option', 'data-color', soloSelectedColor);
    setActive('#soloSizePopover .solo-suboption', 'data-size', soloSelectedSize);
    setActive('#soloConfigSizes .solo-config-option', 'data-size', soloSelectedSize);

    const summary = document.getElementById('soloConfigSummary');
    if(summary) summary.textContent = `Selected: ${soloSelectedColor || '--'} / ${soloSelectedSize || '--'}`;
  }

  function setSoloText(id, value){
    const el = document.getElementById(id);
    if(el) el.textContent = value;
  }

  function setSoloHtml(id, value){
    const el = document.getElementById(id);
    if(el) el.innerHTML = value || "";
  }

  function toggleSection(id, show){
    const el = document.getElementById(id);
    if(el) el.hidden = !show;
  }

  function setSoloLabels(a, b, c){
    setSoloText("soloInfoLabel1", a);
    setSoloText("soloInfoLabel2", b);
    setSoloText("soloInfoLabel3", c);
    setSoloText("soloMetaLabel1", a);
    setSoloText("soloMetaLabel2", b);
    setSoloText("soloMetaLabel3", c);
  }

  function setSoloValues(a, b, c){
    setSoloText("soloInfoMat", a);
    setSoloText("soloInfoDim", b);
    setSoloText("soloInfoLoc", c);
    setSoloText("spMat", a);
    setSoloText("spDim", b);
    setSoloText("soloStore", c);
  }

  function setSoloMode(mode){
    activeSoloType = mode;
    const soloWrap = document.getElementById("soloWrap");
    if(soloWrap) soloWrap.dataset.soloMode = mode;
    const isFurniture = mode === "furniture";
    const colorWrap = document.getElementById("soloColorTabWrap");
    const sizeWrap = document.getElementById("soloSizeTabWrap");
    if(colorWrap) colorWrap.hidden = !isFurniture;
    if(sizeWrap) sizeWrap.hidden = !isFurniture;
    if(!isFurniture) setSoloOptionPopover(null);

    toggleSection("soloConfigFurniture", isFurniture);
    toggleSection("soloConfigArt", mode === "art");
    toggleSection("soloConfigSculpture", mode === "sculpture");
    toggleSection("soloConfigBook", mode === "book");

    const cfgTitle = document.getElementById("soloConfigTitle");
    if(cfgTitle) cfgTitle.textContent = isFurniture ? "Customizer" : "Customs";

    const inquiryBtn = document.getElementById("soloInquiryBtn");
    if(inquiryBtn) inquiryBtn.hidden = isFurniture;
    const inquiryFields = document.getElementById("soloInquiryFields");
    if(inquiryFields) inquiryFields.hidden = isFurniture;
  }

  function buildArtInfoHtml(info){
    const items = info.aboutItems.map(item => `<li>${item}</li>`).join("");
    const payNote = info.payNote ? `<div class="art-pay-note">${info.payNote}</div>` : "";
    return `
      ${payNote}
      <div class="art-box">
        <h4>${info.aboutTitle}</h4>
        <ul>${items}</ul>
      </div>
    `;
  }

  function buildBookInfoHtml(){
    const accordion = BOOK_INFO.accordion.map(item => `
      <div class="book-accordion-item"><span>${item.title}</span><span>+</span></div>
      <div class="book-accordion-panel">${item.body}</div>
    `).join("");
    const accessories = BOOK_INFO.accessories.map((src, idx) => `
      <div class="book-accessory-item"><img src="${src}" alt="Accessory item ${idx + 1}"></div>
    `).join("");
    return `
      <div class="book-note">${BOOK_INFO.note}</div>
      <div class="book-accordion">${accordion}</div>
      <div class="book-accessory">
        <div class="book-accessory-head">
          <div class="book-accessory-title">Accessorize your library</div>
          <div class="book-accessory-link">Shop Now -></div>
        </div>
        <div class="book-accessory-grid">${accessories}</div>
      </div>
    `;
  }

  function bindBookAccordion(){
    const bookAccordion = document.querySelector('.book-accordion');
    if(bookAccordion && bookAccordion.dataset.bound !== "1"){
      bookAccordion.dataset.bound = "1";
      bookAccordion.addEventListener('click', (e) => {
        const item = e.target.closest('.book-accordion-item');
        if(!item) return;
        item.classList.toggle('open');
        const panel = item.nextElementSibling;
        if(panel && panel.classList.contains('book-accordion-panel')){
          panel.classList.toggle('open');
        }
      });
    }
  }

  function updateBookCustomsUI(){
    const wrap = document.getElementById("soloConfigBook");
    if(!wrap) return;
    wrap.querySelectorAll(".book-offer-select").forEach(card => {
      const option = card.dataset.option;
      const active = option === "gift-wrap" ? bookCustoms.giftWrap : bookCustoms.eGift;
      card.classList.toggle("active", active);
      const btn = card.querySelector(".book-offer-btn");
      if(btn) btn.setAttribute("aria-pressed", active ? "true" : "false");
    });
    const summary = document.getElementById("bookCustomsSummary");
    if(summary){
      const picks = [];
      if(bookCustoms.giftWrap) picks.push("Gift wrap");
      if(bookCustoms.eGift) picks.push("E-gift");
      summary.textContent = picks.length ? `Selected: ${picks.join(" / ")}` : "Selected: None";
    }
  }

  function bindBookCustoms(){
    const wrap = document.getElementById("soloConfigBook");
    if(!wrap || wrap.dataset.bound === "1") return;
    wrap.dataset.bound = "1";
    wrap.addEventListener("click", (e) => {
      const card = e.target.closest(".book-offer-select");
      if(!card) return;
      const option = card.dataset.option;
      if(option === "gift-wrap") bookCustoms.giftWrap = !bookCustoms.giftWrap;
      if(option === "e-gift") bookCustoms.eGift = !bookCustoms.eGift;
      updateBookCustomsUI();
    });
  }

  function setArtistProfile(name, role, img, bio){
    setSoloText("artistName", name || "--");
    setSoloText("artistRole", role || "--");
    const artistImg = document.getElementById("artistImg");
    if(artistImg) artistImg.src = img || "";

    setSoloText("modalArtistName", name || "");
    setSoloText("modalArtistRole", role || "");
    const modalImg = document.getElementById("modalArtistImg");
    if(modalImg) modalImg.src = img || "";
    setSoloText("modalArtistBio", bio || "");
  }

  function buildInquiryMessage(){
    if(activeSoloType === "art" && activeArt){
      return [
        `Product: ${activeArt.name} (ID: ${activeArt.id})`,
        "Type: Artwork",
        `Selections: Service=${artSelection.service}, Size=${artSelection.size}, Frame=${artSelection.frame}`
      ].join("\n");
    }
    if(activeSoloType === "sculpture" && activeSculpture){
      return [
        `Product: ${activeSculpture.name} (ID: ${activeSculpture.id})`,
        "Type: Sculpture",
        `Selections: Finish=${sculptureSelection.finish}, Size=${sculptureSelection.size}, Base=${sculptureSelection.base}`
      ].join("\n");
    }
    if(activeSoloType === "book" && activeBook){
      const picks = [];
      if(bookCustoms.giftWrap) picks.push("Gift wrap");
      if(bookCustoms.eGift) picks.push("E-gift");
      const selectionText = picks.length ? picks.join(", ") : "None";
      return [
        `Product: ${activeBook.name} (ID: ${activeBook.id})`,
        "Type: Book",
        `Selections: ${selectionText}`
      ].join("\n");
    }
    return "";
  }

  function prefillInquiryFields(){
    const nameInput = document.querySelector('#ajaxForm input[name="name"]');
    const emailInput = document.querySelector('#ajaxForm input[name="email"]');
    const inquiryName = document.getElementById("inquiryName");
    const inquiryEmail = document.getElementById("inquiryEmail");
    if(inquiryName && nameInput && inquiryName.value.trim()) nameInput.value = inquiryName.value.trim();
    if(inquiryEmail && emailInput && inquiryEmail.value.trim()) emailInput.value = inquiryEmail.value.trim();
  }

  function triggerInquiry(){
    const message = buildInquiryMessage();
    if(!message) return;
    let subject = "";
    if(activeSoloType === "art" && activeArt) subject = `Inquiry: ${activeArt.name}`;
    if(activeSoloType === "sculpture" && activeSculpture) subject = `Inquiry: ${activeSculpture.name}`;
    if(activeSoloType === "book" && activeBook) subject = `Inquiry: ${activeBook.name}`;
    const fs = document.getElementById("formSubject");
    if(fs && subject) fs.value = subject;
    const msgField = document.querySelector('textarea[name="message"]');
    if(msgField) msgField.value = message;
    prefillInquiryFields();
    switchSection('sect-contact');
  }

  function setSoloOptionPopover(panel){
    if(activeSoloType !== "furniture" && panel) return;
    const colorPop = document.getElementById('soloColorPopover');
    const sizePop = document.getElementById('soloSizePopover');
    const colorBtn = document.getElementById('soloColorBtn');
    const sizeBtn = document.getElementById('soloSizeBtn');

    const showColor = panel === 'color';
    const showSize = panel === 'size';

    if(colorPop) colorPop.hidden = !showColor;
    if(sizePop) sizePop.hidden = !showSize;

    if(colorBtn){
      colorBtn.classList.toggle('active', showColor);
      colorBtn.setAttribute('aria-expanded', showColor ? 'true' : 'false');
    }
    if(sizeBtn){
      sizeBtn.classList.toggle('active', showSize);
      sizeBtn.setAttribute('aria-expanded', showSize ? 'true' : 'false');
    }
  }

  function setSoloCustomizerOpen(isOpen){
    const frame = document.querySelector('#sect-gallery.solo .solo-frame');
    if(frame) frame.classList.toggle('customize-open', isOpen);

    const btn = document.getElementById('soloCustomsBtn');
    if(btn){
      btn.classList.toggle('active', isOpen);
      btn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
    }

    const cfg = document.getElementById('soloConfig');
    if(cfg) cfg.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
  }

  function setSoloInfoOpen(isOpen){
    const frame = document.querySelector('#sect-gallery.solo .solo-frame');
    if(frame) frame.classList.toggle('info-open', isOpen);

    const btn = document.getElementById('soloInfoBtn');
    if(btn){
      btn.classList.toggle('active', isOpen);
      btn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
    }

    const card = document.getElementById('soloInfoCard');
    if(card) card.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
  }

  function activateSoloLayout(){
    const shopEl = document.getElementById("shop");
    if(shopEl) shopEl.classList.add("solo");
    const galleryEl = document.getElementById("sect-gallery");
    if(galleryEl){
      galleryEl.classList.add("solo");
      galleryEl.classList.remove("book-solo");
      galleryEl.classList.remove("art-solo");
      galleryEl.classList.remove("sculpture-solo");
    }
    setSoloInfoOpen(false);
    setSoloOptionPopover(null);
    setSoloCustomizerOpen(false);
  }

  function openBook(b){
    activeBook = b;
    activateSoloLayout();
    setSoloMode("book");
    closeBookFilterModal();

    const title = (b.name || "Book").toUpperCase();
    setSoloText("soloName", b.name || "Book");
    setSoloText("soloFootTitle", title);
    setSoloText("soloFootDesc", b.kicker || SOLO_DEFAULT_DESC);
    setSoloText("soloTitle", title);
    setSoloText("soloDescText", b.kicker || SOLO_DEFAULT_DESC);
    setSoloText("soloInfoName", title);

    const bookTheme = b.theme || "--";
    const bookColor = b.color || "--";
    const bookSize = b.size || "--";
    setSoloText("soloInfoText", `${bookTheme} - ${bookColor} - ${bookSize}`);

    setSoloLabels("Theme", "Color", "Size");
    setSoloValues(b.theme || "--", b.color || "--", b.size || "--");
    setSoloHtml("soloInfoExtra", buildBookInfoHtml());
    bindBookAccordion();

    const profileName = b.kicker || b.name || "Book";
    const profileRole = b.tag || b.theme || "";
    setArtistProfile(profileName, profileRole, b.img, BOOK_INFO.accordion[0].body);

    bookCustoms = { giftWrap:false, eGift:false };
    bindBookCustoms();
    updateBookCustomsUI();

    const fs = document.getElementById("formSubject");
    if(fs) fs.value = "Inquiry: " + (b.name || "Book");

    renderActiveMedia({ ...b, images:(b.images && b.images.length ? b.images : [b.img]) }, 'images');
  }

  function closeBook(){
    closeSolo();
    activeBook = null;
  }

  const ART_SERVICE_PRICES = { print:0, canvas:18, wood:24 };
  const ART_SIZE_PRICES = { "12x16":0, "18x24":24, "24x32":48 };
  const ART_FRAME_PRICES = { classic:121, premium:182, signature:237, sale:107 };
  let activeArt = null;
  let artSelection = { service:"print", size:"12x16", frame:"classic" };

  function formatPrice(v){
    return `$${Math.round(v)}`;
  }

  function updateArtUI(){
    if(!activeArt) return;
    const title = document.getElementById("artTitle");
    const artist = document.getElementById("artArtist");
    const stars = document.getElementById("artStars");
    const ratingText = document.getElementById("artRatingText");
    const printNote = document.getElementById("artPrintNote");
    const printPrice = document.getElementById("artPrintPrice");
    const priceEl = document.getElementById("artPrice");
    const thumb = document.getElementById("artThumb");
    const rightImg = document.getElementById("artRightImage");

    if(title) title.textContent = activeArt.name;
    if(artist) artist.textContent = activeArt.artist || "Unknown";
    if(stars){
      const filled = Math.max(1, Math.min(5, Math.round(activeArt.rating || 5)));
      stars.textContent = "★★★★★".slice(0, filled) + "☆☆☆☆☆".slice(0, 5 - filled);
    }
    if(ratingText) ratingText.textContent = `${activeArt.rating || 5} stars from ${activeArt.ratingCount || "50+"} ratings`;
    if(thumb){
      thumb.src = activeArt.img;
      thumb.alt = activeArt.name || "Artwork preview";
    }
    if(rightImg){
      rightImg.src = activeArt.img;
      rightImg.alt = activeArt.name || "Artwork preview";
    }

    document.querySelectorAll("#artServiceOptions .art-service-card").forEach(card => {
      card.classList.toggle("active", card.dataset.service === artSelection.service);
    });
    document.querySelectorAll("#artSizeOptions .art-option").forEach(btn => {
      btn.classList.toggle("active", btn.dataset.size === artSelection.size);
    });
    const frameDisabled = artSelection.service !== "print";
    document.querySelectorAll("#artFrameOptions .art-frame-card").forEach(card => {
      card.classList.toggle("active", card.dataset.frame === artSelection.frame);
      card.classList.toggle("disabled", frameDisabled);
    });

    const base = activeArt.basePrice || 32;
    const sizeAdj = ART_SIZE_PRICES[artSelection.size] || 0;
    const serviceAdj = ART_SERVICE_PRICES[artSelection.service] || 0;
    const frameAdj = frameDisabled ? 0 : (ART_FRAME_PRICES[artSelection.frame] || 0);
    const total = base + sizeAdj + serviceAdj + frameAdj;
    if(priceEl) priceEl.textContent = formatPrice(total);
    if(printNote){
      const sizeParts = artSelection.size.split("x");
      const sizeLabel = `${sizeParts[0]}" x ${sizeParts[1]}"`;
      printNote.textContent = `(Image ${sizeLabel})`;
    }
    if(printPrice) printPrice.textContent = formatPrice(base + sizeAdj);
  }

  function openArt(a){
    activeArt = a;
    activateSoloLayout();
    setSoloMode("art");
    closeArtFilterModal();
    artSelection = { service:"print", size:"12x16", frame:"classic" };
    const title = (a.name || "Artwork").toUpperCase();
    setSoloText("soloName", a.name || "Artwork");
    setSoloText("soloFootTitle", title);
    setSoloText("soloFootDesc", `by ${a.artist || "Unknown"}`);
    setSoloText("soloTitle", title);
    setSoloText("soloDescText", `${a.period || "--"} - ${a.medium || "--"} - ${a.year || "--"}`);
    setSoloText("soloInfoName", title);
    setSoloText("soloInfoText", `${a.period || "--"} - ${a.medium || "--"} - ${a.year || "--"}`);
    setSoloLabels("Medium", "Period", "Year");
    setSoloValues(a.medium || "--", a.period || "--", a.year ? String(a.year) : "--");
    setSoloHtml("soloInfoExtra", buildArtInfoHtml(ART_INFO));

    setArtistProfile(a.artist || "Unknown", a.period || "", a.img, ART_INFO.aboutItems.join(" "));

    const fs = document.getElementById("formSubject");
    if(fs) fs.value = "Inquiry: " + (a.name || "Artwork");

    updateArtUI();
    renderActiveMedia({ ...a, images:(a.images && a.images.length ? a.images : [a.img]) }, 'images');
  }

  function closeArt(){
    closeSolo();
    activeArt = null;
  }

  const SCULPTURE_FINISH_PRICES = { polished:0, antique:80, matte:40 };
  const SCULPTURE_SIZE_PRICES = { small:0, medium:180, large:360 };
  const SCULPTURE_BASE_PRICES = { stone:180, wood:120, metal:150, none:0 };
  let activeSculpture = null;
  let sculptureSelection = { finish:"polished", size:"medium", base:"stone" };

  function updateSculptureUI(){
    if(!activeSculpture) return;
    const title = document.getElementById("sculptureTitle");
    const artist = document.getElementById("sculptureArtist");
    const stars = document.getElementById("sculptureStars");
    const ratingText = document.getElementById("sculptureRatingText");
    const meta = document.getElementById("sculptureMeta");
    const thumb = document.getElementById("sculptureThumb");
    const rightImg = document.getElementById("sculptureRightImage");
    const sizeNote = document.getElementById("sculptureSizeNote");
    const basePriceEl = document.getElementById("sculptureBasePrice");
    const priceEl = document.getElementById("sculpturePrice");

    if(title) title.textContent = activeSculpture.name;
    if(artist) artist.textContent = activeSculpture.artist || "Unknown";
    if(meta) meta.textContent = `${activeSculpture.material} · ${activeSculpture.era} · ${activeSculpture.year}`;
    if(stars){
      const filled = Math.max(1, Math.min(5, Math.round(activeSculpture.rating || 5)));
      stars.textContent = "★★★★★".slice(0, filled) + "☆☆☆☆☆".slice(0, 5 - filled);
    }
    if(ratingText) ratingText.textContent = `${activeSculpture.rating || 5} stars from ${activeSculpture.ratingCount || "50+"} ratings`;
    if(thumb){
      thumb.src = activeSculpture.img;
      thumb.alt = activeSculpture.name || "Sculpture preview";
    }
    if(rightImg){
      rightImg.src = activeSculpture.img;
      rightImg.alt = activeSculpture.name || "Sculpture preview";
    }

    document.querySelectorAll("#sculptureFinishOptions .art-service-card").forEach(card => {
      card.classList.toggle("active", card.dataset.finish === sculptureSelection.finish);
    });
    document.querySelectorAll("#sculptureSizeOptions .art-option").forEach(btn => {
      btn.classList.toggle("active", btn.dataset.size === sculptureSelection.size);
    });
    document.querySelectorAll("#sculptureBaseOptions .art-frame-card").forEach(card => {
      card.classList.toggle("active", card.dataset.base === sculptureSelection.base);
    });

    const base = activeSculpture.basePrice || 1000;
    const sizeAdj = SCULPTURE_SIZE_PRICES[sculptureSelection.size] || 0;
    const finishAdj = SCULPTURE_FINISH_PRICES[sculptureSelection.finish] || 0;
    const baseAdj = SCULPTURE_BASE_PRICES[sculptureSelection.base] || 0;
    const total = base + sizeAdj + finishAdj + baseAdj;
    if(priceEl) priceEl.textContent = formatPrice(total);
    if(basePriceEl) basePriceEl.textContent = formatPrice(base + sizeAdj);
    if(sizeNote) sizeNote.textContent = `(${sculptureSelection.size.charAt(0).toUpperCase()}${sculptureSelection.size.slice(1)})`;
  }

  function openSculpture(s){
    activeSculpture = s;
    activateSoloLayout();
    setSoloMode("sculpture");
    closeSculptureFilterModal();
    closeArtFilterModal();
    sculptureSelection = { finish:"polished", size:"medium", base:"stone" };
    const title = (s.name || "Sculpture").toUpperCase();
    setSoloText("soloName", s.name || "Sculpture");
    setSoloText("soloFootTitle", title);
    setSoloText("soloFootDesc", `by ${s.artist || "Unknown"}`);
    setSoloText("soloTitle", title);
    setSoloText("soloDescText", `${s.material || "--"} - ${s.era || "--"} - ${s.year || "--"}`);
    setSoloText("soloInfoName", title);
    setSoloText("soloInfoText", `${s.material || "--"} - ${s.era || "--"} - ${s.year || "--"}`);
    setSoloLabels("Material", "Era", "Year");
    setSoloValues(s.material || "--", s.era || "--", s.year ? String(s.year) : "--");
    setSoloHtml("soloInfoExtra", buildArtInfoHtml(SCULPTURE_INFO));

    setArtistProfile(s.artist || "Unknown", s.era || "", s.img, SCULPTURE_INFO.aboutItems.join(" "));

    const fs = document.getElementById("formSubject");
    if(fs) fs.value = "Inquiry: " + (s.name || "Sculpture");

    updateSculptureUI();
    renderActiveMedia({ ...s, images:(s.images && s.images.length ? s.images : [s.img]) }, 'images');
  }

  function closeSculpture(){
    closeSolo();
    activeSculpture = null;
  }

  function openSolo(p){
    activateSoloLayout();
    setSoloMode("furniture");
    soloSelectedColor = "Red";
    soloSelectedSize = "Medium";
    syncSoloSelections();

    const soloName = document.getElementById("soloName");
    if(soloName) soloName.textContent = p.name;

    const soloFootTitle = document.getElementById("soloFootTitle");
    if(soloFootTitle) soloFootTitle.textContent = p.name.toUpperCase();
    setSoloText("soloFootDesc", SOLO_DEFAULT_DESC);

    document.getElementById("soloTitle").textContent = p.name.toUpperCase();
    setSoloText("soloDescText", SOLO_DEFAULT_DESC);
    setSoloText("soloInfoText", SOLO_DEFAULT_DESC);
    setSoloLabels("Material", "Dimensions", "Location");
    setSoloValues(p.specs.mat, p.specs.dim, p.store.name);
    setSoloHtml("soloInfoExtra", "");

    const soloInfoName = document.getElementById("soloInfoName");
    if(soloInfoName) soloInfoName.textContent = p.name.toUpperCase();

    document.getElementById("artistName").textContent = p.artist.name;
    document.getElementById("artistRole").textContent = p.artist.role;
    document.getElementById("artistImg").src = p.artist.img;

    document.getElementById("modalArtistName").textContent = p.artist.name;
    document.getElementById("modalArtistRole").textContent = p.artist.role;
    document.getElementById("modalArtistImg").src = p.artist.img;
    document.getElementById("modalArtistBio").textContent = p.artist.bio;

    const fs = document.getElementById("formSubject");
    if(fs) fs.value = "Inquiry: " + p.name;

    const sideNav = document.querySelector('.side-nav');
    if(sideNav) sideNav.classList.add('focused');

    renderActiveMedia(p, 'images');

    // ✅ zoom + then show 3D popup after moveend
    gotoStore(p.store, p);
  }

  function closeSolo(){
    setSoloInfoOpen(false);
    setSoloOptionPopover(null);
    setSoloCustomizerOpen(false);

    const shopEl = document.getElementById("shop");
    const galleryEl = document.getElementById("sect-gallery");
    if(shopEl) shopEl.classList.remove("solo");
    if(galleryEl) galleryEl.classList.remove("solo");

    const sideNav = document.querySelector('.side-nav');
    if(sideNav) sideNav.classList.remove('focused');

    hideMap3D();

    if(rotationFrame){ cancelAnimationFrame(rotationFrame); rotationFrame=null; }

    const isMobileReset = window.innerWidth < 900;
    map.flyTo({ center:[0,20], zoom:isMobileReset ? 0 : 0.8, pitch:0, bearing:0, duration:2200 });

    activeArt = null;
    activeSculpture = null;
    activeBook = null;
    activeSoloType = "furniture";
  }

  safeAdd("btnBack","click",closeSolo);
  safeAdd("bookBack","click",closeBook);
  safeAdd("artBack","click",closeArt);
  safeAdd("sculptureBack","click",closeSculpture);
  safeAdd("btnClose","click",closeSolo);
  safeAdd("btnContactProduct","click",() => {
    prefillInquiryFields();
    switchSection('sect-contact');
  });

  function openBookFilterModal(){
    if(!bookFilterModal) return;
    bookFilterModal.classList.add("open");
    bookFilterModal.setAttribute("aria-hidden","false");
  }
  function closeBookFilterModal(){
    if(!bookFilterModal) return;
    bookFilterModal.classList.remove("open");
    bookFilterModal.setAttribute("aria-hidden","true");
  }
  function collectFilterSet(id){
    const wrap = document.getElementById(id);
    if(!wrap) return new Set();
    return new Set(Array.from(wrap.querySelectorAll("input:checked")).map(i => i.value));
  }

  if(bookFilterBtn) bookFilterBtn.addEventListener("click", openBookFilterModal);
  if(bookFilterClose) bookFilterClose.addEventListener("click", closeBookFilterModal);
  if(bookFilterModal){
    bookFilterModal.addEventListener("click", (e) => {
      if(e.target === bookFilterModal) closeBookFilterModal();
    });
  }

  document.querySelectorAll(".book-filter-toggle").forEach(btn => {
    if(btn.dataset.bound === "1") return;
    btn.dataset.bound = "1";
    btn.addEventListener("click", () => {
      btn.classList.toggle("open");
      const targetId = btn.getAttribute("data-target");
      const panel = targetId ? document.getElementById(targetId) : null;
      if(panel) panel.classList.toggle("open");
    });
  });

  if(bookFilterClear){
    bookFilterClear.addEventListener("click", () => {
      if(bookSortSelect) bookSortSelect.value = "featured";
      if(bookFilterModal){
        bookFilterModal.querySelectorAll("input[type='checkbox']").forEach(cb => { cb.checked = false; });
      }
      bookFilterState.sort = "featured";
      bookFilterState.themes = new Set();
      bookFilterState.colors = new Set();
      bookFilterState.sizes = new Set();
      renderBooks();
    });
  }

  if(bookFilterApply){
    bookFilterApply.addEventListener("click", () => {
      bookFilterState.sort = bookSortSelect ? bookSortSelect.value : "featured";
      bookFilterState.themes = collectFilterSet("bookFilterThemes");
      bookFilterState.colors = collectFilterSet("bookFilterColors");
      bookFilterState.sizes = collectFilterSet("bookFilterSizes");
      renderBooks();
      closeBookFilterModal();
    });
  }

  function openArtFilterModal(){
    if(!artFilterModal) return;
    artFilterModal.classList.add("open");
    artFilterModal.setAttribute("aria-hidden","false");
  }
  function closeArtFilterModal(){
    if(!artFilterModal) return;
    artFilterModal.classList.remove("open");
    artFilterModal.setAttribute("aria-hidden","true");
  }

  if(artFilterBtn) artFilterBtn.addEventListener("click", openArtFilterModal);
  if(artFilterClose) artFilterClose.addEventListener("click", closeArtFilterModal);
  if(artFilterModal){
    artFilterModal.addEventListener("click", (e) => {
      if(e.target === artFilterModal) closeArtFilterModal();
    });
  }

  document.querySelectorAll(".art-filter-toggle").forEach(btn => {
    if(btn.dataset.bound === "1") return;
    btn.dataset.bound = "1";
    btn.addEventListener("click", () => {
      btn.classList.toggle("open");
      const targetId = btn.getAttribute("data-target");
      const panel = targetId ? document.getElementById(targetId) : null;
      if(panel) panel.classList.toggle("open");
    });
  });

  if(artFilterClear){
    artFilterClear.addEventListener("click", () => {
      if(artSortSelect) artSortSelect.value = "featured";
      if(artFilterModal){
        artFilterModal.querySelectorAll("input[type='checkbox']").forEach(cb => { cb.checked = false; });
      }
      artFilterState.sort = "featured";
      artFilterState.types = new Set();
      artFilterState.artists = new Set();
      artFilterState.periods = new Set();
      artFilterState.media = new Set();
      renderArt();
    });
  }

  if(artFilterApply){
    artFilterApply.addEventListener("click", () => {
      artFilterState.sort = artSortSelect ? artSortSelect.value : "featured";
      artFilterState.types = collectFilterSet("artFilterTypes");
      artFilterState.artists = collectFilterSet("artFilterArtists");
      artFilterState.periods = collectFilterSet("artFilterPeriods");
      artFilterState.media = collectFilterSet("artFilterMedia");
      renderArt();
      closeArtFilterModal();
    });
  }

  function openSculptureFilterModal(){
    if(!sculptureFilterModal) return;
    sculptureFilterModal.classList.add("open");
    sculptureFilterModal.setAttribute("aria-hidden","false");
  }
  function closeSculptureFilterModal(){
    if(!sculptureFilterModal) return;
    sculptureFilterModal.classList.remove("open");
    sculptureFilterModal.setAttribute("aria-hidden","true");
  }

  if(sculptureFilterBtn) sculptureFilterBtn.addEventListener("click", openSculptureFilterModal);
  if(sculptureFilterClose) sculptureFilterClose.addEventListener("click", closeSculptureFilterModal);
  if(sculptureFilterModal){
    sculptureFilterModal.addEventListener("click", (e) => {
      if(e.target === sculptureFilterModal) closeSculptureFilterModal();
    });
  }

  document.querySelectorAll(".sculpture-filter-toggle").forEach(btn => {
    if(btn.dataset.bound === "1") return;
    btn.dataset.bound = "1";
    btn.addEventListener("click", () => {
      btn.classList.toggle("open");
      const targetId = btn.getAttribute("data-target");
      const panel = targetId ? document.getElementById(targetId) : null;
      if(panel) panel.classList.toggle("open");
    });
  });

  if(sculptureFilterClear){
    sculptureFilterClear.addEventListener("click", () => {
      if(sculptureSortSelect) sculptureSortSelect.value = "featured";
      if(sculptureFilterModal){
        sculptureFilterModal.querySelectorAll("input[type='checkbox']").forEach(cb => { cb.checked = false; });
      }
      sculptureFilterState.sort = "featured";
      sculptureFilterState.artists = new Set();
      sculptureFilterState.eras = new Set();
      sculptureFilterState.materials = new Set();
      renderSculptures();
    });
  }

  if(sculptureFilterApply){
    sculptureFilterApply.addEventListener("click", () => {
      sculptureFilterState.sort = sculptureSortSelect ? sculptureSortSelect.value : "featured";
      sculptureFilterState.artists = collectFilterSet("sculptureFilterArtists");
      sculptureFilterState.eras = collectFilterSet("sculptureFilterEras");
      sculptureFilterState.materials = collectFilterSet("sculptureFilterMaterials");
      renderSculptures();
      closeSculptureFilterModal();
    });
  }

  const artServiceOptions = document.getElementById("artServiceOptions");
  if(artServiceOptions){
    artServiceOptions.addEventListener("click", (e) => {
      const card = e.target.closest(".art-service-card");
      if(!card) return;
      artSelection.service = card.dataset.service;
      updateArtUI();
    });
  }
  const artSizeOptions = document.getElementById("artSizeOptions");
  if(artSizeOptions){
    artSizeOptions.addEventListener("click", (e) => {
      const btn = e.target.closest(".art-option");
      if(!btn) return;
      artSelection.size = btn.dataset.size;
      updateArtUI();
    });
  }
  const artFrameOptions = document.getElementById("artFrameOptions");
  if(artFrameOptions){
    artFrameOptions.addEventListener("click", (e) => {
      const card = e.target.closest(".art-frame-card");
      if(!card || card.classList.contains("disabled")) return;
      artSelection.frame = card.dataset.frame;
      updateArtUI();
    });
  }
  const sculptureFinishOptions = document.getElementById("sculptureFinishOptions");
  if(sculptureFinishOptions){
    sculptureFinishOptions.addEventListener("click", (e) => {
      const card = e.target.closest(".art-service-card");
      if(!card) return;
      sculptureSelection.finish = card.dataset.finish;
      updateSculptureUI();
    });
  }
  const sculptureSizeOptions = document.getElementById("sculptureSizeOptions");
  if(sculptureSizeOptions){
    sculptureSizeOptions.addEventListener("click", (e) => {
      const btn = e.target.closest(".art-option");
      if(!btn) return;
      sculptureSelection.size = btn.dataset.size;
      updateSculptureUI();
    });
  }
  const sculptureBaseOptions = document.getElementById("sculptureBaseOptions");
  if(sculptureBaseOptions){
    sculptureBaseOptions.addEventListener("click", (e) => {
      const card = e.target.closest(".art-frame-card");
      if(!card) return;
      sculptureSelection.base = card.dataset.base;
      updateSculptureUI();
    });
  }
  bindBookAccordion();

  safeAdd("soloInfoBtn","click", () => {
    const frame = document.querySelector('#sect-gallery.solo .solo-frame');
    if(!frame) return;
    setSoloOptionPopover(null);
    setSoloCustomizerOpen(false);
    setSoloInfoOpen(!frame.classList.contains('info-open'));
  });
  safeAdd("soloInfoClose","click", () => setSoloInfoOpen(false));

  safeAdd("soloColorBtn","click", () => {
    if(activeSoloType !== "furniture") return;
    setSoloInfoOpen(false);
    setSoloCustomizerOpen(false);
    const colorBtn = document.getElementById('soloColorBtn');
    if(!colorBtn) return;
    setSoloOptionPopover(colorBtn.classList.contains('active') ? null : 'color');
  });

  safeAdd("soloSizeBtn","click", () => {
    if(activeSoloType !== "furniture") return;
    setSoloInfoOpen(false);
    setSoloCustomizerOpen(false);
    const sizeBtn = document.getElementById('soloSizeBtn');
    if(!sizeBtn) return;
    setSoloOptionPopover(sizeBtn.classList.contains('active') ? null : 'size');
  });

  safeAdd("soloCustomsBtn","click", () => {
    const frame = document.querySelector('#sect-gallery.solo .solo-frame');
    if(!frame) return;
    setSoloInfoOpen(false);
    setSoloOptionPopover(null);
    setSoloCustomizerOpen(!frame.classList.contains('customize-open'));
  });
  safeAdd("soloConfigClose","click", () => setSoloCustomizerOpen(false));
  safeAdd("soloInquiryBtn","click", triggerInquiry);

  const soloColorPopover = document.getElementById('soloColorPopover');
  if(soloColorPopover && soloColorPopover.dataset.bound !== "1"){
    soloColorPopover.dataset.bound = "1";
    soloColorPopover.addEventListener('click', (e) => {
      if(activeSoloType !== "furniture") return;
      const btn = e.target.closest('.solo-suboption');
      if(!btn) return;
      const color = btn.getAttribute('data-color');
      if(color) soloSelectedColor = color;
      syncSoloSelections();
      setSoloOptionPopover(null);
    });
  }

  const soloSizePopover = document.getElementById('soloSizePopover');
  if(soloSizePopover && soloSizePopover.dataset.bound !== "1"){
    soloSizePopover.dataset.bound = "1";
    soloSizePopover.addEventListener('click', (e) => {
      if(activeSoloType !== "furniture") return;
      const btn = e.target.closest('.solo-suboption');
      if(!btn) return;
      const size = btn.getAttribute('data-size');
      if(size) soloSelectedSize = size;
      syncSoloSelections();
      setSoloOptionPopover(null);
    });
  }

  const soloConfig = document.getElementById('soloConfig');
  if(soloConfig && soloConfig.dataset.bound !== "1"){
    soloConfig.dataset.bound = "1";
    soloConfig.addEventListener('click', (e) => {
      if(activeSoloType !== "furniture") return;
      const btn = e.target.closest('.solo-config-option');
      if(!btn) return;
      const color = btn.getAttribute('data-color');
      const size = btn.getAttribute('data-size');
      if(color) soloSelectedColor = color;
      if(size) soloSelectedSize = size;
      syncSoloSelections();
    });
  }

  const modalArtist = document.getElementById("modalArtistOverlay");
  const artistBtnEl = document.getElementById("artistBtn");
  if(artistBtnEl) artistBtnEl.addEventListener("click", () => modalArtist && modalArtist.classList.add("open"));
  safeAdd("closeArtistModal","click", () => modalArtist && modalArtist.classList.remove("open"));
  window.addEventListener("click", (e) => { if(e.target === modalArtist) modalArtist.classList.remove("open"); });

  function setupProcessAnimation(){
    const dot = document.getElementById("procDot");
    const itemsWrap = document.getElementById("procItems");
    const grid = document.getElementById("processGrid");
    if(!dot || !itemsWrap || !grid) return;

    const section = document.getElementById("sect-services");

    const steps = Array.from(itemsWrap.querySelectorAll(".proc-step"));
    const rail = grid.querySelector(".proc-rail");
    const line = rail ? rail.querySelector(".proc-line") : null;
    if(!steps.length || !rail || !line) return;

    const scroller = document.querySelector("#sect-services .section-scroll");
    if(!scroller) return;

    let minY = 0;
    let maxY = 0;

    const isWindowScroll = () => {
      const style = getComputedStyle(scroller);
      const overflowY = style.overflowY;
      const scrollable = scroller.scrollHeight > scroller.clientHeight + 1;
      return !scrollable || overflowY === "visible";
    };

    const clamp01 = (v) => Math.max(0, Math.min(1, v));

    const computeGeometry = () => {
      rail.style.height = itemsWrap.offsetHeight + "px";

      const railRect = rail.getBoundingClientRect();
      const centers = steps.map(step => {
        const rect = step.getBoundingClientRect();
        return (rect.top + (rect.height / 2)) - railRect.top;
      });
      if(centers.length < 2) return;

      minY = Math.min(...centers);
      maxY = Math.max(...centers);

      line.style.top = `${minY}px`;
      line.style.height = `${Math.max(0, (maxY - minY))}px`;
      line.style.bottom = "auto";
    };

    const getViewportCenter = () => {
      if(isWindowScroll()) return window.innerHeight / 2;
      const rect = scroller.getBoundingClientRect();
      return rect.top + (scroller.clientHeight / 2);
    };

    const moveDot = () => {
      const viewportCenter = getViewportCenter();
      const wrapRect = itemsWrap.getBoundingClientRect();
      const progress = clamp01((viewportCenter - wrapRect.top) / Math.max(1, wrapRect.height));
      const y = minY + (maxY - minY) * progress;
      dot.style.top = `${y}px`;
    };

    let raf = null;
    const onScroll = () => {
      if(raf) return;
      raf = requestAnimationFrame(() => {
        raf = null;
        computeGeometry();
        moveDot();
      });
    };

    requestAnimationFrame(() => {
      computeGeometry();
      moveDot();
    });

    scroller.addEventListener("scroll", onScroll, { passive:true });
    window.addEventListener("scroll", onScroll, { passive:true });
    document.addEventListener("scroll", onScroll, { passive:true });
    window.addEventListener("touchmove", onScroll, { passive:true });
    window.addEventListener("resize", () => {
      computeGeometry();
      moveDot();
    });

    if(grid.dataset.procLoop === "1") return;
    grid.dataset.procLoop = "1";

    const tick = () => {
      const isVisible = section && section.offsetParent !== null;
      if(isVisible){
        computeGeometry();
        moveDot();
      }
      requestAnimationFrame(tick);
    };
    requestAnimationFrame(tick);
  }

  (async function init(){
    setAdminFieldVisibility();
    clearAdminForm();
    updateAdminViewState();
    await loadCatalogFromSupabase();
    await initSupabaseAuth();
    switchSection("sect-admin");

    // Default active nav = Admin
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    const navAdmin = document.getElementById('navAdmin');
    if(navAdmin) navAdmin.classList.add('active');
    const mNavAdmin = document.getElementById('mNavAdmin');
    if(mNavAdmin) mNavAdmin.classList.add('active');
  })();
</script>
</body>
</html>







